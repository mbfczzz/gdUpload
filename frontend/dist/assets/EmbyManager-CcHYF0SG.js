import{_ as bl,a as T,o as kl,c as b,b as o,d as a,i as f,y as A,w as t,f as k,j as u,e as I,t as g,g as Le,h as wl,T as Z,U as ee,u as wt,V as $t,S as $l,E as p,k as ue}from"./index-DS01B9Je.js";import{r as P}from"./request-BcqQ-M1s.js";import{a as Tt,t as it,b as Tl}from"./subscribe-CYfNXaxk.js";import{g as Il}from"./smartSearchConfig-C8VoCqk9.js";import"./index-B9ygI19o.js";function Cl(){return P({url:"/emby/test",method:"get"})}function Sl(){return P({url:"/emby/server-info",method:"get"})}function xl(){return P({url:"/emby/libraries",method:"get"})}function zl(F,te=0,ce=50,ge=null,be=null){const ne={startIndex:te,limit:ce};return ge&&(ne.transferStatus=ge),be&&(ne.downloadStatus=be),P({url:`/emby/libraries/${F}/items/paged`,method:"get",params:ne})}function Ml(F){return P({url:`/emby/items/${F}`,method:"get"})}function El(F){return P({url:`/emby/series/${F}/episodes`,method:"get"})}function Bl(){return P({url:"/emby/genres",method:"get"})}function Rl(){return P({url:"/emby/tags",method:"get"})}function Dl(){return P({url:"/emby/studios",method:"get"})}function Al(F){return P({url:"/emby/search",method:"get",params:{keyword:F}})}function Ll(){return P({url:"/emby/sync",method:"post"})}function Fl(){return P({url:"/emby/cache/status",method:"get"})}function Vl(F){return P({url:`/emby/items/${F}/download-to-server`,method:"post"})}function Nl(F){return P({url:"/emby/batch-download-to-server",method:"post",data:F})}function me(F){return P({url:"/transfer-history/save",method:"post",data:F})}function Yl(F){return P({url:`/transfer-history/item/${F}`,method:"get"})}function Ul(F){return P({url:"/transfer-history/batch-check",method:"post",data:F})}function qe(F){return P({url:"/emby-download-history/batch-check",method:"post",data:F})}function Pl(F,te){return P({url:"/emby-download-history/mark-status",method:"post",params:{embyItemId:F,status:te}})}function It(F,te,ce,ge){return P({url:"/resource115/smart-search",method:"get",params:{tmdbId:F,name:te,originalTitle:ce,year:ge}})}function Ct(F,te){return P({url:"/resource115/transfer",method:"post",params:{url:F,code:te}})}const jl={class:"emby-container"},Ol={class:"header-content"},Kl={class:"header-left"},Wl={class:"header-actions"},Hl={class:"card-header"},Gl={key:1},Ql={class:"card-header"},Jl={class:"library-name"},ql={key:0},Xl={key:1,class:"text-muted"},Zl={class:"card-header"},ea={class:"category-list"},ta={key:0,class:"count"},la={class:"card-header"},aa={class:"category-list"},sa={key:0,class:"count"},na={class:"card-header"},oa={class:"category-list"},ra={key:0,class:"count"},ia={class:"items-dialog-content"},ua={class:"dialog-toolbar"},ca={style:{display:"flex","align-items":"center",gap:"12px"}},da={style:{display:"flex","align-items":"center",gap:"12px"}},fa={class:"total-count"},pa={key:0,class:"episode-list"},ma={key:0,class:"loading-episodes"},ga={key:1,class:"episodes-container"},ya={class:"episodes-header"},va={class:"episodes-title"},ha={class:"episode-name"},_a={key:0},ba={key:1,class:"text-muted"},ka={key:0},wa={key:1,class:"text-muted"},$a={class:"item-name"},Ta={key:1,class:"text-muted"},Ia={key:1,class:"text-muted"},Ca={key:1,class:"text-muted"},Sa={class:"pagination-container"},xa={key:0,class:"download-dialog-content"},za={style:{"font-size":"13px","line-height":"1.6"}},Ma={style:{"margin-top":"4px"}},Ea={key:0,class:"search-results"},Ba={key:0},Ra={key:1},Da={key:2},Aa={style:{display:"flex","align-items":"center",gap:"8px"}},La={style:{"margin-top":"4px"}},Fa={key:1},Va={key:2,class:"selected-result"},Na={class:"json-preview"},Ya={key:1},Ua={key:1},Pa={key:1},ja={key:1},Oa={key:0},Ka={key:1,class:"text-muted"},Wa={key:0},Ha={key:1,class:"text-muted"},Ga={key:0},Qa={key:1,class:"text-muted"},Ja={key:0},qa={key:1,class:"text-muted"},Xa={key:1,class:"text-muted"},Za={key:1,class:"text-muted"},es={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ts={style:{"font-weight":"bold"}},ls={__name:"EmbyManager",setup(F){const te=T(!1),ce=T(!1),ge=T(!1),be=T(!1),ne=T(!1),Fe=T(!1),Ve=T(!1),Ne=T(!1),Xe=T(!1),Ze=T(!1),G=T(null),Ce=T(!0),ke=T([]),Se=T([]),xe=T([]),ze=T([]),j=T([]),oe=T(null),B=T(null),Ye=T(""),Me=T(""),Ue=T(""),St=T([]),ye=T({}),et=T({}),de=T(1),Te=T(50),tt=T(0),lt=T(!1),at=T(!1),ve=T(!1),st=T(!1),Pe=T([]),E=T(null),xt=T(""),zt=T(null);T(!1);const he=T(""),je=T(!1),re=T([]),fe=T(null),we=T(!1),ie=T([]),Mt=T(!1),nt=T(!1),Ee=T(!0),Oe=T(!0),q=T({}),Q=T({}),ot=l=>{const e=ie.value.find(i=>i.cloudType===l);return e||(console.warn(`æœªæ‰¾åˆ° cloudType=${l} çš„äº‘ç›˜é…ç½®`),null)},Et=async()=>{try{const l=await Il();if(l.data&&Object.keys(l.data).length>0){l.data.cloudConfigs&&Array.isArray(l.data.cloudConfigs)&&l.data.cloudConfigs.length>0&&(ie.value=l.data.cloudConfigs),l.data.aiEnabled!==void 0&&(Ee.value=l.data.aiEnabled),l.data.validateLinks!==void 0&&(Oe.value=l.data.validateLinks),console.log("ä»æ•°æ®åº“åŠ è½½æ™ºèƒ½æœç´¢é…ç½®:",l.data),console.log("äº‘ç›˜é…ç½®åˆ—è¡¨:",ie.value);return}}catch(l){console.error("ä»æ•°æ®åº“åŠ è½½é…ç½®å¤±è´¥:",l)}try{const l=localStorage.getItem("smartSearchConfig");if(l){const e=JSON.parse(l);e.cloudConfigs&&Array.isArray(e.cloudConfigs)&&e.cloudConfigs.length>0?ie.value=e.cloudConfigs:ie.value=[{name:"é˜¿é‡Œäº‘ç›˜",cloudType:e.cloudType||"channel_alipan",parentId:e.alipanParentId||"697f2333cd2704159fa446d8bc5077584838e3dc",remark:""}],e.aiEnabled!==void 0&&(Ee.value=e.aiEnabled),e.validateLinks!==void 0&&(Oe.value=e.validateLinks),console.log("ä»æœ¬åœ°åŠ è½½æ™ºèƒ½æœç´¢é…ç½®:",e),console.log("äº‘ç›˜é…ç½®åˆ—è¡¨:",ie.value)}}catch(l){console.error("åŠ è½½æ™ºèƒ½æœç´¢é…ç½®å¤±è´¥:",l)}},Bt=async()=>{te.value=!0;try{(await Cl()).data?(p.success("Embyè¿æ¥æˆåŠŸ"),await ut()):p.error("Embyè¿æ¥å¤±è´¥")}catch(l){p.error("è¿æ¥æµ‹è¯•å¤±è´¥: "+l.message)}finally{te.value=!1}},ut=async()=>{try{const l=await Sl();G.value=l.data,await Rt()}catch(l){console.error("åŠ è½½æœåŠ¡å™¨ä¿¡æ¯å¤±è´¥:",l)}},Rt=async()=>{try{const l=await Fl();Ce.value=l.data.hasCache,Ce.value||p.warning({message:'æ•°æ®åº“ä¸­æš‚æ— æ•°æ®ï¼Œè¯·å…ˆç‚¹å‡»"åŒæ­¥æ‰€æœ‰æ•°æ®"æŒ‰é’®ï¼',duration:5e3,showClose:!0})}catch(l){console.error("æ£€æŸ¥ç¼“å­˜çŠ¶æ€å¤±è´¥:",l)}},Be=async()=>{be.value=!0;try{const l=await xl();ke.value=l.data}catch(l){p.error("åŠ è½½åª’ä½“åº“å¤±è´¥: "+l.message)}finally{be.value=!1}},Ke=async()=>{Fe.value=!0;try{const l=await Bl();Se.value=l.data}catch(l){p.error("åŠ è½½ç±»å‹å¤±è´¥: "+l.message)}finally{Fe.value=!1}},We=async()=>{Ve.value=!0;try{const l=await Rl();xe.value=l.data}catch(l){p.error("åŠ è½½æ ‡ç­¾å¤±è´¥: "+l.message)}finally{Ve.value=!1}},He=async()=>{Ne.value=!0;try{const l=await Dl();ze.value=l.data}catch(l){p.error("åŠ è½½å·¥ä½œå®¤å¤±è´¥: "+l.message)}finally{Ne.value=!1}},Dt=async l=>{oe.value=l,de.value=1,lt.value=!0,await _e()},At=async(l,e)=>{var r;if(l.type!=="Series")return;if(e.some(n=>n.id===l.id)){if(ye.value[l.id]){const n=ye.value[l.id].map(d=>d.id);if(n.length>0)try{const d=await qe(n);d.data&&(Object.assign(Q.value,d.data),console.log(`åˆ·æ–°å‰§é›†ä¸‹è½½çŠ¶æ€å®Œæˆï¼Œå…± ${n.length} é›†`))}catch(d){console.error("åˆ·æ–°å‰§é›†ä¸‹è½½çŠ¶æ€å¤±è´¥:",d)}return}et.value[l.id]=!0;try{const n=await El(l.id);if(ye.value[l.id]=n.data||[],console.log(`åŠ è½½ç”µè§†å‰§ [${l.name}] çš„å‰§é›†ï¼Œå…± ${((r=n.data)==null?void 0:r.length)||0} é›†`),n.data&&n.data.length>0){const d=n.data.map(m=>m.id);try{const m=await qe(d);m.data&&(Object.assign(Q.value,m.data),console.log(`åŠ è½½å‰§é›†ä¸‹è½½çŠ¶æ€å®Œæˆï¼Œå…± ${d.length} é›†`))}catch(m){console.error("åŠ è½½å‰§é›†ä¸‹è½½çŠ¶æ€å¤±è´¥:",m)}}}catch(n){console.error("åŠ è½½å‰§é›†å¤±è´¥:",n),p.error("åŠ è½½å‰§é›†å¤±è´¥"),ye.value[l.id]=[]}finally{et.value[l.id]=!1}}},Lt=l=>{if(!l)return"-";const e=Math.round(l/6e8);if(e<60)return`${e}åˆ†é’Ÿ`;const i=Math.floor(e/60),r=e%60;return`${i}å°æ—¶${r}åˆ†é’Ÿ`},_e=async()=>{if(oe.value){ne.value=!0;try{const l=(de.value-1)*Te.value,e=await zl(oe.value.id,l,Te.value,Me.value||null,Ue.value||null);if(j.value=e.data.items,tt.value=e.data.totalCount,oe.value.itemCount===void 0||oe.value.itemCount===null){const i=ke.value.findIndex(r=>r.id===oe.value.id);i!==-1&&(ke.value[i].itemCount=e.data.totalCount,oe.value.itemCount=e.data.totalCount)}await Ft(),await Vt()}catch(l){p.error("åŠ è½½åª’ä½“é¡¹å¤±è´¥: "+l.message)}finally{ne.value=!1}}},Ft=async()=>{if(!(!j.value||j.value.length===0))try{const l=j.value.map(i=>i.id),e=await Ul(l);e.data&&(q.value=e.data,console.log("=== è½¬å­˜çŠ¶æ€åŠ è½½å®Œæˆ ==="),console.log("çŠ¶æ€æ˜ å°„:",q.value),console.log("ç¤ºä¾‹æ•°æ®:",Object.entries(q.value).slice(0,5)))}catch(l){console.error("åŠ è½½è½¬å­˜çŠ¶æ€å¤±è´¥:",l)}},Vt=async()=>{if(!(!j.value||j.value.length===0))try{const l=j.value.map(i=>i.id),e=await qe(l);e.data&&(Q.value=e.data,console.log("=== ä¸‹è½½çŠ¶æ€åŠ è½½å®Œæˆ ==="),console.log("çŠ¶æ€æ˜ å°„:",Q.value),console.log("ç¤ºä¾‹æ•°æ®:",Object.entries(Q.value).slice(0,5)))}catch(l){console.error("åŠ è½½ä¸‹è½½çŠ¶æ€å¤±è´¥:",l)}},Nt=l=>{de.value=l,_e()},Yt=()=>{console.log("=== åº”ç”¨è½¬å­˜çŠ¶æ€ç­›é€‰ ==="),console.log("ç­›é€‰æ¡ä»¶:",Me.value),de.value=1,_e()},Ut=()=>{console.log("=== åº”ç”¨ä¸‹è½½çŠ¶æ€ç­›é€‰ ==="),console.log("ç­›é€‰æ¡ä»¶:",Ue.value),de.value=1,_e()},Pt=l=>{Te.value=l,de.value=1,_e()},jt=async()=>{if(!Ye.value.trim()){await _e();return}ne.value=!0;try{const l=await Al(Ye.value);j.value=l.data.filter(e=>e.parentId===oe.value.id||e.id===oe.value.id)}catch(l){p.error("æœç´¢å¤±è´¥: "+l.message)}finally{ne.value=!1}},Ot=async l=>{var e;console.log("æŸ¥çœ‹è¯¦æƒ… - itemId:",l.id,"name:",l.name,"type:",l.type);try{const i=await Ml(l.id);B.value=i.data,at.value=!0}catch(i){console.error("åŠ è½½è¯¦æƒ…å¤±è´¥:",i);let r="åŠ è½½è¯¦æƒ…å¤±è´¥";((e=i.response)==null?void 0:e.status)===404?r=`è¯¥åª’ä½“é¡¹ä¸å­˜åœ¨æˆ–æ— æƒè®¿é—®ï¼ˆID: ${l.id}ï¼‰`:i.message&&(r="åŠ è½½è¯¦æƒ…å¤±è´¥: "+i.message),p.error(r)}},Kt=async l=>{try{const e=await Yl(l.id);Pe.value=e.data||[],st.value=!0}catch(e){console.error("åŠ è½½è½¬å­˜å†å²å¤±è´¥:",e),p.error("åŠ è½½è½¬å­˜å†å²å¤±è´¥: "+e.message)}},ct=async()=>{var l;try{await ue.confirm("æ­¤æ“ä½œå°†ä¸€æ¬¡æ€§å…¨é‡åŒæ­¥æ‰€æœ‰åª’ä½“åº“æ•°æ®åˆ°æ•°æ®åº“ï¼Œå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),ce.value=!0;const e=await Ll();e.data.success?(p.success({message:`åŒæ­¥å®Œæˆï¼å…± ${e.data.totalLibraries} ä¸ªåª’ä½“åº“ï¼Œ${e.data.totalItems} ä¸ªåª’ä½“é¡¹ï¼Œè€—æ—¶ ${e.data.duration}`,duration:5e3}),Ce.value=!0,await Be(),await Ke(),await We(),await He()):e.data.failedLibraries>0?(p.warning({message:`åŒæ­¥å®Œæˆï¼Œä½†æœ‰ ${e.data.failedLibraries} ä¸ªåª’ä½“åº“å¤±è´¥ã€‚æˆåŠŸ: ${e.data.successLibraries} ä¸ªï¼Œåª’ä½“é¡¹: ${e.data.totalItems} ä¸ªã€‚å¤±è´¥çš„åª’ä½“åº“: ${(l=e.data.failedLibraryNames)==null?void 0:l.join(", ")}`,duration:1e4,showClose:!0}),Ce.value=!0,await Be(),await Ke(),await We(),await He()):p.error("åŒæ­¥å¤±è´¥: "+(e.data.error||e.data.message))}catch(e){e!=="cancel"&&p.error("åŒæ­¥å¤±è´¥: "+e.message)}finally{ce.value=!1}},Wt=async()=>{try{await ue.confirm("æ­¤æ“ä½œå°†æ¸…ç©ºæ‰€æœ‰Embyæ•°æ®ç¼“å­˜ï¼Œä¸‹æ¬¡è®¿é—®æ—¶å°†ä»EmbyæœåŠ¡å™¨é‡æ–°è·å–æ•°æ®ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ","è­¦å‘Š",{confirmButtonText:"ç¡®å®šæ¸…ç©º",cancelButtonText:"å–æ¶ˆ",type:"warning"}),ge.value=!0;const l=await fetch("/api/emby/cache/clear",{method:"POST",headers:{"Content-Type":"application/json"}}).then(e=>e.json());l.code===200?(p.success("ç¼“å­˜å·²æ¸…ç©ºï¼Œä¸‹æ¬¡è®¿é—®å°†ä»EmbyæœåŠ¡å™¨è·å–æœ€æ–°æ•°æ®"),ke.value=[],j.value=[],Se.value=[],xe.value=[],ze.value=[]):p.error("æ¸…ç©ºç¼“å­˜å¤±è´¥: "+l.message)}catch(l){l!=="cancel"&&p.error("æ¸…ç©ºç¼“å­˜å¤±è´¥: "+l.message)}finally{ge.value=!1}},rt=l=>{if(!l)return"-";const e=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(l)/Math.log(1024));return(l/Math.pow(1024,i)).toFixed(2)+" "+e[i]},Ht=l=>l?(l/1e6).toFixed(2)+" Mbps":"-",Ge=l=>{if(!l)return"";let e=l;return e=e.replace(/[\u0022\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u201C\u201D\u201E\u201F\u2032\u2033\u2034\u2035\u2036\u2037\u2039\u203A\u275B\u275C\u275D\u275E\u276E\u276F\u2E42\u301D\u301E\u301F\uFF02\uFF07\u00AB\u00BB\u3008\u3009\u300A\u300B\u300C\u300D\u300E\u300F\u3010\u3011]/g,""),e=e.replace(/\([^)]*\)/g," "),e=e.replace(/\[[^\]]*\]/g," "),e=e.replace(/\{[^}]*\}/g," "),e=e.replace(/ï¼ˆ[^ï¼‰]*ï¼‰/g," "),e=e.replace(/ã€[^ã€‘]*ã€‘/g," "),e=e.replace(/ã€”[^ã€•]*ã€•/g," "),e=e.replace(/ã€ˆ[^ã€‰]*ã€‰/g," "),e=e.replace(/ã€Š[^ã€‹]*ã€‹/g," "),e=e.replace(/ï¹[^ï¹]*ï¹/g," "),e=e.replace(/ï¹™[^ï¹š]*ï¹š/g," "),e=e.replace(/[,ï¼Œ.ã€‚:ï¼š;ï¼›!ï¼?ï¼Ÿã€]/g," "),e=e.replace(/[-â€“â€”_~Â·â€¢]/g," "),e=e.replace(/[/\\|]/g," "),e=e.replace(/[&ï¼†@ï¼ #ï¼ƒ$ï¼„%ï¼…^ï¼¾*ï¼Š+=ï¼‹ï¼<>ï¼œï¼]/g," "),e=e.replace(/[\u{1F300}-\u{1F9FF}]/gu,""),e=e.replace(/[\u{2600}-\u{26FF}]/gu,""),e=e.replace(/[\u{2700}-\u{27BF}]/gu,""),e=e.replace(/\s+/g," ").trim(),console.log("æ¸…ç†å…³é”®è¯ - åŸå§‹:",l),console.log("æ¸…ç†å…³é”®è¯ - ç»“æœ:",e),e},Gt=async l=>{E.value=l,xt.value="",zt.value=null,re.value=[],fe.value=null;let e=null;l.providerIds&&l.providerIds.Tmdb?(e=l.providerIds.Tmdb,console.log("æå–åˆ° TMDB ID:",e)):console.log("æœªæ‰¾åˆ° TMDB ID");try{p.info("æ­£åœ¨ä»115èµ„æºåº“æœç´¢åŒ¹é…èµ„æº...");const r=await It(e,l.name,l.originalTitle,l.productionYear);if(r.data){const n=r.data;p.success(`æ‰¾åˆ°åŒ¹é…èµ„æº: ${n.name}`),await nl(n);return}else p.info("115èµ„æºåº“ä¸­æœªæ‰¾åˆ°åŒ¹é…èµ„æºï¼Œå°†ä½¿ç”¨æœç´¢å¼•æ“æœç´¢")}catch(r){console.error("æœç´¢115èµ„æºå¤±è´¥:",r),p.warning("115èµ„æºåº“æœç´¢å¤±è´¥ï¼Œå°†ä½¿ç”¨æœç´¢å¼•æ“æœç´¢")}let i=l.originalTitle||l.name;i=Ge(i),console.log("åŸå§‹å…³é”®è¯:",l.originalTitle||l.name),console.log("æ¸…ç†åå…³é”®è¯:",i),he.value=i,ve.value=!0,Re()},dt=async l=>{try{let e="";l.type==="Series"?e=`ç¡®å®šè¦ä¸‹è½½ç”µè§†å‰§ "${l.name}" çš„æ‰€æœ‰å‰§é›†å—ï¼Ÿ

æ–‡ä»¶å°†ä¿å­˜åˆ°æœåŠ¡å™¨çš„ /data/emby/${l.name}/ ç›®å½•ä¸‹ã€‚

ä¸‹è½½å°†åœ¨åå°è¿›è¡Œï¼Œè¯·æŸ¥çœ‹åç«¯æ—¥å¿—äº†è§£è¿›åº¦ã€‚`:l.type==="Episode"?e=`ç¡®å®šè¦ä¸‹è½½å‰§é›† "${l.name}" å—ï¼Ÿ

æ–‡ä»¶å°†ä¿å­˜åˆ°æœåŠ¡å™¨çš„ /data/emby ç›®å½•ä¸‹ã€‚

ä¸‹è½½å°†åœ¨åå°è¿›è¡Œï¼Œè¯·æŸ¥çœ‹åç«¯æ—¥å¿—äº†è§£è¿›åº¦ã€‚`:e=`ç¡®å®šè¦ä¸‹è½½ "${l.name}" åˆ°æœåŠ¡å™¨å—ï¼Ÿ

æ–‡ä»¶å°†ä¿å­˜åˆ°æœåŠ¡å™¨çš„ /data/emby ç›®å½•ä¸‹ã€‚

ä¸‹è½½å°†åœ¨åå°è¿›è¡Œï¼Œè¯·æŸ¥çœ‹åç«¯æ—¥å¿—äº†è§£è¿›åº¦ã€‚`,await ue.confirm(e,"ç¡®è®¤ä¸‹è½½",{confirmButtonText:"ç¡®å®šä¸‹è½½",cancelButtonText:"å–æ¶ˆ",type:"warning"});try{const i=await Vl(l.id);if(i.data&&i.data.status==="started"){p.success({message:"ä¸‹è½½ä»»åŠ¡å·²å¯åŠ¨ï¼ä¸‹è½½å®Œæˆåå°†è‡ªåŠ¨åˆ·æ–°çŠ¶æ€ã€‚",duration:5e3});let r=0;const n=30,d=setInterval(async()=>{if(r++,j.value&&j.value.length>0){const m=j.value.map(v=>v.id);try{const v=await qe(m);v.data&&Object.assign(Q.value,v.data)}catch(v){console.error("åˆ·æ–°ä¸‹è½½çŠ¶æ€å¤±è´¥:",v)}}r>=n&&clearInterval(d)},1e4)}else p.error("å¯åŠ¨ä¸‹è½½å¤±è´¥")}catch(i){console.error("å¯åŠ¨ä¸‹è½½å¤±è´¥:",i),p.error("å¯åŠ¨ä¸‹è½½å¤±è´¥: "+(i.message||"æœªçŸ¥é”™è¯¯"))}}catch{}},Qt=async l=>{try{await ue.confirm(`ç¡®å®šè¦å°† "${l.name}" æ ‡è®°ä¸ºå·²ä¸‹è½½å—ï¼Ÿ`,"ç¡®è®¤æ ‡è®°",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"});try{const e=await Pl(l.id,"success");e.code===200?(p.success("æ ‡è®°æˆåŠŸ"),Q.value[l.id]="success"):p.error("æ ‡è®°å¤±è´¥: "+(e.message||"æœªçŸ¥é”™è¯¯"))}catch(e){console.error("æ ‡è®°å¤±è´¥:",e),p.error("æ ‡è®°å¤±è´¥: "+(e.message||"æœªçŸ¥é”™è¯¯"))}}catch{}},Re=async()=>{var l,e,i,r;if(!he.value){p.warning("è¯·è¾“å…¥æœç´¢å…³é”®è¯");return}je.value=!0,re.value=[],fe.value=null;try{const n=await Tt(he.value,!0);console.log("=== æœç´¢è¿”å›åŸå§‹ç»“æœ ==="),console.log("å®Œæ•´å“åº”:",n),console.log("res.data:",n.data),console.log("res.data.channels:",(l=n.data)==null?void 0:l.channels),console.log("res.data.channel_info_list:",(e=n.data)==null?void 0:e.channel_info_list);let d=[];const m=((i=n.data)==null?void 0:i.channels)||((r=n.data)==null?void 0:r.channel_info_list);if(m&&Array.isArray(m)?(console.log(`æ‰¾åˆ° ${m.length} ä¸ªé¢‘é“`),m.forEach((v,x)=>{const C=v.channelInfo||{};console.log(`
=== é¢‘é“ ${x+1}: ${C.name||"æœªçŸ¥"} ===`),v.messages&&Array.isArray(v.messages)&&(console.log(`  - messages æ•°ç»„é•¿åº¦: ${v.messages.length}`),v.messages.forEach((y,S)=>{var w,D;console.log(`    æ¶ˆæ¯ ${S+1}:`,{messageId:y.messageId,title:(w=y.title)==null?void 0:w.substring(0,50),text:(D=y.text)==null?void 0:D.substring(0,50),cloudLinks:y.cloudLinks}),y.cloudLinks&&y.cloudLinks.length>0&&y.cloudLinks.forEach((z,_)=>{const c=y.title||y.text,V=Qe(c);console.log(`      é“¾æ¥ ${_+1}: ${z}`),console.log(`      æå–çš„æ ‡é¢˜: ${V}`),d.push({id:`${y.messageId}-${_}`,messageId:y.messageId,title:V,rawTitle:c,description:y.text||y.content,url:z,link:z,share_url:z,size:pt(y.text||y.content),resolution:mt(y.text||y.content),tags:y.tags||[],image:y.image,cloudType:y.cloudType,channelId:y.channelId||C.id,channelName:C.name||"æœªçŸ¥æ¥æº"})})})),v.list&&Array.isArray(v.list)&&(console.log(`  - list æ•°ç»„é•¿åº¦: ${v.list.length}`),v.list.forEach((y,S)=>{var w,D;console.log(`    é¡¹ç›® ${S+1}:`,{messageId:y.messageId,title:(w=y.title)==null?void 0:w.substring(0,50),content:(D=y.content)==null?void 0:D.substring(0,50),cloudLinks:y.cloudLinks}),y.cloudLinks&&y.cloudLinks.length>0&&y.cloudLinks.forEach((z,_)=>{const c=y.title||y.content,V=Qe(c);console.log(`      é“¾æ¥ ${_+1}: ${z}`),console.log(`      æå–çš„æ ‡é¢˜: ${V}`),d.push({id:`${y.messageId}-${_}`,messageId:y.messageId,title:V,rawTitle:c,description:y.content||y.title,url:z,link:z,share_url:z,size:pt(y.content||y.title),resolution:mt(y.content||y.title),tags:y.tags||[],image:y.image,cloudType:y.cloudType,channelId:y.channelId||C.id,channelName:C.name||"æœªçŸ¥æ¥æº",pubDate:y.pubDate})})}))})):Array.isArray(n)?(console.log("å“åº”æ˜¯æ•°ç»„æ ¼å¼"),d=n):n.data&&Array.isArray(n.data)?(console.log("res.data æ˜¯æ•°ç»„æ ¼å¼"),d=n.data):n.results&&Array.isArray(n.results)?(console.log("res.results æ˜¯æ•°ç»„æ ¼å¼"),d=n.results):console.error("æ— æ³•è¯†åˆ«çš„æ•°æ®æ ¼å¼:",n),console.log(`
=== æœ€ç»ˆç»“æœ ===`),console.log(`æ€»å…±æå–äº† ${d.length} ä¸ªç»“æœ`),console.log("å‰3ä¸ªç»“æœ:",d.slice(0,3)),d.length>0&&(d=ft(d,he.value,E.value),console.log("æ’åºåå‰3ä¸ªç»“æœ:",d.slice(0,3))),Ee.value&&d.length>0&&await Jt(d),re.value=d,d.length>0){const x=d.filter(C=>C.matchScore>=30);if(x.length===0){p.warning("æœªæ‰¾åˆ°ç¬¦åˆè¦æ±‚çš„èµ„æºï¼ˆæ‰€æœ‰ç»“æœè¯„åˆ†è¿‡ä½ï¼‰");return}console.log(`
=== ç­›é€‰ç»“æœ ===`),console.log(`åŸå§‹ç»“æœ: ${d.length} ä¸ª`),console.log(`åˆæ ¼ç»“æœ: ${x.length} ä¸ªï¼ˆè¯„åˆ†â‰¥30ï¼‰`),p.success(`æ‰¾åˆ° ${x.length} ä¸ªåˆæ ¼ç»“æœï¼Œå‡†å¤‡è‡ªåŠ¨è½¬å­˜`),await sl(x)}else p.warning("æœªæ‰¾åˆ°æœç´¢ç»“æœ")}catch(n){console.error("æœç´¢å¤±è´¥:",n),re.value=[]}finally{je.value=!1}},Jt=async l=>{console.log(`
=== å¼€å§‹AIæ™ºèƒ½ç­›é€‰ ===`),nt.value=!0;try{const e={name:E.value.name,originalTitle:E.value.originalTitle,productionYear:E.value.productionYear,communityRating:E.value.communityRating,genres:E.value.genres,overview:E.value.overview},i=l.slice(0,10).map(n=>{var d;return{id:n.id,title:n.title,size:n.size,resolution:n.resolution,tags:n.tags,description:(d=n.description)==null?void 0:d.substring(0,200),matchScore:n.matchScore,isValid:n.isValid,hasFiles:n.hasFiles}});console.log("å‘é€ç»™AIçš„æ•°æ®:",{movieInfo:e,resourceCount:i.length});const r=await Tl(e,i);if(console.log("AIç­›é€‰ç»“æœ:",r),r.data&&r.data.title_match===!1){console.log("AIåˆ¤æ–­: æ‰€æœ‰èµ„æºéƒ½ä¸åŒ¹é…"),p.warning(`AIåˆ¤æ–­: ${r.data.reason}`),l.length=0;return}if(r.data&&r.data.best_resource_id){const n=r.data.best_resource_id,d=l.find(m=>m.id===n);if(d){d.aiRecommended=!0,d.aiReason=r.data.reason,d.matchScore+=15,d.matchReasons.push("AIæ¨è: +15åˆ†"),console.log("AIæ¨èèµ„æº:",d.title),console.log("æ¨èç†ç”±:",r.data.reason);const m=l.indexOf(d);m>0&&(l.splice(m,1),l.unshift(d))}}}catch(e){console.error("AIç­›é€‰å¤±è´¥:",e),p.warning("AIç­›é€‰æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œä½¿ç”¨è§„åˆ™ç­›é€‰")}finally{nt.value=!1}},ft=(l,e,i)=>{var d,m;console.log(`
=== å¼€å§‹æ™ºèƒ½æ’åº ===`),console.log("æœç´¢å…³é”®è¯:",e),console.log("ç”µå½±ä¿¡æ¯:",i);let r={titleMatch:40,resolution:20,fileSize:15,tagMatch:10,sourceCredibility:10,timeliness:5};try{const v=localStorage.getItem("smartSearchConfig");if(v){const x=JSON.parse(v);x.weights&&(r=x.weights,console.log("ä½¿ç”¨è‡ªå®šä¹‰æƒé‡:",r))}}catch(v){console.error("åŠ è½½æƒé‡é…ç½®å¤±è´¥:",v)}const n=l.map(v=>{let x=0;const C=[],y=qt(v.title,e,i,r.titleMatch);x+=y,y>0&&C.push(`æ ‡é¢˜åŒ¹é…: ${y.toFixed(1)}åˆ†`);const S=Xt(v.resolution,v.description,r.resolution);x+=S,S>0&&C.push(`åˆ†è¾¨ç‡: ${S.toFixed(1)}åˆ†`);const w=Zt(v.size,r.fileSize);x+=w,w>0&&C.push(`æ–‡ä»¶å¤§å°: ${w.toFixed(1)}åˆ†`);const D=el(v.tags,i,r.tagMatch);x+=D,D>0&&C.push(`æ ‡ç­¾åŒ¹é…: ${D.toFixed(1)}åˆ†`);const z=tl(v.channelName,v.cloudType,r.sourceCredibility);x+=z,z>0&&C.push(`æ¥æº: ${z.toFixed(1)}åˆ†`);const _=ll(v.pubDate,r.timeliness);return x+=_,_>0&&C.push(`æ—¶æ•ˆæ€§: ${_.toFixed(1)}åˆ†`),console.log(`
èµ„æº: ${v.title}`),console.log(`æ€»åˆ†: ${x.toFixed(1)}`),console.log(`è¯„åˆ†è¯¦æƒ…: ${C.join(", ")}`),{...v,matchScore:x,matchReasons:C}});return n.sort((v,x)=>x.matchScore-v.matchScore),console.log(`
=== æ’åºå®Œæˆ ===`),console.log("æœ€ä½³åŒ¹é…:",(d=n[0])==null?void 0:d.title,"å¾—åˆ†:",(m=n[0])==null?void 0:m.matchScore.toFixed(1)),n},qt=(l,e,i,r=40)=>{let n=0;const d=l.toLowerCase(),m=e.toLowerCase();if(d.includes(m))n+=r;else{const v=m.split(""),x=v.filter(C=>d.includes(C));n+=x.length/v.length*(r*.75)}if(i!=null&&i.originalTitle){const v=i.originalTitle.toLowerCase();d.includes(v)&&(n+=r*.25)}return Math.min(n,r)},Xt=(l,e,i=20)=>{const n=((l||"")+" "+(e||"")).toLowerCase();return n.includes("4k")||n.includes("2160p")?i:n.includes("remux")||n.includes("è“å…‰åŸç›˜")?i*.9:n.includes("1080p")||n.includes("bluray")?i*.75:n.includes("720p")?i*.5:n.includes("480p")?i*.25:0},Zt=(l,e=15)=>{if(!l||l==="-"||l==="N")return 0;const i=l.match(/(\d+\.?\d*)\s*(GB|MB|TB)/i);if(!i)return 0;const r=parseFloat(i[1]),n=i[2].toUpperCase();let d=r;return n==="MB"?d=r/1024:n==="TB"&&(d=r*1024),d>=10&&d<=50?e:d>=5&&d<=80?e*.67:d>=2&&d<=100?e*.33:0},el=(l,e,i=10)=>{if(!l||l.length===0)return 0;let r=0;const n=["#ç”µå½±","#movie","#å‰§æƒ…","#åŠ¨ä½œ","#å–œå‰§","#ç§‘å¹»"];l.some(x=>n.some(C=>x.toLowerCase().includes(C.toLowerCase())))&&(r+=i*.5);const m=["#è“å…‰","#é«˜æ¸…","#4k","#remux","#bluray"];return l.some(x=>m.some(C=>x.toLowerCase().includes(C.toLowerCase())))&&(r+=i*.5),Math.min(r,i)},tl=(l,e,i=10)=>{let r=i*.5;return e==="channel_alipan"&&(r+=i*.3),["ali-01","å¤©ç¿¼äº‘ç›˜","shareAliyun"].includes(l)&&(r+=i*.2),Math.min(r,i)},ll=(l,e=5)=>{if(!l)return 0;try{const i=new Date(l),n=(new Date-i)/(1e3*60*60*24);if(n<=30)return e;if(n<=90)return e*.6;if(n<=180)return e*.2}catch(i){console.error("è§£æå‘å¸ƒæ—¶é—´å¤±è´¥:",i)}return 0},Qe=l=>{if(!l)return"æœªçŸ¥æ ‡é¢˜";if(!l.includes(`
`)&&l.length<100)return l.trim();l=l.replace(/https?:\/\/[^\s]+/g,"");const e=l.split(`
`).map(r=>r.trim()).filter(r=>r.length>0);for(let r=0;r<Math.min(5,e.length);r++){const n=e[r];if(!(n.includes("æœ¬ç‰‡")||n.includes("æè¿°ï¼š")||n.includes("ç®€ä»‹ï¼š")||n.includes("é“¾æ¥ï¼š")||n.includes("ğŸ“")||n.includes("ğŸ·")||n.includes("ğŸ‰")||n.includes("âš ï¸")||n.includes("ğŸ“¢")||n.includes("ğŸ‘¥")||n.includes("ğŸ¤–")||n.startsWith("å¤§å°")||n.startsWith("æ ‡ç­¾")||n.startsWith("æ¥è‡ª")||n.startsWith("ç‰ˆæƒ")||n.startsWith("é¢‘é“")||n.startsWith("ç¾¤ç»„")||n.startsWith("æŠ•ç¨¿"))&&!(n.length<2)&&n.length>=2){let d=n.replace(/^åç§°[ï¼š:]\s*/g,"").replace(/^æ ‡é¢˜[ï¼š:]\s*/g,"").replace(/\s*\(\d{4}\)\s*/g," ").replace(/\s*ï¼ˆ\d{4}ï¼‰\s*/g," ").trim();if(d.length>60){const m=d.substring(0,60).lastIndexOf(" ");m>30?d=d.substring(0,m)+"...":d=d.substring(0,60)+"..."}return d}}const i=e[0]||"æœªçŸ¥æ ‡é¢˜";return i.substring(0,60)+(i.length>60?"...":"")},pt=l=>{if(!l)return"-";const e=[/ğŸ“\s*å¤§å°[ï¼š:]\s*([^\n]+)/,/å¤§å°[ï¼š:]\s*([^\n]+)/,/(\d+\.?\d*\s*[KMGT]B)/i,/\((\d+\.?\d*\s*[KMGT]B)\)/i];for(const i of e){const r=l.match(i);if(r)return r[1].trim()}return"-"},mt=l=>{if(!l)return null;const e=["4K","2160p","1080p","720p","480p","REMUX","BluRay","Blu-ray","WEB-DL","WEBRip","è“å…‰","è“å…‰åŸç›˜","è¶…æ¸…","é«˜æ¸…","æ ‡æ¸…","HDR","SDR","Dolby","æœæ¯”"];for(const i of e)if(l.includes(i))return i;return null},al=l=>{fe.value=l},sl=async(l,e=null)=>{var x,C,y,S;const i=e||Math.min(l.length,10);console.log(`
=== å¼€å§‹è‡ªåŠ¨è½¬å­˜ ===`),console.log(`å€™é€‰èµ„æºæ•°: ${l.length}`),console.log(`æœ€å¤šå°è¯•: ${i} æ¬¡`);const r={};l.forEach(w=>{const D=w.cloudType;r[D]||(r[D]=[]),r[D].push(w)}),console.log(`
=== äº‘ç›˜èµ„æºåˆ†å¸ƒ ===`),Object.keys(r).forEach(w=>{console.log(`${w}: ${r[w].length} ä¸ª`)});const n=ie.value.filter(w=>r[w.cloudType]).sort((w,D)=>(w.priority||999)-(D.priority||999));console.log(`
=== äº‘ç›˜ä¼˜å…ˆçº§æ’åº ===`),n.forEach((w,D)=>{console.log(`${D+1}. ${w.cloudType} (ä¼˜å…ˆçº§: ${w.priority||"æœªè®¾ç½®"}) - ${r[w.cloudType].length} ä¸ªèµ„æº`)});const d=[],m={};for(n.forEach(w=>{m[w.cloudType]=0});d.length<i;){let w=!1;for(const D of n){const z=D.cloudType,_=r[z];if(m[z]<_.length&&(d.push(_[m[z]++]),w=!0,d.length>=i))break}if(!w)break}console.log(`
=== ä¼˜å…ˆçº§æ’åºå ===`),d.slice(0,10).forEach((w,D)=>{var z;console.log(`${D+1}. [${w.cloudType}] ${w.title.substring(0,50)} - è¯„åˆ†: ${(z=w.matchScore)==null?void 0:z.toFixed(1)}`)}),we.value=!0;const v=[];try{let w=0,D=null;for(let z=0;z<d.length&&w<i;z++){const _=d[z];console.log(`
--- æ£€æŸ¥èµ„æº ${z+1}/${d.length} ---`),console.log(`èµ„æº: ${_.title}`),console.log(`è¯„åˆ†: ${(x=_.matchScore)==null?void 0:x.toFixed(1)}`),console.log(`cloudType: ${_.cloudType}`);const c=_.url||_.link||_.share_url;if(!c){console.log("âœ— è·³è¿‡: æ²¡æœ‰æœ‰æ•ˆé“¾æ¥");continue}const V=ot(_.cloudType);if(!V){console.log(`âœ— è·³è¿‡: æœªé…ç½® ${_.cloudType}`);continue}if(!V.parentId){console.log(`âœ— è·³è¿‡: ${V.name} æœªè®¾ç½®ç›®å½•ID`);continue}w++,console.log(`
>>> å¼€å§‹ç¬¬ ${w} æ¬¡è½¬å­˜å°è¯• <<<`),console.log(`ä½¿ç”¨äº‘ç›˜: ${V.name} (${V.cloudType})`);try{p.info(`æ­£åœ¨è½¬å­˜: ${_.title}`);const K=await it(c,V.parentId,V.cloudType);console.log("è½¬å­˜å“åº”:",K);const Y=K.success||K.code===0||K.code===200||K.status==="success",N=K.message||K.msg||K.error||(Y?"è½¬å­˜æˆåŠŸ":"è½¬å­˜å¤±è´¥"),U={embyItemId:E.value.id,embyItemName:E.value.name,embyItemYear:E.value.productionYear,resourceId:_.id,resourceTitle:_.title,resourceUrl:c,matchScore:_.matchScore,cloudType:_.cloudType,cloudName:V.name,parentId:V.parentId,transferStatus:Y?"success":"failed",transferMessage:N};try{await me(U)}catch(H){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",H)}if(v.push({...U,index:z+1,total:l.length}),Y){D=_,console.log("âœ“âœ“âœ“ è½¬å­˜æˆåŠŸï¼âœ“âœ“âœ“"),p.success({message:`è½¬å­˜æˆåŠŸï¼
èµ„æº: ${_.title}
è¯„åˆ†: ${(C=_.matchScore)==null?void 0:C.toFixed(1)}åˆ†
äº‘ç›˜: ${V.name}`,duration:5e3,showClose:!0}),q.value[E.value.id]="success",ve.value=!1;break}else console.log(`âœ— è½¬å­˜å¤±è´¥: ${N}`),p.warning({message:`è½¬å­˜å¤±è´¥: ${N}`,duration:3e3}),w<i&&(console.log("ç»§ç»­å°è¯•ä¸‹ä¸€ä¸ªèµ„æº..."),await new Promise(H=>setTimeout(H,1e3)))}catch(K){console.error("âœ— è½¬å­˜å¼‚å¸¸:",K);const Y=((S=(y=K.response)==null?void 0:y.data)==null?void 0:S.message)||K.message||"æœªçŸ¥é”™è¯¯",N={embyItemId:E.value.id,embyItemName:E.value.name,embyItemYear:E.value.productionYear,resourceId:_.id,resourceTitle:_.title,resourceUrl:c,matchScore:_.matchScore,cloudType:_.cloudType,cloudName:V.name,parentId:V.parentId,transferStatus:"failed",transferMessage:Y};try{await me(N)}catch(U){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",U)}v.push({...N,index:z+1,total:l.length}),p.warning({message:`è½¬å­˜å¤±è´¥: ${Y}`,duration:3e3}),w<e&&(console.log("ç»§ç»­å°è¯•ä¸‹ä¸€ä¸ªèµ„æº..."),await new Promise(U=>setTimeout(U,1e3)))}}if(console.log(`
=== è½¬å­˜è®°å½• ===`),console.log(`å°è¯•æ¬¡æ•°: ${v.length}`),v.forEach((z,_)=>{const c=z.transferStatus==="success"?"âœ“ æˆåŠŸ":"âœ— å¤±è´¥";console.log(`${_+1}. ${c} - ${z.resourceTitle} - ${z.transferMessage}`)}),D)console.log(`
=== è½¬å­˜å®Œæˆ ===`),console.log(`æˆåŠŸè½¬å­˜: ${D.title}`),console.log(`å®é™…å°è¯•æ¬¡æ•°: ${w}`);else{console.log(`
=== è½¬å­˜å¤±è´¥ ===`),console.log(`å·²å°è¯• ${w} æ¬¡ï¼Œå…¨éƒ¨å¤±è´¥`);let z=`è‡ªåŠ¨è½¬å­˜å¤±è´¥ï¼å·²å°è¯• ${w} ä¸ªèµ„æºï¼š

`;v.forEach((_,c)=>{z+=`${c+1}. ${_.resourceTitle}
   çŠ¶æ€: ${_.transferStatus==="success"?"æˆåŠŸ":"å¤±è´¥"}
   åŸå› : ${_.transferMessage}

`}),ue.alert(z,"è½¬å­˜ç»“æœ",{confirmButtonText:"ç¡®å®š",type:"warning",dangerouslyUseHTMLString:!1})}}catch(w){console.error("è‡ªåŠ¨è½¬å­˜å¼‚å¸¸:",w),p.error("è‡ªåŠ¨è½¬å­˜å¤±è´¥: "+w.message)}finally{we.value=!1}},nl=async l=>{var e,i,r,n;try{we.value=!0,p.info(`æ­£åœ¨è½¬å­˜: ${l.name}`);const d=await Ct(l.url,l.code);console.log("115èµ„æºè½¬å­˜ç»“æœ:",d);const m=d.code===200||d.success===!0,v=d.message||d.msg||d.error||(m?"è½¬å­˜æˆåŠŸ":"è½¬å­˜å¤±è´¥"),x={embyItemId:E.value.id,embyItemName:E.value.name,embyItemYear:E.value.productionYear,resourceId:(e=l.id)==null?void 0:e.toString(),resourceTitle:l.name,resourceUrl:l.url,matchScore:100,cloudType:"115",cloudName:"115ç½‘ç›˜",parentId:"0",transferStatus:m?"success":"failed",transferMessage:v};try{await me(x)}catch(C){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",C)}if(m)p.success({message:`è½¬å­˜æˆåŠŸï¼
èµ„æº: ${l.name}
æ¥æº: 115èµ„æºåº“`,duration:5e3,showClose:!0}),q.value[E.value.id]="success",ve.value=!1;else{p.error(`è½¬å­˜å¤±è´¥: ${v}`),p.info("å°†ä½¿ç”¨æœç´¢å¼•æ“ç»§ç»­æœç´¢èµ„æº");let C=E.value.originalTitle||E.value.name;C=Ge(C),he.value=C,ve.value=!0,Re()}}catch(d){console.error("115èµ„æºè½¬å­˜å¼‚å¸¸:",d);const m=((r=(i=d.response)==null?void 0:i.data)==null?void 0:r.message)||d.message||"è½¬å­˜å¤±è´¥",v={embyItemId:E.value.id,embyItemName:E.value.name,embyItemYear:E.value.productionYear,resourceId:(n=l.id)==null?void 0:n.toString(),resourceTitle:l.name,resourceUrl:l.url,matchScore:100,cloudType:"115",cloudName:"115",parentId:"",transferStatus:"failed",transferMessage:m};try{await me(v)}catch(C){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",C)}p.error(`è½¬å­˜å¤±è´¥: ${m}`),p.info("å°†ä½¿ç”¨æœç´¢å¼•æ“ç»§ç»­æœç´¢èµ„æº");let x=E.value.originalTitle||E.value.name;x=Ge(x),he.value=x,ve.value=!0,Re()}finally{we.value=!1}},ol=async()=>{var n,d,m,v,x,C,y,S,w,D,z;const l=j.value.filter(_=>_.type==="Movie"||_.type==="Series");if(l.length===0){p.warning("å½“å‰é¡µæ²¡æœ‰å¯ä¸‹è½½çš„åª’ä½“é¡¹ï¼ˆä»…æ”¯æŒç”µå½±å’Œå‰§é›†ï¼‰");return}try{await ue.confirm(`ç¡®å®šè¦æ‰¹é‡ä¸‹è½½å½“å‰é¡µçš„ ${l.length} ä¸ªåª’ä½“é¡¹å—ï¼Ÿ

æ­¤æ“ä½œå°†ä¾æ¬¡æœç´¢å¹¶ä¸‹è½½æ¯ä¸ªåª’ä½“é¡¹ï¼Œå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ã€‚`,"æ‰¹é‡ä¸‹è½½ç¡®è®¤",{confirmButtonText:"å¼€å§‹ä¸‹è½½",cancelButtonText:"å–æ¶ˆ",type:"warning"})}catch{return}Xe.value=!0;let e=0,i=0,r=0;p.info(`å¼€å§‹æ‰¹é‡ä¸‹è½½ï¼Œå…± ${l.length} ä¸ªåª’ä½“é¡¹`);for(let _=0;_<l.length;_++){const c=l[_];try{if(p.info(`[${_+1}/${l.length}] æ­£åœ¨å¤„ç†: ${c.name}`),q.value[c.id]==="success"){p.info(`è·³è¿‡å·²è½¬å­˜: ${c.name}`),r++;continue}let V=null;c.providerIds&&c.providerIds.Tmdb&&(V=c.providerIds.Tmdb);let K=!1;try{const Y=await It(V,c.name,c.originalTitle,c.productionYear);if(Y.data){const N=Y.data;p.success(`æ‰¾åˆ°115èµ„æº: ${N.name}`),E.value=c;try{p.info(`æ­£åœ¨è½¬å­˜115èµ„æº: ${N.name}`);const U=await Ct(N.url,N.code),H=U.code===200||U.success===!0,O=U.message||U.msg||U.error||(H?"è½¬å­˜æˆåŠŸ":"è½¬å­˜å¤±è´¥"),pe={embyItemId:c.id,embyItemName:c.name,embyItemYear:c.productionYear,resourceId:(n=N.id)==null?void 0:n.toString(),resourceTitle:N.name,resourceUrl:N.url,matchScore:100,cloudType:"115",cloudName:"115ç½‘ç›˜",parentId:"0",transferStatus:H?"success":"failed",transferMessage:O};try{await me(pe)}catch(W){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",W)}if(H){p.success(`è½¬å­˜æˆåŠŸ: ${c.name}`),e++,K=!0,q.value[c.id]="success",await new Promise(W=>setTimeout(W,1e3));continue}else console.log(`115è½¬å­˜å¤±è´¥: ${O}ï¼Œå°†ä½¿ç”¨æœç´¢å¼•æ“æœç´¢`),p.warning(`115è½¬å­˜å¤±è´¥: ${O.substring(0,30)}ï¼Œå°è¯•æœç´¢å¼•æ“...`)}catch(U){console.error(`115è½¬å­˜å¼‚å¸¸ [${c.name}]:`,U);const H=((m=(d=U.response)==null?void 0:d.data)==null?void 0:m.message)||U.message||"è½¬å­˜å¼‚å¸¸";try{await me({embyItemId:c.id,embyItemName:c.name,embyItemYear:c.productionYear,resourceId:(v=N.id)==null?void 0:v.toString(),resourceTitle:N.name,resourceUrl:N.url,matchScore:100,cloudType:"115",cloudName:"115ç½‘ç›˜",parentId:"0",transferStatus:"failed",transferMessage:`è½¬å­˜å¼‚å¸¸: ${H}`})}catch(O){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",O)}p.warning("115è½¬å­˜å¼‚å¸¸ï¼Œå°è¯•æœç´¢å¼•æ“...")}}}catch(Y){console.error(`æœç´¢115èµ„æºå¤±è´¥ [${c.name}]:`,Y)}if(!K){p.info(`115èµ„æºåº“æœªæ‰¾åˆ°ï¼Œä½¿ç”¨æœç´¢å¼•æ“æœç´¢: ${c.name}`);try{E.value=c;let Y=c.originalTitle||c.name;Y=Ge(Y),c.productionYear&&(Y+=` ${c.productionYear}`),console.log(`æœç´¢å…³é”®è¯: ${Y}`);const N=await Tt(Y);if(!N||!N.data){p.warning(`æœç´¢å¤±è´¥: ${c.name}`),i++,await new Promise(h=>setTimeout(h,1e3));continue}let U=[];const H=((x=N.data)==null?void 0:x.channels)||((C=N.data)==null?void 0:C.channel_info_list);if(H&&Array.isArray(H)&&H.forEach(h=>{const M=h.channelInfo||{};h.messages&&Array.isArray(h.messages)&&h.messages.forEach(R=>{R.cloudLinks&&R.cloudLinks.length>0&&R.cloudLinks.forEach((L,se)=>{const J=R.title||R.text,$e=Qe(J);U.push({id:`${R.messageId}-${se}`,messageId:R.messageId,title:$e,rawTitle:J,url:L,link:L,cloudType:R.cloudType,channelName:M.name||"æœªçŸ¥æ¥æº"})})}),h.list&&Array.isArray(h.list)&&h.list.forEach(R=>{R.cloudLinks&&R.cloudLinks.length>0&&R.cloudLinks.forEach((L,se)=>{const J=R.title||R.content,$e=Qe(J);U.push({id:`${R.messageId}-${se}`,messageId:R.messageId,title:$e,rawTitle:J,url:L,link:L,cloudType:R.cloudType,channelName:M.name||"æœªçŸ¥æ¥æº"})})})}),U.length===0){p.warning(`æœªæ‰¾åˆ°æœç´¢ç»“æœ: ${c.name}`),i++,await new Promise(h=>setTimeout(h,1e3));continue}U=ft(U,Y,c);const O={};U.forEach(h=>{const M=h.cloudType;O[M]||(O[M]=[]),O[M].push(h)}),console.log(`
=== äº‘ç›˜èµ„æºåˆ†å¸ƒ ===`),Object.keys(O).forEach(h=>{console.log(`${h}: ${O[h].length} ä¸ª`)});const pe=ie.value.filter(h=>O[h.cloudType]).sort((h,M)=>(h.priority||999)-(M.priority||999));console.log(`
=== äº‘ç›˜ä¼˜å…ˆçº§æ’åº ===`),pe.forEach((h,M)=>{console.log(`${M+1}. ${h.cloudType} (ä¼˜å…ˆçº§: ${h.priority||"æœªè®¾ç½®"}) - ${O[h.cloudType].length} ä¸ªèµ„æº`)});const W=[],Ie={},De=10;for(pe.forEach(h=>{Ie[h.cloudType]=0});W.length<De;){let h=!1;for(const M of pe){const R=M.cloudType,L=O[R];if(Ie[R]<L.length&&(W.push(L[Ie[R]++]),h=!0,W.length>=De))break}if(!h)break}console.log(`
=== ä¼˜å…ˆçº§æ’åºåï¼Œå°†å°è¯• ${W.length} ä¸ªèµ„æº ===`),W.forEach((h,M)=>{console.log(`${M+1}. [${h.cloudType}] ${h.title.substring(0,40)}`)});let ae=!1,le="";for(let h=0;h<W.length;h++){const M=W[h];h===0?p.info(`æ‰¾åˆ°æœ€ä½³åŒ¹é… [${M.cloudType}]: ${M.title.substring(0,30)}`):p.info(`å°è¯•å¤‡é€‰æ–¹æ¡ˆ ${h+1} [${M.cloudType}]: ${M.title.substring(0,30)}`);const R=ot(M.cloudType);if(!R||!R.parentId){le=`æœªé…ç½® ${M.cloudType} äº‘ç›˜`,console.log(`è·³è¿‡: ${le}`);continue}try{const L=await it(M.url,R.parentId,R.cloudType);if(L&&(L.success===!0||L.code===200||L.code===0||L.status==="success")){p.success(`è½¬å­˜æˆåŠŸ: ${c.name}${h>0?` (ç¬¬${h+1}æ¬¡å°è¯•)`:""}`),e++,ae=!0,q.value[c.id]=!0;try{await me({embyItemId:c.id,embyItemName:c.name,embyItemYear:c.productionYear,resourceId:(y=M.id)==null?void 0:y.toString(),resourceTitle:M.title,resourceUrl:M.url,matchScore:M.matchScore||0,cloudType:M.cloudType,cloudName:R.name,parentId:R.parentId,transferStatus:"success",transferMessage:`è½¬å­˜æˆåŠŸ${h>0?` (ç¬¬${h+1}æ¬¡å°è¯•)`:""}`})}catch(J){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",J)}break}else{le=(L==null?void 0:L.message)||(L==null?void 0:L.msg)||"è½¬å­˜å¤±è´¥",console.log(`è½¬å­˜å¤±è´¥ (å°è¯• ${h+1}/${W.length}): ${le}`);try{await me({embyItemId:c.id,embyItemName:c.name,embyItemYear:c.productionYear,resourceId:(S=M.id)==null?void 0:S.toString(),resourceTitle:M.title,resourceUrl:M.url,matchScore:M.matchScore||0,cloudType:M.cloudType,cloudName:R.name,parentId:R.parentId,transferStatus:"failed",transferMessage:`${le} (ç¬¬${h+1}æ¬¡å°è¯•)`})}catch(J){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",J)}h<W.length-1&&(p.warning(`è½¬å­˜å¤±è´¥: ${le.substring(0,50)}ï¼Œå°è¯•ä¸‹ä¸€ä¸ª...`),await new Promise(J=>setTimeout(J,500)))}}catch(L){le=((D=(w=L.response)==null?void 0:w.data)==null?void 0:D.message)||L.message||"è½¬å­˜å¼‚å¸¸",console.error(`è½¬å­˜å¼‚å¸¸ (å°è¯• ${h+1}/${W.length}):`,L);try{await me({embyItemId:c.id,embyItemName:c.name,embyItemYear:c.productionYear,resourceId:(z=M.id)==null?void 0:z.toString(),resourceTitle:M.title,resourceUrl:M.url,matchScore:M.matchScore||0,cloudType:M.cloudType,cloudName:R.name,parentId:R.parentId,transferStatus:"failed",transferMessage:`è½¬å­˜å¼‚å¸¸: ${le} (ç¬¬${h+1}æ¬¡å°è¯•)`})}catch(se){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",se)}h<W.length-1&&(p.warning("è½¬å­˜å¼‚å¸¸ï¼Œå°è¯•ä¸‹ä¸€ä¸ª..."),await new Promise(se=>setTimeout(se,500)))}}ae||(p.error(`è½¬å­˜å¤±è´¥ (å·²å°è¯•${W.length}æ¬¡): ${c.name} - ${le}`),i++),await new Promise(h=>setTimeout(h,1e3))}catch(Y){console.error(`æœç´¢å¼•æ“æœç´¢å¤±è´¥ [${c.name}]:`,Y),p.error(`æœç´¢å¤±è´¥: ${c.name}`),i++,await new Promise(N=>setTimeout(N,1e3))}}await new Promise(Y=>setTimeout(Y,1e3))}catch(V){console.error(`å¤„ç†å¤±è´¥ [${c.name}]:`,V),p.error(`å¤„ç†å¤±è´¥: ${c.name}`),i++}}Xe.value=!1,ue.alert(`æ‰¹é‡ä¸‹è½½å®Œæˆï¼

æˆåŠŸ: ${e} ä¸ª
å¤±è´¥: ${i} ä¸ª
è·³è¿‡: ${r} ä¸ª`,"æ‰¹é‡ä¸‹è½½ç»“æœ",{confirmButtonText:"ç¡®å®š",type:e>0?"success":"info"})},rl=async()=>{const l=j.value.filter(i=>i.type==="Movie"||i.type==="Series");if(l.length===0){p.warning("å½“å‰é¡µæ²¡æœ‰å¯ä¸‹è½½çš„åª’ä½“é¡¹ï¼ˆä»…æ”¯æŒç”µå½±å’Œå‰§é›†ï¼‰");return}const e=l.filter(i=>Q.value[i.id]!=="success");if(e.length===0){p.info("å½“å‰é¡µæ‰€æœ‰åª’ä½“é¡¹éƒ½å·²ä¸‹è½½");return}try{await ue.confirm(`ç¡®å®šè¦æ‰¹é‡ç›´æ¥ä¸‹è½½ ${e.length} ä¸ªåª’ä½“é¡¹å—ï¼Ÿ

ï¼ˆå·²è·³è¿‡ ${l.length-e.length} ä¸ªå·²ä¸‹è½½é¡¹ï¼‰

ä¸‹è½½ä»»åŠ¡å°†åœ¨åç«¯æ‰§è¡Œï¼Œå¯åœ¨"ä»»åŠ¡ç®¡ç†"é¡µé¢æŸ¥çœ‹è¿›åº¦ã€‚`,"æ‰¹é‡ç›´æ¥ä¸‹è½½ç¡®è®¤",{confirmButtonText:"å¼€å§‹ä¸‹è½½",cancelButtonText:"å–æ¶ˆ",type:"warning"})}catch{return}Ze.value=!0;try{const i=e.map(n=>n.id),r=await Nl(i);if(r.data&&r.data.status==="started"){const n=r.data.taskId;ue.alert(`æ‰¹é‡ä¸‹è½½ä»»åŠ¡å·²åˆ›å»ºï¼ˆä»»åŠ¡ID: ${n}ï¼‰ï¼Œå…± ${i.length} ä¸ªåª’ä½“é¡¹ã€‚

è¯·å‰å¾€"ä»»åŠ¡ç®¡ç†"é¡µé¢æŸ¥çœ‹å®æ—¶ä¸‹è½½è¿›åº¦ã€‚`,"ä¸‹è½½ä»»åŠ¡å·²å¯åŠ¨",{confirmButtonText:"çŸ¥é“äº†",type:"success"})}else p.error("å¯åŠ¨æ‰¹é‡ä¸‹è½½å¤±è´¥")}catch(i){console.error("æ‰¹é‡ä¸‹è½½å¤±è´¥:",i),p.error("æ‰¹é‡ä¸‹è½½å¤±è´¥: "+(i.message||"æœªçŸ¥é”™è¯¯"))}finally{Ze.value=!1}},il=async l=>{var n,d;const e=l.url||l.link||l.share_url;if(!e){p.error("è¯¥èµ„æºæ²¡æœ‰æœ‰æ•ˆçš„åˆ†äº«é“¾æ¥");return}const i=e.includes("alipan.com")||e.includes("aliyundrive.com"),r=e.includes("cloud.189.cn");if(!i&&!r){p.warning("è¯¥é“¾æ¥ä¸æ˜¯é˜¿é‡Œäº‘ç›˜æˆ–å¤©ç¿¼äº‘ç›˜åˆ†äº«é“¾æ¥ï¼Œæ— æ³•è½¬å­˜");return}r&&p.info("æ£€æµ‹åˆ°å¤©ç¿¼äº‘ç›˜é“¾æ¥ï¼Œå°†å°è¯•è½¬å­˜"),fe.value=l,we.value=!0;try{await ue.confirm(`ç¡®å®šè¦è½¬å­˜è¿™ä¸ªèµ„æºå—ï¼Ÿ

æ ‡é¢˜: ${l.title}
å¤§å°: ${l.size||"æœªçŸ¥"}
æ¥æº: ${l.channelName}
é“¾æ¥: ${e}`,"ç¡®è®¤è½¬å­˜",{confirmButtonText:"ç¡®å®šè½¬å­˜",cancelButtonText:"å–æ¶ˆ",type:"warning"});const m=ot(fe.value.cloudType);if(!m){p.error(`æœªæ‰¾åˆ° cloudType="${fe.value.cloudType}" çš„äº‘ç›˜é…ç½®ï¼Œè¯·åœ¨æ™ºèƒ½æœç´¢é…ç½®ä¸­æ·»åŠ `);return}if(!m.parentId){p.warning(`äº‘ç›˜é…ç½®"${m.name}"æœªè®¾ç½®ç›®å½•IDï¼Œè¯·åœ¨æ™ºèƒ½æœç´¢é…ç½®ä¸­å®Œå–„`);return}console.log("ä½¿ç”¨äº‘ç›˜é…ç½®:",m);const v=await it(e,m.parentId,m.cloudType);if(console.log("è½¬å­˜ç»“æœ:",v),v.success||v.code===0||v.status==="success")p.success("è½¬å­˜æˆåŠŸï¼èµ„æºå·²ä¿å­˜åˆ°é˜¿é‡Œäº‘ç›˜"),ve.value=!1;else{const x=v.message||v.msg||v.error||"è½¬å­˜å¤±è´¥";p.error("è½¬å­˜å¤±è´¥: "+x)}}catch(m){if(m!=="cancel"){console.error("è½¬å­˜å¤±è´¥:",m);const v=((d=(n=m.response)==null?void 0:n.data)==null?void 0:d.message)||m.message||"æœªçŸ¥é”™è¯¯";p.error("è½¬å­˜å¤±è´¥: "+v)}}finally{we.value=!1}},ul=l=>JSON.stringify(l,null,2);return kl(async()=>{Et(),await ut(),await Be(),await Ke(),await We(),await He()}),(l,e)=>{var _t,bt,kt;const i=I("CircleCheck"),r=I("el-icon"),n=I("el-tag"),d=I("Connection"),m=I("el-button"),v=I("Refresh"),x=I("Delete"),C=I("el-card"),y=I("el-text"),S=I("el-descriptions-item"),w=I("el-link"),D=I("el-descriptions"),z=I("el-alert"),_=I("el-empty"),c=I("el-table-column"),V=I("Film"),K=I("Monitor"),Y=I("Headset"),N=I("Folder"),U=I("FolderOpened"),H=I("View"),O=I("el-table"),pe=I("el-col"),W=I("el-row"),Ie=I("Search"),De=I("el-input"),ae=I("el-option"),le=I("el-select"),h=I("Download"),M=I("Loading"),R=I("VideoPlay"),L=I("Close"),se=I("Document"),J=I("el-rate"),$e=I("el-tooltip"),cl=I("el-pagination"),Je=I("el-dialog"),gt=I("el-divider"),yt=I("el-form-item"),vt=I("el-checkbox"),dl=I("el-form"),fl=I("CircleClose"),pl=I("QuestionFilled"),ht=I("el-progress"),ml=I("el-image"),gl=I("Star"),yl=I("el-timeline-item"),vl=I("el-timeline"),Ae=wl("loading");return o(),b("div",jl,[a(C,{class:"header-card"},{default:t(()=>[k("div",Ol,[k("div",Kl,[e[13]||(e[13]=k("h2",null,"Emby åª’ä½“åº“ç®¡ç†",-1)),G.value?(o(),f(n,{key:0,type:"success",size:"large"},{default:t(()=>[a(r,null,{default:t(()=>[a(i)]),_:1}),e[12]||(e[12]=u(" å·²è¿æ¥ ",-1))]),_:1})):A("",!0)]),k("div",Wl,[a(m,{type:"primary",onClick:Bt,loading:te.value},{default:t(()=>[a(r,null,{default:t(()=>[a(d)]),_:1}),e[14]||(e[14]=u(" æµ‹è¯•è¿æ¥ ",-1))]),_:1},8,["loading"]),a(m,{type:"success",onClick:ct,loading:ce.value},{default:t(()=>[a(r,null,{default:t(()=>[a(v)]),_:1}),e[15]||(e[15]=u(" åŒæ­¥æ‰€æœ‰æ•°æ® ",-1))]),_:1},8,["loading"]),a(m,{type:"warning",onClick:Wt,loading:ge.value},{default:t(()=>[a(r,null,{default:t(()=>[a(x)]),_:1}),e[16]||(e[16]=u(" æ¸…ç©ºç¼“å­˜ ",-1))]),_:1},8,["loading"])])])]),_:1}),G.value?(o(),f(C,{key:0,class:"info-card"},{header:t(()=>[k("div",Hl,[e[17]||(e[17]=k("span",null,"æœåŠ¡å™¨ä¿¡æ¯",-1)),a(n,{type:"info"},{default:t(()=>[u(g(G.value.version),1)]),_:1})])]),default:t(()=>[a(D,{column:3,border:""},{default:t(()=>[a(S,{label:"æœåŠ¡å™¨åç§°"},{default:t(()=>[a(y,{tag:"b"},{default:t(()=>[u(g(G.value.serverName),1)]),_:1})]),_:1}),a(S,{label:"ç‰ˆæœ¬"},{default:t(()=>[u(g(G.value.version),1)]),_:1}),a(S,{label:"æ“ä½œç³»ç»Ÿ"},{default:t(()=>[u(g(G.value.operatingSystem),1)]),_:1}),a(S,{label:"æœ¬åœ°åœ°å€"},{default:t(()=>[a(w,{href:`http://${G.value.localAddress}`,target:"_blank",type:"primary"},{default:t(()=>[u(g(G.value.localAddress),1)]),_:1},8,["href"])]),_:1}),a(S,{label:"å¤–ç½‘åœ°å€"},{default:t(()=>[G.value.wanAddress?(o(),f(w,{key:0,href:`http://${G.value.wanAddress}`,target:"_blank",type:"primary"},{default:t(()=>[u(g(G.value.wanAddress),1)]),_:1},8,["href"])):(o(),b("span",Gl,"-"))]),_:1}),a(S,{label:"æœåŠ¡å™¨ID"},{default:t(()=>[a(y,{type:"info",size:"small"},{default:t(()=>[u(g(G.value.id),1)]),_:1})]),_:1})]),_:1})]),_:1})):A("",!0),!G.value&&!te.value?(o(),f(z,{key:1,title:"è¯·å…ˆé…ç½® Emby æœåŠ¡å™¨",type:"warning",closable:!1,"show-icon":"",class:"config-alert"},{default:t(()=>[...e[18]||(e[18]=[k("div",null,[k("p",null,[u("è¯·åœ¨åç«¯é…ç½®æ–‡ä»¶ "),k("code",null,"application.yml"),u(" ä¸­é…ç½® Emby æœåŠ¡å™¨ä¿¡æ¯ï¼š")]),k("pre",{class:"config-example"},`app:
  emby:
    server-url: http://your-emby-server:8096
    api-key: your-api-key-here
    enabled: true`),k("p",null,'é…ç½®å®Œæˆåï¼Œç‚¹å‡»"æµ‹è¯•è¿æ¥"æŒ‰é’®éªŒè¯é…ç½®ã€‚')],-1)])]),_:1})):A("",!0),G.value&&!Ce.value&&!ce.value?(o(),f(z,{key:2,title:"âš ï¸ é¦–æ¬¡ä½¿ç”¨éœ€è¦åŒæ­¥æ•°æ®",type:"error",closable:!1,"show-icon":"",class:"sync-alert"},{default:t(()=>[k("div",null,[e[20]||(e[20]=k("p",null,[k("strong",null,'æ•°æ®åº“ä¸­æš‚æ— æ•°æ®ï¼Œè¯·å…ˆç‚¹å‡»"åŒæ­¥æ‰€æœ‰æ•°æ®"æŒ‰é’®ï¼')],-1)),e[21]||(e[21]=k("p",null,"åŒæ­¥è¿‡ç¨‹ä¼šä» Emby æœåŠ¡å™¨è·å–æ‰€æœ‰åª’ä½“åº“ã€åª’ä½“é¡¹ã€ç±»å‹ã€æ ‡ç­¾ã€å·¥ä½œå®¤ç­‰æ•°æ®å¹¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚",-1)),e[22]||(e[22]=k("p",null,"æ ¹æ®åª’ä½“åº“å¤§å°ï¼ŒåŒæ­¥å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ ååˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚",-1)),a(m,{type:"danger",size:"large",onClick:ct,loading:ce.value,style:{"margin-top":"10px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(v)]),_:1}),e[19]||(e[19]=u(" ç«‹å³åŒæ­¥æ‰€æœ‰æ•°æ® ",-1))]),_:1},8,["loading"])])]),_:1})):A("",!0),a(C,{class:"library-card"},{header:t(()=>[k("div",Ql,[k("span",null,"åª’ä½“åº“åˆ—è¡¨ ("+g(ke.value.length)+")",1),a(m,{type:"primary",size:"small",onClick:Be},{default:t(()=>[a(r,null,{default:t(()=>[a(v)]),_:1}),e[23]||(e[23]=u(" åˆ·æ–° ",-1))]),_:1})])]),default:t(()=>[!be.value&&ke.value.length===0?(o(),f(_,{key:0,description:"æš‚æ— åª’ä½“åº“æ•°æ®"},{default:t(()=>[a(m,{type:"primary",onClick:Be},{default:t(()=>[...e[24]||(e[24]=[u("åˆ·æ–°æ•°æ®",-1)])]),_:1})]),_:1})):Le((o(),f(O,{key:1,data:ke.value,border:"",stripe:""},{default:t(()=>[a(c,{type:"index",label:"#",width:"60",align:"center"}),a(c,{prop:"name",label:"åç§°","min-width":"150"},{default:t(({row:s})=>[k("div",Jl,[s.collectionType==="movies"?(o(),f(r,{key:0,color:"#34c759"},{default:t(()=>[a(V)]),_:1})):s.collectionType==="tvshows"?(o(),f(r,{key:1,color:"#007aff"},{default:t(()=>[a(K)]),_:1})):s.collectionType==="music"?(o(),f(r,{key:2,color:"#ff9500"},{default:t(()=>[a(Y)]),_:1})):(o(),f(r,{key:3,color:"#86868b"},{default:t(()=>[a(N)]),_:1})),k("span",null,g(s.name),1)])]),_:1}),a(c,{prop:"collectionType",label:"ç±»å‹",width:"120"},{default:t(({row:s})=>[s.collectionType==="movies"?(o(),f(n,{key:0,type:"success"},{default:t(()=>[...e[25]||(e[25]=[u("ç”µå½±",-1)])]),_:1})):s.collectionType==="tvshows"?(o(),f(n,{key:1,type:"primary"},{default:t(()=>[...e[26]||(e[26]=[u("ç”µè§†å‰§",-1)])]),_:1})):s.collectionType==="music"?(o(),f(n,{key:2,type:"warning"},{default:t(()=>[...e[27]||(e[27]=[u("éŸ³ä¹",-1)])]),_:1})):(o(),f(n,{key:3},{default:t(()=>[u(g(s.collectionType||"å…¶ä»–"),1)]),_:2},1024))]),_:1}),a(c,{prop:"itemCount",label:"åª’ä½“é¡¹æ•°é‡",width:"120",align:"center"},{default:t(({row:s})=>[s.itemCount!==void 0&&s.itemCount!==null?(o(),f(y,{key:0,type:"primary",tag:"b"},{default:t(()=>[u(g(s.itemCount),1)]),_:2},1024)):(o(),f(y,{key:1,type:"info",size:"small"},{default:t(()=>[...e[28]||(e[28]=[u("ç‚¹å‡»æŸ¥çœ‹",-1)])]),_:1}))]),_:1}),a(c,{prop:"locations",label:"è·¯å¾„","min-width":"300"},{default:t(({row:s})=>[s.locations&&s.locations.length>0?(o(),b("div",ql,[(o(!0),b(Z,null,ee(s.locations,($,X)=>(o(),b("div",{key:X,class:"path-item"},[a(r,null,{default:t(()=>[a(U)]),_:1}),u(" "+g($),1)]))),128))])):(o(),b("span",Xl,"-"))]),_:1}),a(c,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:t(({row:s})=>[a(m,{type:"primary",size:"small",onClick:$=>Dt(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(H)]),_:1}),e[29]||(e[29]=u(" æŸ¥çœ‹åª’ä½“é¡¹ ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ae,be.value]])]),_:1}),a(W,{gutter:20,class:"category-row"},{default:t(()=>[a(pe,{span:8},{default:t(()=>[a(C,null,{header:t(()=>[k("div",Zl,[k("span",null,"ç±»å‹ ("+g(Se.value.length)+")",1),a(m,{type:"text",size:"small",onClick:Ke},{default:t(()=>[...e[30]||(e[30]=[u("åˆ·æ–°",-1)])]),_:1})])]),default:t(()=>[Le((o(),b("div",ea,[!Fe.value&&Se.value.length===0?(o(),f(_,{key:0,description:"æš‚æ— æ•°æ®","image-size":60})):(o(!0),b(Z,{key:1},ee(Se.value,s=>(o(),f(n,{key:s.id,class:"category-tag"},{default:t(()=>[u(g(s.name)+" ",1),s.itemCount?(o(),b("span",ta,"("+g(s.itemCount)+")",1)):A("",!0)]),_:2},1024))),128))])),[[Ae,Fe.value]])]),_:1})]),_:1}),a(pe,{span:8},{default:t(()=>[a(C,null,{header:t(()=>[k("div",la,[k("span",null,"æ ‡ç­¾ ("+g(xe.value.length)+")",1),a(m,{type:"text",size:"small",onClick:We},{default:t(()=>[...e[31]||(e[31]=[u("åˆ·æ–°",-1)])]),_:1})])]),default:t(()=>[Le((o(),b("div",aa,[!Ve.value&&xe.value.length===0?(o(),f(_,{key:0,description:"æš‚æ— æ•°æ®","image-size":60})):(o(!0),b(Z,{key:1},ee(xe.value,s=>(o(),f(n,{key:s.id,type:"success",class:"category-tag"},{default:t(()=>[u(g(s.name)+" ",1),s.itemCount?(o(),b("span",sa,"("+g(s.itemCount)+")",1)):A("",!0)]),_:2},1024))),128))])),[[Ae,Ve.value]])]),_:1})]),_:1}),a(pe,{span:8},{default:t(()=>[a(C,null,{header:t(()=>[k("div",na,[k("span",null,"å·¥ä½œå®¤ ("+g(ze.value.length)+")",1),a(m,{type:"text",size:"small",onClick:He},{default:t(()=>[...e[32]||(e[32]=[u("åˆ·æ–°",-1)])]),_:1})])]),default:t(()=>[Le((o(),b("div",oa,[!Ne.value&&ze.value.length===0?(o(),f(_,{key:0,description:"æš‚æ— æ•°æ®","image-size":60})):(o(!0),b(Z,{key:1},ee(ze.value,s=>(o(),f(n,{key:s.id,type:"warning",class:"category-tag"},{default:t(()=>[u(g(s.name)+" ",1),s.itemCount?(o(),b("span",ra,"("+g(s.itemCount)+")",1)):A("",!0)]),_:2},1024))),128))])),[[Ae,Ne.value]])]),_:1})]),_:1})]),_:1}),a(Je,{modelValue:lt.value,"onUpdate:modelValue":e[5]||(e[5]=s=>lt.value=s),title:`${(_t=oe.value)==null?void 0:_t.name} - åª’ä½“é¡¹åˆ—è¡¨`,width:"90%",top:"5vh"},{default:t(()=>[k("div",ia,[k("div",ua,[k("div",ca,[a(De,{modelValue:Ye.value,"onUpdate:modelValue":e[0]||(e[0]=s=>Ye.value=s),placeholder:"æœç´¢åª’ä½“é¡¹...",style:{width:"300px"},clearable:"",onClear:_e},{append:t(()=>[a(m,{onClick:jt},{default:t(()=>[a(r,null,{default:t(()=>[a(Ie)]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(le,{modelValue:Me.value,"onUpdate:modelValue":e[1]||(e[1]=s=>Me.value=s),placeholder:"è½¬å­˜çŠ¶æ€",style:{width:"140px"},clearable:"",onChange:Yt},{default:t(()=>[a(ae,{label:"å…¨éƒ¨",value:""}),a(ae,{label:"è½¬å­˜æˆåŠŸ",value:"success"}),a(ae,{label:"è½¬å­˜å¤±è´¥",value:"failed"}),a(ae,{label:"æœªè½¬å­˜",value:"none"})]),_:1},8,["modelValue"]),a(le,{modelValue:Ue.value,"onUpdate:modelValue":e[2]||(e[2]=s=>Ue.value=s),placeholder:"ä¸‹è½½çŠ¶æ€",style:{width:"140px"},clearable:"",onChange:Ut},{default:t(()=>[a(ae,{label:"å…¨éƒ¨",value:""}),a(ae,{label:"ä¸‹è½½æˆåŠŸ",value:"success"}),a(ae,{label:"ä¸‹è½½å¤±è´¥",value:"failed"}),a(ae,{label:"æœªä¸‹è½½",value:"none"})]),_:1},8,["modelValue"])]),k("div",da,[a(m,{type:"primary",onClick:ol,loading:Xe.value,disabled:j.value.length===0||Me.value==="success"},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[33]||(e[33]=u(" æ‰¹é‡æœç´¢ä¸‹è½½ ",-1))]),_:1},8,["loading","disabled"]),a(m,{type:"warning",onClick:rl,loading:Ze.value,disabled:j.value.length===0},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[34]||(e[34]=u(" æ‰¹é‡ç›´æ¥ä¸‹è½½ ",-1))]),_:1},8,["loading","disabled"]),k("span",fa,"å…± "+g(tt.value)+" é¡¹ (å½“å‰é¡µ "+g(j.value.length)+" é¡¹)",1)])]),!ne.value&&j.value.length===0?(o(),f(_,{key:0,description:"æš‚æ— åª’ä½“é¡¹æ•°æ®"},{default:t(()=>[a(m,{type:"primary",onClick:_e},{default:t(()=>[...e[35]||(e[35]=[u("åˆ·æ–°æ•°æ®",-1)])]),_:1})]),_:1})):Le((o(),f(O,{key:1,data:j.value,border:"",stripe:"","max-height":"600","expand-row-keys":St.value,"row-key":"id",onExpandChange:At},{default:t(()=>[a(c,{type:"expand",width:"50"},{default:t(({row:s})=>[s.type==="Series"?(o(),b("div",pa,[et.value[s.id]?(o(),b("div",ma,[a(r,{class:"is-loading"},{default:t(()=>[a(M)]),_:1}),e[36]||(e[36]=k("span",null,"åŠ è½½å‰§é›†ä¸­...",-1))])):ye.value[s.id]&&ye.value[s.id].length>0?(o(),b("div",ga,[k("div",ya,[k("span",va,"å‰§é›†åˆ—è¡¨ (å…± "+g(ye.value[s.id].length)+" é›†)",1)]),a(O,{data:ye.value[s.id],border:"",size:"small"},{default:t(()=>[a(c,{type:"index",label:"#",width:"50",align:"center"}),a(c,{prop:"name",label:"é›†æ•°","min-width":"200"},{default:t(({row:$})=>[k("div",ha,[a(r,{color:"#007aff"},{default:t(()=>[a(R)]),_:1}),k("span",null,g($.name),1),Q.value[$.id]==="success"?(o(),f(n,{key:0,type:"success",size:"small",effect:"plain",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[37]||(e[37]=u(" å·²ä¸‹è½½ ",-1))]),_:1})):Q.value[$.id]==="failed"?(o(),f(n,{key:1,type:"danger",size:"small",effect:"plain",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(L)]),_:1}),e[38]||(e[38]=u(" ä¸‹è½½å¤±è´¥ ",-1))]),_:1})):A("",!0)])]),_:1}),a(c,{prop:"indexNumber",label:"ç¬¬å‡ é›†",width:"80",align:"center"},{default:t(({row:$})=>[a(n,{size:"small",type:"info"},{default:t(()=>[u("E"+g($.indexNumber),1)]),_:2},1024)]),_:1}),a(c,{prop:"parentIndexNumber",label:"ç¬¬å‡ å­£",width:"80",align:"center"},{default:t(({row:$})=>[a(n,{size:"small",type:"primary"},{default:t(()=>[u("S"+g($.parentIndexNumber),1)]),_:2},1024)]),_:1}),a(c,{prop:"runTimeTicks",label:"æ—¶é•¿",width:"100",align:"center"},{default:t(({row:$})=>[$.runTimeTicks?(o(),b("span",_a,g(Lt($.runTimeTicks)),1)):(o(),b("span",ba,"-"))]),_:1}),a(c,{prop:"overview",label:"ç®€ä»‹","min-width":"300","show-overflow-tooltip":""},{default:t(({row:$})=>[$.overview?(o(),b("span",ka,g($.overview),1)):(o(),b("span",wa,"æš‚æ— ç®€ä»‹"))]),_:1}),a(c,{label:"æ“ä½œ",width:"120",align:"center"},{default:t(({row:$})=>[a(m,{type:"warning",link:"",size:"small",onClick:X=>dt($)},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[39]||(e[39]=u(" ä¸‹è½½ ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(o(),f(_,{key:2,description:"æš‚æ— å‰§é›†æ•°æ®","image-size":60}))])):A("",!0)]),_:1}),a(c,{type:"index",label:"#",width:"60",align:"center",index:s=>(de.value-1)*Te.value+s+1},null,8,["index"]),a(c,{prop:"name",label:"åç§°","min-width":"200","show-overflow-tooltip":""},{default:t(({row:s})=>[k("div",$a,[s.type==="Movie"?(o(),f(r,{key:0,color:"#34c759"},{default:t(()=>[a(V)]),_:1})):s.type==="Series"?(o(),f(r,{key:1,color:"#007aff"},{default:t(()=>[a(K)]),_:1})):s.type==="Episode"?(o(),f(r,{key:2,color:"#007aff"},{default:t(()=>[a(R)]),_:1})):s.type==="Audio"?(o(),f(r,{key:3,color:"#ff9500"},{default:t(()=>[a(Y)]),_:1})):(o(),f(r,{key:4,color:"#86868b"},{default:t(()=>[a(se)]),_:1})),k("span",null,g(s.name),1),q.value[s.id]==="success"?(o(),f(n,{key:5,type:"success",size:"small",effect:"dark",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(wt($t))]),_:1}),e[40]||(e[40]=u(" å·²è½¬å­˜ ",-1))]),_:1})):q.value[s.id]==="failed"?(o(),f(n,{key:6,type:"danger",size:"small",effect:"dark",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(L)]),_:1}),e[41]||(e[41]=u(" å¤±è´¥ ",-1))]),_:1})):A("",!0),Q.value[s.id]==="success"?(o(),f(n,{key:7,type:"success",size:"small",effect:"plain",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[42]||(e[42]=u(" å·²ä¸‹è½½ ",-1))]),_:1})):Q.value[s.id]==="failed"?(o(),f(n,{key:8,type:"danger",size:"small",effect:"plain",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(L)]),_:1}),e[43]||(e[43]=u(" ä¸‹è½½å¤±è´¥ ",-1))]),_:1})):A("",!0)])]),_:1}),a(c,{prop:"type",label:"ç±»å‹",width:"100"},{default:t(({row:s})=>[a(n,{size:"small"},{default:t(()=>[u(g(s.type),1)]),_:2},1024)]),_:1}),a(c,{prop:"productionYear",label:"å¹´ä»½",width:"80",align:"center"},{default:t(({row:s})=>[u(g(s.productionYear||"-"),1)]),_:1}),a(c,{prop:"communityRating",label:"è¯„åˆ†",width:"100",align:"center"},{default:t(({row:s})=>[s.communityRating?(o(),f(J,{key:0,"model-value":s.communityRating/2,disabled:"","show-score":"","score-template":s.communityRating.toFixed(1),size:"small"},null,8,["model-value","score-template"])):(o(),b("span",Ta,"-"))]),_:1}),a(c,{prop:"genres",label:"ç±»å‹",width:"180"},{default:t(({row:s})=>{var $,X;return[(o(!0),b(Z,null,ee(($=s.genres)==null?void 0:$.slice(0,2),(hl,_l)=>(o(),f(n,{key:_l,size:"small",class:"genre-tag"},{default:t(()=>[u(g(hl),1)]),_:2},1024))),128)),((X=s.genres)==null?void 0:X.length)>2?(o(),f(n,{key:0,size:"small",type:"info"},{default:t(()=>[u(" +"+g(s.genres.length-2),1)]),_:2},1024)):A("",!0)]}),_:1}),a(c,{prop:"size",label:"å¤§å°",width:"120",align:"right"},{default:t(({row:s})=>[s.size?(o(),f(y,{key:0,type:"primary"},{default:t(()=>[u(g(rt(s.size)),1)]),_:2},1024)):(o(),b("span",Ia,"-"))]),_:1}),a(c,{prop:"path",label:"è·¯å¾„","min-width":"300","show-overflow-tooltip":""},{default:t(({row:s})=>[s.path?(o(),f($e,{key:0,content:s.path,placement:"top"},{default:t(()=>[a(y,{type:"info",size:"small"},{default:t(()=>[u(g(s.path),1)]),_:2},1024)]),_:2},1032,["content"])):(o(),b("span",Ca,"-"))]),_:1}),a(c,{label:"è½¬å­˜çŠ¶æ€",width:"100",align:"center"},{default:t(({row:s})=>[q.value[s.id]==="success"?(o(),f(n,{key:0,type:"success",size:"small"},{default:t(()=>[...e[44]||(e[44]=[u(" å·²è½¬å­˜ ",-1)])]),_:1})):q.value[s.id]==="failed"?(o(),f(n,{key:1,type:"danger",size:"small"},{default:t(()=>[...e[45]||(e[45]=[u(" è½¬å­˜å¤±è´¥ ",-1)])]),_:1})):(o(),f(n,{key:2,type:"info",size:"small"},{default:t(()=>[...e[46]||(e[46]=[u(" æœªè½¬å­˜ ",-1)])]),_:1}))]),_:1}),a(c,{label:"ä¸‹è½½çŠ¶æ€",width:"100",align:"center"},{default:t(({row:s})=>[Q.value[s.id]==="success"?(o(),f(n,{key:0,type:"success",size:"small"},{default:t(()=>[...e[47]||(e[47]=[u(" å·²ä¸‹è½½ ",-1)])]),_:1})):Q.value[s.id]==="failed"?(o(),f(n,{key:1,type:"danger",size:"small"},{default:t(()=>[...e[48]||(e[48]=[u(" ä¸‹è½½å¤±è´¥ ",-1)])]),_:1})):(o(),f(n,{key:2,type:"info",size:"small"},{default:t(()=>[...e[49]||(e[49]=[u(" æœªä¸‹è½½ ",-1)])]),_:1}))]),_:1}),a(c,{label:"æ“ä½œ",width:"350",fixed:"right"},{default:t(({row:s})=>[a(m,{type:"primary",link:"",size:"small",onClick:$=>Ot(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(H)]),_:1}),e[50]||(e[50]=u(" è¯¦æƒ… ",-1))]),_:1},8,["onClick"]),s.type==="Movie"||s.type==="Series"?(o(),f(m,{key:0,type:"success",link:"",size:"small",onClick:$=>Gt(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[51]||(e[51]=u(" æœç´¢ä¸‹è½½ ",-1))]),_:1},8,["onClick"])):A("",!0),s.type==="Movie"||s.type==="Series"?(o(),f(m,{key:1,type:"warning",link:"",size:"small",onClick:$=>dt(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[52]||(e[52]=u(" ç›´æ¥ä¸‹è½½ ",-1))]),_:1},8,["onClick"])):A("",!0),Q.value[s.id]!=="success"?(o(),f(m,{key:2,type:"success",link:"",size:"small",onClick:$=>Qt(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(wt($t))]),_:1}),e[53]||(e[53]=u(" æ ‡è®°å·²ä¸‹è½½ ",-1))]),_:1},8,["onClick"])):A("",!0),(s.type==="Movie"||s.type==="Series")&&q.value[s.id]&&q.value[s.id]!=="none"?(o(),f(m,{key:3,type:"info",link:"",size:"small",onClick:$=>Kt(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(se)]),_:1}),e[54]||(e[54]=u(" è½¬å­˜è®°å½• ",-1))]),_:1},8,["onClick"])):A("",!0)]),_:1})]),_:1},8,["data","expand-row-keys"])),[[Ae,ne.value]]),k("div",Sa,[a(cl,{"current-page":de.value,"onUpdate:currentPage":e[3]||(e[3]=s=>de.value=s),"page-size":Te.value,"onUpdate:pageSize":e[4]||(e[4]=s=>Te.value=s),"page-sizes":[20,50,100,200],total:tt.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Pt,onCurrentChange:Nt},null,8,["current-page","page-size","total"])])])]),_:1},8,["modelValue","title"]),a(Je,{modelValue:ve.value,"onUpdate:modelValue":e[9]||(e[9]=s=>ve.value=s),title:((bt=E.value)==null?void 0:bt.type)==="Series"?"æœç´¢å¹¶ä¸‹è½½ç”µè§†å‰§":"æœç´¢å¹¶ä¸‹è½½ç”µå½±",width:"800px","close-on-click-modal":!1},{default:t(()=>[E.value?(o(),b("div",xa,[a(D,{column:1,border:""},{default:t(()=>[a(S,{label:"ç”µå½±åç§°"},{default:t(()=>[a(y,{tag:"b"},{default:t(()=>[u(g(E.value.name),1)]),_:1})]),_:1}),E.value.originalTitle?(o(),f(S,{key:0,label:"åŸå§‹åç§°"},{default:t(()=>[u(g(E.value.originalTitle),1)]),_:1})):A("",!0),E.value.productionYear?(o(),f(S,{key:1,label:"å¹´ä»½"},{default:t(()=>[u(g(E.value.productionYear),1)]),_:1})):A("",!0),E.value.communityRating?(o(),f(S,{key:2,label:"è¯„åˆ†"},{default:t(()=>[a(J,{"model-value":E.value.communityRating/2,disabled:"","show-score":"","score-template":E.value.communityRating.toFixed(1),size:"small"},null,8,["model-value","score-template"])]),_:1})):A("",!0)]),_:1}),a(gt),a(dl,{"label-width":"100px"},{default:t(()=>[a(yt,{label:"æœç´¢å…³é”®è¯"},{default:t(()=>[a(De,{modelValue:he.value,"onUpdate:modelValue":e[6]||(e[6]=s=>he.value=s),placeholder:"è‡ªåŠ¨å¡«å……ç”µå½±åç§°ï¼Œå¯ä¿®æ”¹",clearable:"",onKeyup:$l(Re,["enter"])},{append:t(()=>[a(m,{onClick:Re,loading:je.value},{default:t(()=>[a(r,null,{default:t(()=>[a(Ie)]),_:1}),e[55]||(e[55]=u(" æœç´¢ ",-1))]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1}),a(yt,{label:"æ™ºèƒ½ç­›é€‰"},{default:t(()=>[a(vt,{modelValue:Oe.value,"onUpdate:modelValue":e[7]||(e[7]=s=>Oe.value=s),label:"éªŒè¯é“¾æ¥æœ‰æ•ˆæ€§"},null,8,["modelValue"]),a(vt,{modelValue:Ee.value,"onUpdate:modelValue":e[8]||(e[8]=s=>Ee.value=s),label:"ä½¿ç”¨AIæ™ºèƒ½æ¨è",style:{"margin-left":"16px"}},null,8,["modelValue"])]),_:1}),a(z,{title:"äº‘ç›˜é…ç½®è¯´æ˜",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[k("div",za,[e[58]||(e[58]=k("p",null,[u("ç³»ç»Ÿä¼šæ ¹æ®æœç´¢ç»“æœçš„ "),k("code",null,"cloudType"),u(" è‡ªåŠ¨åŒ¹é…å¯¹åº”çš„äº‘ç›˜é…ç½®ã€‚")],-1)),k("p",Ma,[e[56]||(e[56]=u(" å·²é…ç½® ",-1)),k("strong",null,g(ie.value.length),1),e[57]||(e[57]=u(" ä¸ªäº‘ç›˜ï¼š ",-1)),(o(!0),b(Z,null,ee(ie.value,(s,$)=>(o(),f(n,{key:$,size:"small",style:{"margin-left":"4px"}},{default:t(()=>[u(g(s.cloudType),1)]),_:2},1024))),128))]),e[59]||(e[59]=k("p",{style:{"margin-top":"4px",color:"#909399"}},' å¦‚éœ€æ·»åŠ æˆ–ä¿®æ”¹äº‘ç›˜é…ç½®ï¼Œè¯·å‰å¾€"æ™ºèƒ½æœç´¢é…ç½®"é¡µé¢ ',-1))])]),_:1})]),_:1}),re.value&&re.value.length>0?(o(),b("div",Ea,[a(z,{title:`æ‰¾åˆ° ${re.value.length} ä¸ªç»“æœ`,type:"success",closable:!1,"show-icon":"",style:{"margin-bottom":"16px"}},{default:t(()=>[Mt.value?(o(),b("div",Ba,[a(r,{class:"is-loading"},{default:t(()=>[a(M)]),_:1}),e[60]||(e[60]=u(" æ­£åœ¨éªŒè¯é“¾æ¥æœ‰æ•ˆæ€§... ",-1))])):nt.value?(o(),b("div",Ra,[a(r,{class:"is-loading"},{default:t(()=>[a(M)]),_:1}),e[61]||(e[61]=u(" AIæ­£åœ¨æ™ºèƒ½ç­›é€‰æœ€ä½³èµ„æº... ",-1))])):(o(),b("div",Da," å·²å®Œæˆæ™ºèƒ½ç­›é€‰å’Œæ’åº "))]),_:1},8,["title"]),a(O,{data:re.value,style:{width:"100%"},"max-height":"400","highlight-current-row":"",onCurrentChange:al},{default:t(()=>[a(c,{type:"index",label:"#",width:"50"}),a(c,{label:"çŠ¶æ€",width:"80"},{default:t(({row:s})=>[a($e,{content:s.validationMessage||"æœªéªŒè¯",placement:"top"},{default:t(()=>[k("div",null,[s.isValid===!0?(o(),f(r,{key:0,color:"#67c23a",size:20},{default:t(()=>[a(i)]),_:1})):s.isValid===!1?(o(),f(r,{key:1,color:"#f56c6c",size:20},{default:t(()=>[a(fl)]),_:1})):(o(),f(r,{key:2,color:"#909399",size:20},{default:t(()=>[a(pl)]),_:1}))])]),_:2},1032,["content"])]),_:1}),a(c,{label:"åŒ¹é…åº¦",width:"100",sortable:"","sort-method":(s,$)=>$.matchScore-s.matchScore},{default:t(({row:s})=>{var $;return[a(ht,{percentage:Math.min(Math.round(s.matchScore),100),color:s.matchScore>=80?"#67c23a":s.matchScore>=60?"#e6a23c":"#909399","stroke-width":8},null,8,["percentage","color"]),a($e,{content:($=s.matchReasons)==null?void 0:$.join(`
`),placement:"top"},{default:t(()=>[a(y,{size:"small",type:"info",style:{cursor:"help"}},{default:t(()=>[u(g(Math.round(s.matchScore))+"åˆ† ",1)]),_:2},1024)]),_:2},1032,["content"])]}),_:1},8,["sort-method"]),a(c,{prop:"title",label:"æ ‡é¢˜","min-width":"250","show-overflow-tooltip":""},{default:t(({row:s})=>[k("div",Aa,[s.image?(o(),f(ml,{key:0,src:s.image,style:{width:"40px",height:"40px","border-radius":"4px"},fit:"cover"},null,8,["src"])):A("",!0),k("div",null,[k("div",null,g(s.title),1),k("div",La,[s.aiRecommended?(o(),f(n,{key:0,size:"small",type:"danger",effect:"dark"},{default:t(()=>[a(r,null,{default:t(()=>[a(gl)]),_:1}),e[62]||(e[62]=u(" AIæ¨è ",-1))]),_:1})):s.matchScore>=80?(o(),f(n,{key:1,size:"small",type:"success",effect:"dark"},{default:t(()=>[...e[63]||(e[63]=[u(" æ¨è ",-1)])]),_:1})):A("",!0),s.hasFiles?(o(),f(n,{key:2,size:"small",type:"info",style:{"margin-left":"4px"}},{default:t(()=>[u(g(s.fileCount)+"ä¸ªæ–‡ä»¶ ",1)]),_:2},1024)):A("",!0)])])])]),_:1}),a(c,{prop:"size",label:"å¤§å°",width:"120"},{default:t(({row:s})=>[a(y,{type:"primary"},{default:t(()=>[u(g(s.size||"-"),1)]),_:2},1024)]),_:1}),a(c,{prop:"resolution",label:"åˆ†è¾¨ç‡",width:"100"},{default:t(({row:s})=>[s.resolution?(o(),f(n,{key:0,size:"small",type:"success"},{default:t(()=>[u(g(s.resolution),1)]),_:2},1024)):(o(),b("span",Fa,"-"))]),_:1}),a(c,{prop:"tags",label:"æ ‡ç­¾",width:"150"},{default:t(({row:s})=>[(o(!0),b(Z,null,ee(s.tags.slice(0,2),($,X)=>(o(),f(n,{key:X,size:"small",style:{"margin-right":"4px"}},{default:t(()=>[u(g($),1)]),_:2},1024))),128)),s.tags.length>2?(o(),f(n,{key:0,size:"small",type:"info"},{default:t(()=>[u(" +"+g(s.tags.length-2),1)]),_:2},1024)):A("",!0)]),_:1}),a(c,{prop:"channelName",label:"æ¥æº",width:"100"},{default:t(({row:s})=>[a(y,{size:"small",type:"info"},{default:t(()=>[u(g(s.channelName||"-"),1)]),_:2},1024)]),_:1}),a(c,{label:"æ“ä½œ",width:"120",fixed:"right"},{default:t(({row:s})=>{var $;return[a(m,{type:"primary",size:"small",onClick:X=>il(s),loading:we.value&&(($=fe.value)==null?void 0:$.id)===s.id},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[64]||(e[64]=u(" è½¬å­˜ ",-1))]),_:1},8,["onClick","loading"])]}),_:1})]),_:1},8,["data"])])):A("",!0),re.value&&re.value.length===0&&!je.value?(o(),f(_,{key:1,description:"æœªæ‰¾åˆ°æœç´¢ç»“æœ","image-size":100})):A("",!0),fe.value?(o(),b("div",Va,[a(gt,{"content-position":"left"},{default:t(()=>[...e[65]||(e[65]=[u("é€‰ä¸­çš„èµ„æº",-1)])]),_:1}),a(C,{class:"result-preview",shadow:"never"},{default:t(()=>[k("pre",Na,g(ul(fe.value)),1)]),_:1})])):A("",!0)])):A("",!0)]),_:1},8,["modelValue","title"]),a(Je,{modelValue:at.value,"onUpdate:modelValue":e[10]||(e[10]=s=>at.value=s),title:(kt=B.value)==null?void 0:kt.name,width:"70%"},{default:t(()=>[B.value?(o(),f(D,{key:0,column:2,border:""},{default:t(()=>[a(S,{label:"ID"},{default:t(()=>[a(y,{type:"info",size:"small"},{default:t(()=>[u(g(B.value.id),1)]),_:1})]),_:1}),a(S,{label:"ç±»å‹"},{default:t(()=>[a(n,null,{default:t(()=>[u(g(B.value.type),1)]),_:1})]),_:1}),a(S,{label:"åŸå§‹åç§°"},{default:t(()=>[u(g(B.value.originalTitle||"-"),1)]),_:1}),a(S,{label:"å¹´ä»½"},{default:t(()=>[B.value.productionYear?(o(),f(n,{key:0,type:"info"},{default:t(()=>[u(g(B.value.productionYear),1)]),_:1})):(o(),b("span",Ya,"-"))]),_:1}),a(S,{label:"è¯„åˆ†"},{default:t(()=>[B.value.communityRating?(o(),f(J,{key:0,"model-value":B.value.communityRating/2,disabled:"","show-score":"","score-template":B.value.communityRating.toFixed(1)},null,8,["model-value","score-template"])):(o(),b("span",Ua,"-"))]),_:1}),a(S,{label:"åˆ†çº§"},{default:t(()=>[B.value.officialRating?(o(),f(n,{key:0,type:"warning"},{default:t(()=>[u(g(B.value.officialRating),1)]),_:1})):(o(),b("span",Pa,"-"))]),_:1}),a(S,{label:"æ–‡ä»¶å¤§å°"},{default:t(()=>[B.value.size?(o(),f(y,{key:0,type:"primary",tag:"b"},{default:t(()=>[u(g(rt(B.value.size)),1)]),_:1})):(o(),b("span",ja,"-"))]),_:1}),a(S,{label:"æ’­æ”¾æ¬¡æ•°"},{default:t(()=>[a(n,{type:"success"},{default:t(()=>[u(g(B.value.playCount||0)+" æ¬¡",1)]),_:1})]),_:1}),a(S,{label:"ç±»å‹",span:2},{default:t(()=>[B.value.genres&&B.value.genres.length>0?(o(),b("div",Oa,[(o(!0),b(Z,null,ee(B.value.genres,(s,$)=>(o(),f(n,{key:$,class:"detail-tag"},{default:t(()=>[u(g(s),1)]),_:2},1024))),128))])):(o(),b("span",Ka,"-"))]),_:1}),a(S,{label:"æ ‡ç­¾",span:2},{default:t(()=>[B.value.tags&&B.value.tags.length>0?(o(),b("div",Wa,[(o(!0),b(Z,null,ee(B.value.tags,(s,$)=>(o(),f(n,{key:$,type:"success",class:"detail-tag"},{default:t(()=>[u(g(s),1)]),_:2},1024))),128))])):(o(),b("span",Ha,"-"))]),_:1}),a(S,{label:"å·¥ä½œå®¤",span:2},{default:t(()=>[B.value.studios&&B.value.studios.length>0?(o(),b("div",Ga,[(o(!0),b(Z,null,ee(B.value.studios,(s,$)=>(o(),f(n,{key:$,type:"warning",class:"detail-tag"},{default:t(()=>[u(g(s),1)]),_:2},1024))),128))])):(o(),b("span",Qa,"-"))]),_:1}),a(S,{label:"æ¼”å‘˜",span:2},{default:t(()=>{var s;return[B.value.people&&B.value.people.length>0?(o(),b("div",Ja,[(o(!0),b(Z,null,ee((s=B.value.people)==null?void 0:s.slice(0,10),($,X)=>(o(),f(n,{key:X,type:"info",class:"detail-tag"},{default:t(()=>[u(g($),1)]),_:2},1024))),128)),B.value.people.length>10?(o(),f(n,{key:0,type:"info"},{default:t(()=>[u(" +"+g(B.value.people.length-10),1)]),_:1})):A("",!0)])):(o(),b("span",qa,"-"))]}),_:1}),a(S,{label:"ç®€ä»‹",span:2},{default:t(()=>[B.value.overview?(o(),f(y,{key:0,class:"overview-text"},{default:t(()=>[u(g(B.value.overview),1)]),_:1})):(o(),b("span",Xa,"-"))]),_:1}),a(S,{label:"æ–‡ä»¶è·¯å¾„",span:2},{default:t(()=>[B.value.path?(o(),f(y,{key:0,type:"info",size:"small"},{default:t(()=>[u(g(B.value.path),1)]),_:1})):(o(),b("span",Za,"-"))]),_:1}),B.value.mediaSources&&B.value.mediaSources.length>0?(o(),f(S,{key:0,label:"åª’ä½“æº",span:2},{default:t(()=>[(o(!0),b(Z,null,ee(B.value.mediaSources,(s,$)=>(o(),b("div",{key:$,class:"media-source"},[a(n,{type:"primary"},{default:t(()=>{var X;return[u(g((X=s.container)==null?void 0:X.toUpperCase()),1)]}),_:2},1024),a(y,{type:"info",size:"small"},{default:t(()=>[u(g(rt(s.size)),1)]),_:2},1024),a(y,{type:"info",size:"small"},{default:t(()=>[u(g(Ht(s.bitrate)),1)]),_:2},1024)]))),128))]),_:1})):A("",!0)]),_:1})):A("",!0)]),_:1},8,["modelValue","title"]),a(Je,{modelValue:st.value,"onUpdate:modelValue":e[11]||(e[11]=s=>st.value=s),title:"è½¬å­˜å†å²è®°å½•",width:"800px"},{default:t(()=>[!Pe.value||Pe.value.length===0?(o(),f(_,{key:0,description:"æš‚æ— è½¬å­˜è®°å½•"})):(o(),f(vl,{key:1},{default:t(()=>[(o(!0),b(Z,null,ee(Pe.value,(s,$)=>(o(),f(yl,{key:$,timestamp:s.createTime,placement:"top",type:s.transferStatus==="success"?"success":"danger",icon:s.transferStatus==="success"?"CircleCheck":"CircleClose"},{default:t(()=>[a(C,{shadow:"hover"},{header:t(()=>[k("div",es,[k("span",ts,g(s.resourceTitle),1),a(n,{type:s.transferStatus==="success"?"success":"danger",size:"small"},{default:t(()=>[u(g(s.transferStatus==="success"?"è½¬å­˜æˆåŠŸ":"è½¬å­˜å¤±è´¥"),1)]),_:2},1032,["type"])])]),default:t(()=>[a(D,{column:2,size:"small",border:""},{default:t(()=>[a(S,{label:"åŒ¹é…åˆ†æ•°"},{default:t(()=>[s.matchScore?(o(),f(ht,{key:0,percentage:Math.min(Math.round(s.matchScore),100),color:s.matchScore>=80?"#67c23a":s.matchScore>=60?"#e6a23c":"#909399","stroke-width":6,"show-text":!1,style:{width:"100px",display:"inline-block","margin-right":"8px"}},null,8,["percentage","color"])):A("",!0),k("span",null,g(s.matchScore?Math.round(s.matchScore)+"åˆ†":"-"),1)]),_:2},1024),a(S,{label:"äº‘ç›˜"},{default:t(()=>[u(g(s.cloudName||"-"),1)]),_:2},1024),a(S,{label:"äº‘ç›˜ç±»å‹"},{default:t(()=>[a(n,{size:"small"},{default:t(()=>[u(g(s.cloudType||"-"),1)]),_:2},1024)]),_:2},1024),a(S,{label:"è½¬å­˜æ—¶é—´"},{default:t(()=>[u(g(s.createTime),1)]),_:2},1024),a(S,{label:"ç»“æœæ¶ˆæ¯",span:2},{default:t(()=>[a(y,{type:s.transferStatus==="success"?"success":"danger"},{default:t(()=>[u(g(s.transferMessage||"-"),1)]),_:2},1032,["type"])]),_:2},1024),a(S,{label:"èµ„æºé“¾æ¥",span:2},{default:t(()=>[a(w,{href:s.resourceUrl,target:"_blank",type:"primary",underline:!1,style:{"font-size":"12px"}},{default:t(()=>[u(g(s.resourceUrl),1)]),_:2},1032,["href"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["timestamp","type","icon"]))),128))]),_:1}))]),_:1},8,["modelValue"])])}}},is=bl(ls,[["__scopeId","data-v-6e62ff5d"]]);export{is as default};
