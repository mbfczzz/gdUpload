import{g as pe,s as fe}from"./smartSearchConfig-BhYJOK52.js";import{_ as ve,a as x,l as ge,o as be,c,b as p,d as l,f as o,w as t,e as i,j as d,i as I,y as k,R as P,S as R,t as _,E as r}from"./index-Du7G4jX3.js";import"./request-jab3afSv.js";import"./index-B9ygI19o.js";const ye={class:"smart-search-config-container"},Ve={class:"header-content"},ce={class:"header-actions"},ke={class:"section-header"},Te={class:"section-header"},Ce={style:{display:"flex","justify-content":"space-between","align-items":"center"}},we={style:{"margin-left":"8px","font-weight":"600"}},Ae={class:"section-header"},Ie={class:"provider-option"},Me={class:"provider-option"},Ue={class:"provider-option"},xe={class:"form-tip"},Pe={key:0},_e={key:1},Se={class:"model-option"},De={class:"model-cost"},Be={class:"section-header"},he={class:"section-header"},Le={class:"section-header"},$e={class:"section-header"},Oe={style:{"margin-left":"10px",color:"#909399"}},Re={__name:"SmartSearchConfig",setup(ze){const z=x(null),L=x(null),D=x(!1),g=x({search:!1,ai:!1,tmdb:!1}),M={searchApiUrl:"http://104.251.122.51:8095/api/v1",searchAuthToken:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NzE3ODQxMTEsInVzZXJuYW1lIjoiYWRtaW4ifQ.9EPowlYRQCLx1p03TfbAQ9T8cxKUQdSrBVEQa67R1nI",searchTimeout:3e4,cloudConfigs:[{name:"阿里云盘",cloudType:"channel_alipan",parentId:"697f2333cd2704159fa446d8bc5077584838e3dc",remark:""}],aiEnabled:!1,aiProvider:"claude",apiKey:"",aiApiUrl:"http://localhost:11434",aiModel:"claude-3-5-sonnet-20241022",aiMaxTokens:1024,aiTemperature:.7,tmdbEnabled:!1,tmdbApiKey:"",tmdbApiUrl:"https://api.themoviedb.org/3",tmdbLanguage:"zh-CN",tmdbTimeout:1e4,tmdbAutoMatch:!0,validateLinks:!0,validationTimeout:1e4,maxValidationCount:20,cacheTime:300,maxResults:50,debugMode:!1,autoSelectBest:!0,weights:{titleMatch:40,resolution:20,fileSize:15,tagMatch:10,sourceCredibility:10,timeliness:5}},a=x({...M}),E=ge(()=>Object.values(a.value.weights).reduce((s,e)=>s+e,0)),$=()=>({claude:[{label:"Claude 3.5 Sonnet",value:"claude-3-5-sonnet-20241022",recommended:!0,cost:"$3/$15 per 1M tokens"},{label:"Claude 3 Opus",value:"claude-3-opus-20240229",cost:"$15/$75 per 1M tokens"},{label:"Claude 3 Sonnet",value:"claude-3-sonnet-20240229",cost:"$3/$15 per 1M tokens"},{label:"Claude 3 Haiku",value:"claude-3-haiku-20240307",cost:"$0.25/$1.25 per 1M tokens"}],openai:[{label:"GPT-4 Turbo",value:"gpt-4-turbo-preview",recommended:!0,cost:"$10/$30 per 1M tokens"},{label:"GPT-4",value:"gpt-4",cost:"$30/$60 per 1M tokens"},{label:"GPT-3.5 Turbo",value:"gpt-3.5-turbo",cost:"$0.5/$1.5 per 1M tokens"}],ollama:[{label:"Llama 2",value:"llama2",recommended:!0,cost:"免费"},{label:"Llama 2 13B",value:"llama2:13b",cost:"免费"},{label:"Mistral",value:"mistral",cost:"免费"},{label:"Mixtral",value:"mixtral",cost:"免费"}]})[a.value.aiProvider]||[],K=()=>a.value.aiProvider==="claude"?"sk-ant-api03-...":a.value.aiProvider==="openai"?"sk-...":"",N=()=>{const s=$();s.length>0&&(a.value.aiModel=s[0].value)},j=()=>{a.value.weights={...M.weights},r.success("已恢复默认权重")},J=async()=>{D.value=!0;try{await fe(a.value),localStorage.setItem("smartSearchConfig",JSON.stringify(a.value)),r.success("配置已保存到数据库"),a.value.debugMode&&console.log("保存的配置:",a.value)}catch(s){console.error("保存配置失败:",s),r.error("保存失败: "+(s.message||"未知错误"))}finally{D.value=!1}},F=()=>{try{const s=JSON.stringify(a.value,null,2),e=new Blob([s],{type:"application/json"}),b=URL.createObjectURL(e),m=document.createElement("a");m.href=b,m.download=`smart-search-config-${Date.now()}.json`,m.click(),URL.revokeObjectURL(b),r.success("配置已导出")}catch(s){r.error("导出失败: "+s.message)}},G=()=>{var s;(s=L.value)==null||s.click()},Q=s=>{const e=s.target.files[0];if(!e)return;const b=new FileReader;b.onload=m=>{try{const f=JSON.parse(m.target.result);a.value={...M,...f},r.success("配置已导入"),s.target.value=""}catch{r.error("导入失败: 配置文件格式错误")}},b.readAsText(e)},W=async()=>{g.value.search=!0;try{await new Promise(s=>setTimeout(s,1e3)),r.success("搜索服务连接正常")}catch(s){r.error("搜索服务连接失败: "+s.message)}finally{g.value.search=!1}},H=async()=>{if(!a.value.aiApiKey&&a.value.aiProvider!=="ollama"){r.warning("请先配置API Key");return}g.value.ai=!0;try{await new Promise(s=>setTimeout(s,1500)),r.success("AI服务连接正常")}catch(s){r.error("AI服务连接失败: "+s.message)}finally{g.value.ai=!1}},Y=async()=>{if(!a.value.tmdbApiKey){r.warning("请先配置TMDB API Key");return}g.value.tmdb=!0;try{const s=await fetch(`${a.value.tmdbApiUrl}/search/movie?api_key=${a.value.tmdbApiKey}&language=${a.value.tmdbLanguage}&query=阿凡达`,{timeout:a.value.tmdbTimeout});if(s.ok){const e=await s.json();e.results&&e.results.length>0?r.success(`TMDB服务连接正常 (找到 ${e.results.length} 个结果)`):r.warning("TMDB服务连接正常，但未找到测试结果")}else r.error(`TMDB服务连接失败: HTTP ${s.status}`)}catch(s){r.error("TMDB服务连接失败: "+s.message)}finally{g.value.tmdb=!1}},X=async()=>{try{const s=await pe();if(s.data&&Object.keys(s.data).length>0){a.value={...M,...s.data},localStorage.setItem("smartSearchConfig",JSON.stringify(a.value)),a.value.debugMode&&console.log("从数据库加载的配置:",a.value),r.success("已从数据库加载配置");return}}catch(s){console.error("从数据库加载配置失败:",s),r.warning("数据库加载失败，尝试从本地加载")}try{const s=localStorage.getItem("smartSearchConfig");if(s){const e=JSON.parse(s);e.alipanParentId&&!e.cloudConfigs&&(e.cloudConfigs=[{name:"阿里云盘",cloudType:e.cloudType||"channel_alipan",parentId:e.alipanParentId,remark:""}],delete e.alipanParentId,delete e.cloudType),e.cloudConfigs&&e.cloudConfigs.forEach(b=>{delete b.isDefault}),a.value={...M,...e},a.value.debugMode&&console.log("从本地加载的配置:",a.value),r.info("已从本地缓存加载配置")}else r.info("使用默认配置")}catch(s){console.error("加载配置失败:",s),r.warning("加载配置失败，使用默认配置")}},q=()=>{a.value.cloudConfigs.push({name:`云盘配置 ${a.value.cloudConfigs.length+1}`,cloudType:"",parentId:"",remark:""}),r.success("已添加新的云盘配置")},Z=s=>{a.value.cloudConfigs.splice(s,1),r.success("已删除云盘配置")};return be(()=>{X()}),(s,e)=>{const b=i("Upload"),m=i("el-icon"),f=i("el-button"),ee=i("Download"),le=i("Check"),y=i("el-card"),ae=i("Search"),v=i("el-input"),u=i("el-form-item"),C=i("el-input-number"),B=i("Connection"),te=i("FolderOpened"),oe=i("Plus"),S=i("el-alert"),U=i("el-tag"),ne=i("MagicStick"),A=i("el-switch"),V=i("el-option"),h=i("el-select"),w=i("el-slider"),se=i("Film"),ue=i("Link"),de=i("Setting"),ie=i("TrendCharts"),re=i("RefreshLeft"),me=i("el-form");return p(),c("div",ye,[l(y,{class:"header-card"},{default:t(()=>[o("div",Ve,[e[32]||(e[32]=o("h2",null,"智能搜索配置",-1)),o("div",ce,[l(f,{onClick:G},{default:t(()=>[l(m,null,{default:t(()=>[l(b)]),_:1}),e[29]||(e[29]=d(" 导入配置 ",-1))]),_:1}),l(f,{onClick:F},{default:t(()=>[l(m,null,{default:t(()=>[l(ee)]),_:1}),e[30]||(e[30]=d(" 导出配置 ",-1))]),_:1}),l(f,{type:"primary",onClick:J,loading:D.value},{default:t(()=>[l(m,null,{default:t(()=>[l(le)]),_:1}),e[31]||(e[31]=d(" 保存配置 ",-1))]),_:1},8,["loading"])])])]),_:1}),l(me,{ref_key:"formRef",ref:z,model:a.value,"label-width":"150px","label-position":"left"},{default:t(()=>[l(y,{class:"config-section"},{header:t(()=>[o("div",ke,[l(m,null,{default:t(()=>[l(ae)]),_:1}),e[33]||(e[33]=o("span",null,"搜索服务配置",-1))])]),default:t(()=>[l(u,{label:"搜索API地址"},{default:t(()=>[l(v,{modelValue:a.value.searchApiUrl,"onUpdate:modelValue":e[0]||(e[0]=n=>a.value.searchApiUrl=n),placeholder:"http://104.251.122.51:8095/api/v1"},null,8,["modelValue"]),e[34]||(e[34]=o("div",{class:"form-tip"},"Telegram搜索服务的API地址",-1))]),_:1}),l(u,{label:"认证Token"},{default:t(()=>[l(v,{modelValue:a.value.searchAuthToken,"onUpdate:modelValue":e[1]||(e[1]=n=>a.value.searchAuthToken=n),type:"password","show-password":"",placeholder:"Bearer token"},null,8,["modelValue"]),e[35]||(e[35]=o("div",{class:"form-tip"},"用于访问搜索API的认证令牌",-1))]),_:1}),l(u,{label:"请求超时"},{default:t(()=>[l(C,{modelValue:a.value.searchTimeout,"onUpdate:modelValue":e[2]||(e[2]=n=>a.value.searchTimeout=n),min:5e3,max:12e4,step:1e3},null,8,["modelValue"]),e[36]||(e[36]=o("span",{style:{"margin-left":"10px"}},"毫秒",-1))]),_:1}),l(u,{label:"测试连接"},{default:t(()=>[l(f,{onClick:W,loading:g.value.search},{default:t(()=>[l(m,null,{default:t(()=>[l(B)]),_:1}),e[37]||(e[37]=d(" 测试搜索服务 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",Te,[l(m,null,{default:t(()=>[l(te)]),_:1}),e[39]||(e[39]=o("span",null,"云盘配置",-1)),l(f,{type:"primary",size:"small",onClick:q,style:{"margin-left":"auto"}},{default:t(()=>[l(m,null,{default:t(()=>[l(oe)]),_:1}),e[38]||(e[38]=d(" 添加云盘 ",-1))]),_:1})])]),default:t(()=>[l(S,{title:"配置说明",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[40]||(e[40]=[o("div",{style:{"font-size":"13px","line-height":"1.6"}},[o("p",null,[d("根据搜索结果中的 "),o("code",null,"cloudType"),d(" 自动匹配对应的云盘配置。")]),o("p",{style:{"margin-top":"4px"}},[d("例如：搜索结果的 "),o("code",null,"cloudType"),d(" 为 "),o("code",null,"channel_alipan"),d("，系统会自动使用对应配置的目录ID。")])],-1)])]),_:1}),a.value.cloudConfigs.length===0?(p(),I(S,{key:0,title:"暂无云盘配置",type:"warning",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[41]||(e[41]=[d(' 点击"添加云盘"按钮添加第一个云盘配置 ',-1)])]),_:1})):k("",!0),(p(!0),c(P,null,R(a.value.cloudConfigs,(n,O)=>(p(),c("div",{key:O,class:"cloud-config-item"},[l(y,{shadow:"hover"},{header:t(()=>[o("div",Ce,[o("div",null,[l(U,{type:"primary",size:"small"},{default:t(()=>[d(_(n.cloudType),1)]),_:2},1024),o("span",we,_(n.name),1)]),l(f,{type:"danger",link:"",size:"small",onClick:T=>Z(O)},{default:t(()=>[...e[42]||(e[42]=[d(" 删除 ",-1)])]),_:1},8,["onClick"])])]),default:t(()=>[l(u,{label:"配置名称"},{default:t(()=>[l(v,{modelValue:n.name,"onUpdate:modelValue":T=>n.name=T,placeholder:"如：我的阿里云盘"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(u,{label:"云盘类型"},{default:t(()=>[l(v,{modelValue:n.cloudType,"onUpdate:modelValue":T=>n.cloudType=T,placeholder:"如：channel_alipan"},null,8,["modelValue","onUpdate:modelValue"]),e[43]||(e[43]=o("div",{class:"form-tip"},[d(" 必须与搜索结果中的 cloudType 完全一致，常见值： "),o("code",null,"channel_alipan"),d("（阿里云盘）、 "),o("code",null,"channel_189"),d("（天翼云盘） ")],-1))]),_:2},1024),l(u,{label:"目标目录ID"},{default:t(()=>[l(v,{modelValue:n.parentId,"onUpdate:modelValue":T=>n.parentId=T,placeholder:"云盘目录ID"},null,8,["modelValue","onUpdate:modelValue"]),e[44]||(e[44]=o("div",{class:"form-tip"}," 转存到该云盘时使用的目录ID ",-1))]),_:2},1024),l(u,{label:"备注"},{default:t(()=>[l(v,{modelValue:n.remark,"onUpdate:modelValue":T=>n.remark=T,placeholder:"可选"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",Ae,[l(m,null,{default:t(()=>[l(ne)]),_:1}),e[45]||(e[45]=o("span",null,"AI智能筛选配置",-1))])]),default:t(()=>[l(u,{label:"启用AI筛选"},{default:t(()=>[l(A,{modelValue:a.value.aiEnabled,"onUpdate:modelValue":e[3]||(e[3]=n=>a.value.aiEnabled=n)},null,8,["modelValue"]),e[46]||(e[46]=o("div",{class:"form-tip"},"使用AI模型进行智能资源筛选",-1))]),_:1}),a.value.aiEnabled?(p(),c(P,{key:0},[l(u,{label:"AI提供商"},{default:t(()=>[l(h,{modelValue:a.value.aiProvider,"onUpdate:modelValue":e[4]||(e[4]=n=>a.value.aiProvider=n),placeholder:"请选择AI提供商",onChange:N},{default:t(()=>[l(V,{label:"Claude (Anthropic)",value:"claude"},{default:t(()=>[o("div",Ie,[e[48]||(e[48]=o("span",null,"Claude (Anthropic)",-1)),l(U,{size:"small",type:"success"},{default:t(()=>[...e[47]||(e[47]=[d("推荐",-1)])]),_:1})])]),_:1}),l(V,{label:"OpenAI (GPT)",value:"openai"},{default:t(()=>[o("div",Me,[e[50]||(e[50]=o("span",null,"OpenAI (GPT)",-1)),l(U,{size:"small",type:"warning"},{default:t(()=>[...e[49]||(e[49]=[d("付费",-1)])]),_:1})])]),_:1}),l(V,{label:"Ollama (本地)",value:"ollama"},{default:t(()=>[o("div",Ue,[e[52]||(e[52]=o("span",null,"Ollama (本地)",-1)),l(U,{size:"small",type:"info"},{default:t(()=>[...e[51]||(e[51]=[d("免费",-1)])]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a.value.aiProvider!=="ollama"?(p(),I(u,{key:0,label:"API Key"},{default:t(()=>[l(v,{modelValue:a.value.aiApiKey,"onUpdate:modelValue":e[5]||(e[5]=n=>a.value.aiApiKey=n),type:"password","show-password":"",placeholder:K()},null,8,["modelValue","placeholder"]),o("div",xe,[a.value.aiProvider==="claude"?(p(),c("span",Pe,[...e[53]||(e[53]=[d(" 从 ",-1),o("a",{href:"https://console.anthropic.com/",target:"_blank"},"Anthropic Console",-1),d(" 获取 ",-1)])])):a.value.aiProvider==="openai"?(p(),c("span",_e,[...e[54]||(e[54]=[d(" 从 ",-1),o("a",{href:"https://platform.openai.com/api-keys",target:"_blank"},"OpenAI Platform",-1),d(" 获取 ",-1)])])):k("",!0)])]),_:1})):k("",!0),a.value.aiProvider==="ollama"?(p(),I(u,{key:1,label:"API地址"},{default:t(()=>[l(v,{modelValue:a.value.aiApiUrl,"onUpdate:modelValue":e[6]||(e[6]=n=>a.value.aiApiUrl=n),placeholder:"http://localhost:11434"},null,8,["modelValue"]),e[55]||(e[55]=o("div",{class:"form-tip"},"Ollama服务的API地址",-1))]),_:1})):k("",!0),l(u,{label:"模型选择"},{default:t(()=>[l(h,{modelValue:a.value.aiModel,"onUpdate:modelValue":e[7]||(e[7]=n=>a.value.aiModel=n),placeholder:"请选择模型"},{default:t(()=>[(p(!0),c(P,null,R($(),n=>(p(),I(V,{key:n.value,label:n.label,value:n.value},{default:t(()=>[o("div",Se,[o("span",null,_(n.label),1),n.recommended?(p(),I(U,{key:0,size:"small",type:"success"},{default:t(()=>[...e[56]||(e[56]=[d("推荐",-1)])]),_:1})):k("",!0),o("span",De,_(n.cost),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"最大Token数"},{default:t(()=>[l(C,{modelValue:a.value.aiMaxTokens,"onUpdate:modelValue":e[8]||(e[8]=n=>a.value.aiMaxTokens=n),min:256,max:4096,step:256},null,8,["modelValue"]),e[57]||(e[57]=o("div",{class:"form-tip"},"AI响应的最大token数量",-1))]),_:1}),l(u,{label:"温度参数"},{default:t(()=>[l(w,{modelValue:a.value.aiTemperature,"onUpdate:modelValue":e[9]||(e[9]=n=>a.value.aiTemperature=n),min:0,max:1,step:.1,"show-stops":""},null,8,["modelValue"]),e[58]||(e[58]=o("div",{class:"form-tip"},"控制AI输出的随机性，0=确定性，1=创造性",-1))]),_:1}),l(u,{label:"测试AI连接"},{default:t(()=>[l(f,{onClick:H,loading:g.value.ai},{default:t(()=>[l(m,null,{default:t(()=>[l(B)]),_:1}),e[59]||(e[59]=d(" 测试AI服务 ",-1))]),_:1},8,["loading"])]),_:1})],64)):k("",!0)]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",Be,[l(m,null,{default:t(()=>[l(se)]),_:1}),e[60]||(e[60]=o("span",null,"TMDB配置",-1))])]),default:t(()=>[l(S,{title:"TMDB说明",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[61]||(e[61]=[o("div",{style:{"font-size":"13px","line-height":"1.6"}},[o("p",null,"TMDB (The Movie Database) 用于获取影视作品的元数据和ID。"),o("p",{style:{"margin-top":"4px"}},"配置后可以自动补充115资源的TMDB ID，提高匹配准确度。")],-1)])]),_:1}),l(u,{label:"启用TMDB"},{default:t(()=>[l(A,{modelValue:a.value.tmdbEnabled,"onUpdate:modelValue":e[10]||(e[10]=n=>a.value.tmdbEnabled=n)},null,8,["modelValue"]),e[62]||(e[62]=o("div",{class:"form-tip"},"启用后可以使用TMDB API进行影视信息查询",-1))]),_:1}),a.value.tmdbEnabled?(p(),c(P,{key:0},[l(u,{label:"TMDB API Key"},{default:t(()=>[l(v,{modelValue:a.value.tmdbApiKey,"onUpdate:modelValue":e[11]||(e[11]=n=>a.value.tmdbApiKey=n),type:"password","show-password":"",placeholder:"请输入TMDB API Key"},null,8,["modelValue"]),e[63]||(e[63]=o("div",{class:"form-tip"},[d(" 从 "),o("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank"},"TMDB API Settings"),d(" 获取API密钥 ")],-1))]),_:1}),l(u,{label:"TMDB API地址"},{default:t(()=>[l(v,{modelValue:a.value.tmdbApiUrl,"onUpdate:modelValue":e[12]||(e[12]=n=>a.value.tmdbApiUrl=n),placeholder:"https://api.themoviedb.org/3"},null,8,["modelValue"]),e[64]||(e[64]=o("div",{class:"form-tip"},"TMDB API的基础URL，通常使用默认值即可",-1))]),_:1}),l(u,{label:"语言设置"},{default:t(()=>[l(h,{modelValue:a.value.tmdbLanguage,"onUpdate:modelValue":e[13]||(e[13]=n=>a.value.tmdbLanguage=n),placeholder:"请选择语言"},{default:t(()=>[l(V,{label:"简体中文",value:"zh-CN"}),l(V,{label:"繁体中文",value:"zh-TW"}),l(V,{label:"英语",value:"en-US"}),l(V,{label:"日语",value:"ja-JP"}),l(V,{label:"韩语",value:"ko-KR"})]),_:1},8,["modelValue"]),e[65]||(e[65]=o("div",{class:"form-tip"},"TMDB返回数据的语言",-1))]),_:1}),l(u,{label:"请求超时"},{default:t(()=>[l(C,{modelValue:a.value.tmdbTimeout,"onUpdate:modelValue":e[14]||(e[14]=n=>a.value.tmdbTimeout=n),min:3e3,max:3e4,step:1e3},null,8,["modelValue"]),e[66]||(e[66]=o("span",{style:{"margin-left":"10px"}},"毫秒",-1)),e[67]||(e[67]=o("div",{class:"form-tip"},"TMDB API请求的超时时间",-1))]),_:1}),l(u,{label:"自动匹配"},{default:t(()=>[l(A,{modelValue:a.value.tmdbAutoMatch,"onUpdate:modelValue":e[15]||(e[15]=n=>a.value.tmdbAutoMatch=n)},null,8,["modelValue"]),e[68]||(e[68]=o("div",{class:"form-tip"},"在115资源管理中自动搜索并匹配TMDB ID",-1))]),_:1}),l(u,{label:"测试TMDB连接"},{default:t(()=>[l(f,{onClick:Y,loading:g.value.tmdb},{default:t(()=>[l(m,null,{default:t(()=>[l(B)]),_:1}),e[69]||(e[69]=d(" 测试TMDB服务 ",-1))]),_:1},8,["loading"])]),_:1})],64)):k("",!0)]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",he,[l(m,null,{default:t(()=>[l(ue)]),_:1}),e[70]||(e[70]=o("span",null,"链接验证配置",-1))])]),default:t(()=>[l(u,{label:"启用链接验证"},{default:t(()=>[l(A,{modelValue:a.value.validateLinks,"onUpdate:modelValue":e[16]||(e[16]=n=>a.value.validateLinks=n)},null,8,["modelValue"]),e[71]||(e[71]=o("div",{class:"form-tip"},"通过实际转存测试验证链接是否有效（转存失败或404表示链接失效）",-1))]),_:1}),a.value.validateLinks?(p(),I(S,{key:0,title:"验证说明",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[72]||(e[72]=[o("div",{style:{"font-size":"13px","line-height":"1.6"}},[o("p",null,"链接验证通过实际转存操作来检测链接有效性："),o("ul",{style:{margin:"8px 0","padding-left":"20px"}},[o("li",null,"✓ 转存成功 = 链接有效"),o("li",null,"✗ 转存失败/404 = 链接失效"),o("li",null,"有效链接额外加分：+10分")]),o("p",{style:{"margin-top":"8px",color:"#ff9500"}},[o("strong",null,"注意："),d("验证过程会实际调用转存API，请确保搜索服务已正确配置。 ")])],-1)])]),_:1})):k("",!0),a.value.validateLinks?(p(),c(P,{key:1},[l(u,{label:"验证超时"},{default:t(()=>[l(C,{modelValue:a.value.validationTimeout,"onUpdate:modelValue":e[17]||(e[17]=n=>a.value.validationTimeout=n),min:3e3,max:3e4,step:1e3},null,8,["modelValue"]),e[73]||(e[73]=o("span",{style:{"margin-left":"10px"}},"毫秒",-1)),e[74]||(e[74]=o("div",{class:"form-tip"},"单个链接验证的超时时间",-1))]),_:1}),l(u,{label:"最大验证数"},{default:t(()=>[l(C,{modelValue:a.value.maxValidationCount,"onUpdate:modelValue":e[18]||(e[18]=n=>a.value.maxValidationCount=n),min:5,max:50,step:5},null,8,["modelValue"]),e[75]||(e[75]=o("div",{class:"form-tip"},"最多验证前N个搜索结果（避免过多API调用）",-1))]),_:1})],64)):k("",!0)]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",Le,[l(m,null,{default:t(()=>[l(de)]),_:1}),e[76]||(e[76]=o("span",null,"高级设置",-1))])]),default:t(()=>[l(u,{label:"缓存时间"},{default:t(()=>[l(C,{modelValue:a.value.cacheTime,"onUpdate:modelValue":e[19]||(e[19]=n=>a.value.cacheTime=n),min:0,max:3600,step:60},null,8,["modelValue"]),e[77]||(e[77]=o("span",{style:{"margin-left":"10px"}},"秒 (0=禁用缓存)",-1)),e[78]||(e[78]=o("div",{class:"form-tip"},"搜索结果和验证结果的缓存时间",-1))]),_:1}),l(u,{label:"最大结果数"},{default:t(()=>[l(C,{modelValue:a.value.maxResults,"onUpdate:modelValue":e[20]||(e[20]=n=>a.value.maxResults=n),min:10,max:100,step:10},null,8,["modelValue"]),e[79]||(e[79]=o("div",{class:"form-tip"},"每次搜索返回的最大结果数量",-1))]),_:1}),l(u,{label:"调试模式"},{default:t(()=>[l(A,{modelValue:a.value.debugMode,"onUpdate:modelValue":e[21]||(e[21]=n=>a.value.debugMode=n)},null,8,["modelValue"]),e[80]||(e[80]=o("div",{class:"form-tip"},"启用后会在控制台输出详细日志",-1))]),_:1}),l(u,{label:"自动选择最佳"},{default:t(()=>[l(A,{modelValue:a.value.autoSelectBest,"onUpdate:modelValue":e[22]||(e[22]=n=>a.value.autoSelectBest=n)},null,8,["modelValue"]),e[81]||(e[81]=o("div",{class:"form-tip"},"搜索后自动选择评分最高的资源",-1))]),_:1})]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",$e,[l(m,null,{default:t(()=>[l(ie)]),_:1}),e[82]||(e[82]=o("span",null,"评分权重配置",-1))])]),default:t(()=>[l(u,{label:"标题匹配度"},{default:t(()=>[l(w,{modelValue:a.value.weights.titleMatch,"onUpdate:modelValue":e[23]||(e[23]=n=>a.value.weights.titleMatch=n),min:0,max:50,"show-input":""},null,8,["modelValue"]),e[83]||(e[83]=o("div",{class:"form-tip"},"标题与电影名称的匹配程度 (默认: 40分)",-1))]),_:1}),l(u,{label:"分辨率"},{default:t(()=>[l(w,{modelValue:a.value.weights.resolution,"onUpdate:modelValue":e[24]||(e[24]=n=>a.value.weights.resolution=n),min:0,max:30,"show-input":""},null,8,["modelValue"]),e[84]||(e[84]=o("div",{class:"form-tip"},"视频分辨率质量 (默认: 20分)",-1))]),_:1}),l(u,{label:"文件大小"},{default:t(()=>[l(w,{modelValue:a.value.weights.fileSize,"onUpdate:modelValue":e[25]||(e[25]=n=>a.value.weights.fileSize=n),min:0,max:20,"show-input":""},null,8,["modelValue"]),e[85]||(e[85]=o("div",{class:"form-tip"},"文件大小合理性 (默认: 15分)",-1))]),_:1}),l(u,{label:"标签匹配"},{default:t(()=>[l(w,{modelValue:a.value.weights.tagMatch,"onUpdate:modelValue":e[26]||(e[26]=n=>a.value.weights.tagMatch=n),min:0,max:15,"show-input":""},null,8,["modelValue"]),e[86]||(e[86]=o("div",{class:"form-tip"},"标签与电影类型的匹配 (默认: 10分)",-1))]),_:1}),l(u,{label:"来源可信度"},{default:t(()=>[l(w,{modelValue:a.value.weights.sourceCredibility,"onUpdate:modelValue":e[27]||(e[27]=n=>a.value.weights.sourceCredibility=n),min:0,max:15,"show-input":""},null,8,["modelValue"]),e[87]||(e[87]=o("div",{class:"form-tip"},"资源来源的可信度 (默认: 10分)",-1))]),_:1}),l(u,{label:"时效性"},{default:t(()=>[l(w,{modelValue:a.value.weights.timeliness,"onUpdate:modelValue":e[28]||(e[28]=n=>a.value.weights.timeliness=n),min:0,max:10,"show-input":""},null,8,["modelValue"]),e[88]||(e[88]=o("div",{class:"form-tip"},"资源发布时间 (默认: 5分)",-1))]),_:1}),l(u,null,{default:t(()=>[l(f,{onClick:j,size:"small"},{default:t(()=>[l(m,null,{default:t(()=>[l(re)]),_:1}),e[89]||(e[89]=d(" 恢复默认权重 ",-1))]),_:1}),o("span",Oe," 总分: "+_(E.value)+"分 ",1)]),_:1})]),_:1})]),_:1},8,["model"]),o("input",{ref_key:"fileInputRef",ref:L,type:"file",accept:".json",style:{display:"none"},onChange:Q},null,544)])}}},Je=ve(Re,[["__scopeId","data-v-51cca9d1"]]);export{Je as default};
