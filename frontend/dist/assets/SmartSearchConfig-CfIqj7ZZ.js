import{g as ve,s as ge}from"./smartSearchConfig-C2PzHA7y.js";import{r as K}from"./request-BSyjQB9W.js";import{_ as be,a as D,l as ye,o as Ve,c as k,b as p,d as l,f as o,w as t,e as r,j as d,i as A,y as T,R as U,S as E,t as S,E as i}from"./index-D-xSYIE6.js";import"./index-B9ygI19o.js";function ke(){return K({url:"/115-transfer/test-cookie",method:"get"})}function Te(){return K({url:"/115-transfer/user-info",method:"get"})}const Ce={class:"smart-search-config-container"},ce={class:"header-content"},Ie={class:"header-actions"},we={class:"section-header"},Ae={class:"section-header"},Ue={style:{display:"flex","justify-content":"space-between","align-items":"center"}},xe={style:{"margin-left":"8px","font-weight":"600"}},Me={class:"section-header"},Pe={class:"provider-option"},De={class:"provider-option"},Se={class:"provider-option"},Be={class:"form-tip"},_e={key:0},$e={key:1},Le={class:"model-option"},Re={class:"model-cost"},ze={class:"section-header"},Oe={class:"section-header"},Ee={class:"section-header"},Ke={class:"section-header"},he={class:"section-header"},Ne={style:{"margin-left":"10px",color:"#909399"}},je={__name:"SmartSearchConfig",setup(Fe){const h=D(null),L=D(null),_=D(!1),v=D({search:!1,ai:!1,tmdb:!1,transfer115:!1}),x={searchApiUrl:"http://104.251.122.51:8095/api/v1",searchAuthToken:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NzE3ODQxMTEsInVzZXJuYW1lIjoiYWRtaW4ifQ.9EPowlYRQCLx1p03TfbAQ9T8cxKUQdSrBVEQa67R1nI",searchTimeout:3e4,cloudConfigs:[{name:"阿里云盘",cloudType:"channel_alipan",parentId:"697f2333cd2704159fa446d8bc5077584838e3dc",remark:""}],aiEnabled:!1,aiProvider:"claude",apiKey:"",aiApiUrl:"http://localhost:11434",aiModel:"claude-3-5-sonnet-20241022",aiMaxTokens:1024,aiTemperature:.7,tmdbEnabled:!1,tmdbApiKey:"",tmdbApiUrl:"https://api.themoviedb.org/3",tmdbLanguage:"zh-CN",tmdbTimeout:1e4,tmdbAutoMatch:!0,enable115Transfer:!1,cookie115:"",targetFolderId115:"0",validateLinks:!0,validationTimeout:1e4,maxValidationCount:20,cacheTime:300,maxResults:50,debugMode:!1,autoSelectBest:!0,weights:{titleMatch:40,resolution:20,fileSize:15,tagMatch:10,sourceCredibility:10,timeliness:5}},a=D({...x}),N=ye(()=>Object.values(a.value.weights).reduce((s,e)=>s+e,0)),R=()=>({claude:[{label:"Claude 3.5 Sonnet",value:"claude-3-5-sonnet-20241022",recommended:!0,cost:"$3/$15 per 1M tokens"},{label:"Claude 3 Opus",value:"claude-3-opus-20240229",cost:"$15/$75 per 1M tokens"},{label:"Claude 3 Sonnet",value:"claude-3-sonnet-20240229",cost:"$3/$15 per 1M tokens"},{label:"Claude 3 Haiku",value:"claude-3-haiku-20240307",cost:"$0.25/$1.25 per 1M tokens"}],openai:[{label:"GPT-4 Turbo",value:"gpt-4-turbo-preview",recommended:!0,cost:"$10/$30 per 1M tokens"},{label:"GPT-4",value:"gpt-4",cost:"$30/$60 per 1M tokens"},{label:"GPT-3.5 Turbo",value:"gpt-3.5-turbo",cost:"$0.5/$1.5 per 1M tokens"}],ollama:[{label:"Llama 2",value:"llama2",recommended:!0,cost:"免费"},{label:"Llama 2 13B",value:"llama2:13b",cost:"免费"},{label:"Mistral",value:"mistral",cost:"免费"},{label:"Mixtral",value:"mixtral",cost:"免费"}]})[a.value.aiProvider]||[],j=()=>a.value.aiProvider==="claude"?"sk-ant-api03-...":a.value.aiProvider==="openai"?"sk-...":"",F=()=>{const s=R();s.length>0&&(a.value.aiModel=s[0].value)},J=()=>{a.value.weights={...x.weights},i.success("已恢复默认权重")},G=async()=>{_.value=!0;try{await ge(a.value),localStorage.setItem("smartSearchConfig",JSON.stringify(a.value)),i.success("配置已保存到数据库"),a.value.debugMode&&console.log("保存的配置:",a.value)}catch(s){console.error("保存配置失败:",s),i.error("保存失败: "+(s.message||"未知错误"))}finally{_.value=!1}},Q=()=>{try{const s=JSON.stringify(a.value,null,2),e=new Blob([s],{type:"application/json"}),b=URL.createObjectURL(e),m=document.createElement("a");m.href=b,m.download=`smart-search-config-${Date.now()}.json`,m.click(),URL.revokeObjectURL(b),i.success("配置已导出")}catch(s){i.error("导出失败: "+s.message)}},W=()=>{var s;(s=L.value)==null||s.click()},H=s=>{const e=s.target.files[0];if(!e)return;const b=new FileReader;b.onload=m=>{try{const f=JSON.parse(m.target.result);a.value={...x,...f},i.success("配置已导入"),s.target.value=""}catch{i.error("导入失败: 配置文件格式错误")}},b.readAsText(e)},Y=async()=>{v.value.search=!0;try{await new Promise(s=>setTimeout(s,1e3)),i.success("搜索服务连接正常")}catch(s){i.error("搜索服务连接失败: "+s.message)}finally{v.value.search=!1}},q=async()=>{if(!a.value.aiApiKey&&a.value.aiProvider!=="ollama"){i.warning("请先配置API Key");return}v.value.ai=!0;try{await new Promise(s=>setTimeout(s,1500)),i.success("AI服务连接正常")}catch(s){i.error("AI服务连接失败: "+s.message)}finally{v.value.ai=!1}},X=async()=>{if(!a.value.tmdbApiKey){i.warning("请先配置TMDB API Key");return}v.value.tmdb=!0;try{const s=await fetch(`${a.value.tmdbApiUrl}/search/movie?api_key=${a.value.tmdbApiKey}&language=${a.value.tmdbLanguage}&query=阿凡达`,{timeout:a.value.tmdbTimeout});if(s.ok){const e=await s.json();e.results&&e.results.length>0?i.success(`TMDB服务连接正常 (找到 ${e.results.length} 个结果)`):i.warning("TMDB服务连接正常，但未找到测试结果")}else i.error(`TMDB服务连接失败: HTTP ${s.status}`)}catch(s){i.error("TMDB服务连接失败: "+s.message)}finally{v.value.tmdb=!1}},Z=async()=>{if(!a.value.cookie115){i.warning("请先配置115 Cookie");return}v.value.transfer115=!0;try{if((await ke()).code===200){const e=await Te();if(e.code===200){const b=e.data;i.success(`115服务连接正常 (用户: ${b.user_name})`)}else i.success("115服务连接正常")}else i.error("115 Cookie无效或已过期")}catch(s){i.error("115服务连接失败: "+s.message)}finally{v.value.transfer115=!1}},ee=async()=>{try{const s=await ve();if(s.data&&Object.keys(s.data).length>0){a.value={...x,...s.data},localStorage.setItem("smartSearchConfig",JSON.stringify(a.value)),a.value.debugMode&&console.log("从数据库加载的配置:",a.value),i.success("已从数据库加载配置");return}}catch(s){console.error("从数据库加载配置失败:",s),i.warning("数据库加载失败，尝试从本地加载")}try{const s=localStorage.getItem("smartSearchConfig");if(s){const e=JSON.parse(s);e.alipanParentId&&!e.cloudConfigs&&(e.cloudConfigs=[{name:"阿里云盘",cloudType:e.cloudType||"channel_alipan",parentId:e.alipanParentId,remark:""}],delete e.alipanParentId,delete e.cloudType),e.cloudConfigs&&e.cloudConfigs.forEach(b=>{delete b.isDefault}),a.value={...x,...e},a.value.debugMode&&console.log("从本地加载的配置:",a.value),i.info("已从本地缓存加载配置")}else i.info("使用默认配置")}catch(s){console.error("加载配置失败:",s),i.warning("加载配置失败，使用默认配置")}},le=()=>{a.value.cloudConfigs.push({name:`云盘配置 ${a.value.cloudConfigs.length+1}`,cloudType:"",parentId:"",priority:a.value.cloudConfigs.length+1,remark:""}),i.success("已添加新的云盘配置")},ae=s=>{a.value.cloudConfigs.splice(s,1),i.success("已删除云盘配置")};return Ve(()=>{ee()}),(s,e)=>{const b=r("Upload"),m=r("el-icon"),f=r("el-button"),te=r("Download"),oe=r("Check"),y=r("el-card"),ne=r("Search"),g=r("el-input"),u=r("el-form-item"),c=r("el-input-number"),B=r("Connection"),z=r("FolderOpened"),se=r("Plus"),M=r("el-alert"),P=r("el-tag"),ue=r("MagicStick"),I=r("el-switch"),C=r("el-option"),$=r("el-select"),w=r("el-slider"),de=r("Film"),ie=r("Link"),re=r("Setting"),me=r("TrendCharts"),pe=r("RefreshLeft"),fe=r("el-form");return p(),k("div",Ce,[l(y,{class:"header-card"},{default:t(()=>[o("div",ce,[e[35]||(e[35]=o("h2",null,"智能搜索配置",-1)),o("div",Ie,[l(f,{onClick:W},{default:t(()=>[l(m,null,{default:t(()=>[l(b)]),_:1}),e[32]||(e[32]=d(" 导入配置 ",-1))]),_:1}),l(f,{onClick:Q},{default:t(()=>[l(m,null,{default:t(()=>[l(te)]),_:1}),e[33]||(e[33]=d(" 导出配置 ",-1))]),_:1}),l(f,{type:"primary",onClick:G,loading:_.value},{default:t(()=>[l(m,null,{default:t(()=>[l(oe)]),_:1}),e[34]||(e[34]=d(" 保存配置 ",-1))]),_:1},8,["loading"])])])]),_:1}),l(fe,{ref_key:"formRef",ref:h,model:a.value,"label-width":"150px","label-position":"left"},{default:t(()=>[l(y,{class:"config-section"},{header:t(()=>[o("div",we,[l(m,null,{default:t(()=>[l(ne)]),_:1}),e[36]||(e[36]=o("span",null,"搜索服务配置",-1))])]),default:t(()=>[l(u,{label:"搜索API地址"},{default:t(()=>[l(g,{modelValue:a.value.searchApiUrl,"onUpdate:modelValue":e[0]||(e[0]=n=>a.value.searchApiUrl=n),placeholder:"http://104.251.122.51:8095/api/v1"},null,8,["modelValue"]),e[37]||(e[37]=o("div",{class:"form-tip"},"Telegram搜索服务的API地址",-1))]),_:1}),l(u,{label:"认证Token"},{default:t(()=>[l(g,{modelValue:a.value.searchAuthToken,"onUpdate:modelValue":e[1]||(e[1]=n=>a.value.searchAuthToken=n),type:"password","show-password":"",placeholder:"Bearer token"},null,8,["modelValue"]),e[38]||(e[38]=o("div",{class:"form-tip"},"用于访问搜索API的认证令牌",-1))]),_:1}),l(u,{label:"请求超时"},{default:t(()=>[l(c,{modelValue:a.value.searchTimeout,"onUpdate:modelValue":e[2]||(e[2]=n=>a.value.searchTimeout=n),min:5e3,max:12e4,step:1e3},null,8,["modelValue"]),e[39]||(e[39]=o("span",{style:{"margin-left":"10px"}},"毫秒",-1))]),_:1}),l(u,{label:"测试连接"},{default:t(()=>[l(f,{onClick:Y,loading:v.value.search},{default:t(()=>[l(m,null,{default:t(()=>[l(B)]),_:1}),e[40]||(e[40]=d(" 测试搜索服务 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",Ae,[l(m,null,{default:t(()=>[l(z)]),_:1}),e[42]||(e[42]=o("span",null,"云盘配置",-1)),l(f,{type:"primary",size:"small",onClick:le,style:{"margin-left":"auto"}},{default:t(()=>[l(m,null,{default:t(()=>[l(se)]),_:1}),e[41]||(e[41]=d(" 添加云盘 ",-1))]),_:1})])]),default:t(()=>[l(M,{title:"配置说明",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[43]||(e[43]=[o("div",{style:{"font-size":"13px","line-height":"1.6"}},[o("p",null,[d("根据搜索结果中的 "),o("code",null,"cloudType"),d(" 自动匹配对应的云盘配置。")]),o("p",{style:{"margin-top":"4px"}},[d("例如：搜索结果的 "),o("code",null,"cloudType"),d(" 为 "),o("code",null,"channel_alipan"),d("，系统会自动使用对应配置的目录ID。")])],-1)])]),_:1}),a.value.cloudConfigs.length===0?(p(),A(M,{key:0,title:"暂无云盘配置",type:"warning",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[44]||(e[44]=[d(' 点击"添加云盘"按钮添加第一个云盘配置 ',-1)])]),_:1})):T("",!0),(p(!0),k(U,null,E(a.value.cloudConfigs,(n,O)=>(p(),k("div",{key:O,class:"cloud-config-item"},[l(y,{shadow:"hover"},{header:t(()=>[o("div",Ue,[o("div",null,[l(P,{type:"primary",size:"small"},{default:t(()=>[d(S(n.cloudType),1)]),_:2},1024),o("span",xe,S(n.name),1)]),l(f,{type:"danger",link:"",size:"small",onClick:V=>ae(O)},{default:t(()=>[...e[45]||(e[45]=[d(" 删除 ",-1)])]),_:1},8,["onClick"])])]),default:t(()=>[l(u,{label:"配置名称"},{default:t(()=>[l(g,{modelValue:n.name,"onUpdate:modelValue":V=>n.name=V,placeholder:"如：我的阿里云盘"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(u,{label:"云盘类型"},{default:t(()=>[l(g,{modelValue:n.cloudType,"onUpdate:modelValue":V=>n.cloudType=V,placeholder:"如：channel_alipan"},null,8,["modelValue","onUpdate:modelValue"]),e[46]||(e[46]=o("div",{class:"form-tip"},[d(" 必须与搜索结果中的 cloudType 完全一致，常见值： "),o("code",null,"channel_alipan"),d("（阿里云盘）、 "),o("code",null,"channel_189"),d("（天翼云盘）、 "),o("code",null,"channel_115"),d("（115网盘） ")],-1))]),_:2},1024),l(u,{label:"优先级"},{default:t(()=>[l(c,{modelValue:n.priority,"onUpdate:modelValue":V=>n.priority=V,min:1,max:100},null,8,["modelValue","onUpdate:modelValue"]),e[47]||(e[47]=o("span",{style:{"margin-left":"10px"}},"数字越小优先级越高（1最高）",-1)),e[48]||(e[48]=o("div",{class:"form-tip"}," 转存时会优先尝试优先级高的云盘。建议：天翼云盘=1，阿里云盘=2，115网盘=3 ",-1))]),_:2},1024),l(u,{label:"目标目录ID"},{default:t(()=>[l(g,{modelValue:n.parentId,"onUpdate:modelValue":V=>n.parentId=V,placeholder:"云盘目录ID"},null,8,["modelValue","onUpdate:modelValue"]),e[49]||(e[49]=o("div",{class:"form-tip"}," 转存到该云盘时使用的目录ID ",-1))]),_:2},1024),l(u,{label:"备注"},{default:t(()=>[l(g,{modelValue:n.remark,"onUpdate:modelValue":V=>n.remark=V,placeholder:"可选"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",Me,[l(m,null,{default:t(()=>[l(ue)]),_:1}),e[50]||(e[50]=o("span",null,"AI智能筛选配置",-1))])]),default:t(()=>[l(u,{label:"启用AI筛选"},{default:t(()=>[l(I,{modelValue:a.value.aiEnabled,"onUpdate:modelValue":e[3]||(e[3]=n=>a.value.aiEnabled=n)},null,8,["modelValue"]),e[51]||(e[51]=o("div",{class:"form-tip"},"使用AI模型进行智能资源筛选",-1))]),_:1}),a.value.aiEnabled?(p(),k(U,{key:0},[l(u,{label:"AI提供商"},{default:t(()=>[l($,{modelValue:a.value.aiProvider,"onUpdate:modelValue":e[4]||(e[4]=n=>a.value.aiProvider=n),placeholder:"请选择AI提供商",onChange:F},{default:t(()=>[l(C,{label:"Claude (Anthropic)",value:"claude"},{default:t(()=>[o("div",Pe,[e[53]||(e[53]=o("span",null,"Claude (Anthropic)",-1)),l(P,{size:"small",type:"success"},{default:t(()=>[...e[52]||(e[52]=[d("推荐",-1)])]),_:1})])]),_:1}),l(C,{label:"OpenAI (GPT)",value:"openai"},{default:t(()=>[o("div",De,[e[55]||(e[55]=o("span",null,"OpenAI (GPT)",-1)),l(P,{size:"small",type:"warning"},{default:t(()=>[...e[54]||(e[54]=[d("付费",-1)])]),_:1})])]),_:1}),l(C,{label:"Ollama (本地)",value:"ollama"},{default:t(()=>[o("div",Se,[e[57]||(e[57]=o("span",null,"Ollama (本地)",-1)),l(P,{size:"small",type:"info"},{default:t(()=>[...e[56]||(e[56]=[d("免费",-1)])]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a.value.aiProvider!=="ollama"?(p(),A(u,{key:0,label:"API Key"},{default:t(()=>[l(g,{modelValue:a.value.aiApiKey,"onUpdate:modelValue":e[5]||(e[5]=n=>a.value.aiApiKey=n),type:"password","show-password":"",placeholder:j()},null,8,["modelValue","placeholder"]),o("div",Be,[a.value.aiProvider==="claude"?(p(),k("span",_e,[...e[58]||(e[58]=[d(" 从 ",-1),o("a",{href:"https://console.anthropic.com/",target:"_blank"},"Anthropic Console",-1),d(" 获取 ",-1)])])):a.value.aiProvider==="openai"?(p(),k("span",$e,[...e[59]||(e[59]=[d(" 从 ",-1),o("a",{href:"https://platform.openai.com/api-keys",target:"_blank"},"OpenAI Platform",-1),d(" 获取 ",-1)])])):T("",!0)])]),_:1})):T("",!0),a.value.aiProvider==="ollama"?(p(),A(u,{key:1,label:"API地址"},{default:t(()=>[l(g,{modelValue:a.value.aiApiUrl,"onUpdate:modelValue":e[6]||(e[6]=n=>a.value.aiApiUrl=n),placeholder:"http://localhost:11434"},null,8,["modelValue"]),e[60]||(e[60]=o("div",{class:"form-tip"},"Ollama服务的API地址",-1))]),_:1})):T("",!0),l(u,{label:"模型选择"},{default:t(()=>[l($,{modelValue:a.value.aiModel,"onUpdate:modelValue":e[7]||(e[7]=n=>a.value.aiModel=n),placeholder:"请选择模型"},{default:t(()=>[(p(!0),k(U,null,E(R(),n=>(p(),A(C,{key:n.value,label:n.label,value:n.value},{default:t(()=>[o("div",Le,[o("span",null,S(n.label),1),n.recommended?(p(),A(P,{key:0,size:"small",type:"success"},{default:t(()=>[...e[61]||(e[61]=[d("推荐",-1)])]),_:1})):T("",!0),o("span",Re,S(n.cost),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"最大Token数"},{default:t(()=>[l(c,{modelValue:a.value.aiMaxTokens,"onUpdate:modelValue":e[8]||(e[8]=n=>a.value.aiMaxTokens=n),min:256,max:4096,step:256},null,8,["modelValue"]),e[62]||(e[62]=o("div",{class:"form-tip"},"AI响应的最大token数量",-1))]),_:1}),l(u,{label:"温度参数"},{default:t(()=>[l(w,{modelValue:a.value.aiTemperature,"onUpdate:modelValue":e[9]||(e[9]=n=>a.value.aiTemperature=n),min:0,max:1,step:.1,"show-stops":""},null,8,["modelValue"]),e[63]||(e[63]=o("div",{class:"form-tip"},"控制AI输出的随机性，0=确定性，1=创造性",-1))]),_:1}),l(u,{label:"测试AI连接"},{default:t(()=>[l(f,{onClick:q,loading:v.value.ai},{default:t(()=>[l(m,null,{default:t(()=>[l(B)]),_:1}),e[64]||(e[64]=d(" 测试AI服务 ",-1))]),_:1},8,["loading"])]),_:1})],64)):T("",!0)]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",ze,[l(m,null,{default:t(()=>[l(de)]),_:1}),e[65]||(e[65]=o("span",null,"TMDB配置",-1))])]),default:t(()=>[l(M,{title:"TMDB说明",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[66]||(e[66]=[o("div",{style:{"font-size":"13px","line-height":"1.6"}},[o("p",null,"TMDB (The Movie Database) 用于获取影视作品的元数据和ID。"),o("p",{style:{"margin-top":"4px"}},"配置后可以自动补充115资源的TMDB ID，提高匹配准确度。")],-1)])]),_:1}),l(u,{label:"启用TMDB"},{default:t(()=>[l(I,{modelValue:a.value.tmdbEnabled,"onUpdate:modelValue":e[10]||(e[10]=n=>a.value.tmdbEnabled=n)},null,8,["modelValue"]),e[67]||(e[67]=o("div",{class:"form-tip"},"启用后可以使用TMDB API进行影视信息查询",-1))]),_:1}),a.value.tmdbEnabled?(p(),k(U,{key:0},[l(u,{label:"TMDB API Key"},{default:t(()=>[l(g,{modelValue:a.value.tmdbApiKey,"onUpdate:modelValue":e[11]||(e[11]=n=>a.value.tmdbApiKey=n),type:"password","show-password":"",placeholder:"请输入TMDB API Key"},null,8,["modelValue"]),e[68]||(e[68]=o("div",{class:"form-tip"},[d(" 从 "),o("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank"},"TMDB API Settings"),d(" 获取API密钥 ")],-1))]),_:1}),l(u,{label:"TMDB API地址"},{default:t(()=>[l(g,{modelValue:a.value.tmdbApiUrl,"onUpdate:modelValue":e[12]||(e[12]=n=>a.value.tmdbApiUrl=n),placeholder:"https://api.themoviedb.org/3"},null,8,["modelValue"]),e[69]||(e[69]=o("div",{class:"form-tip"},"TMDB API的基础URL，通常使用默认值即可",-1))]),_:1}),l(u,{label:"语言设置"},{default:t(()=>[l($,{modelValue:a.value.tmdbLanguage,"onUpdate:modelValue":e[13]||(e[13]=n=>a.value.tmdbLanguage=n),placeholder:"请选择语言"},{default:t(()=>[l(C,{label:"简体中文",value:"zh-CN"}),l(C,{label:"繁体中文",value:"zh-TW"}),l(C,{label:"英语",value:"en-US"}),l(C,{label:"日语",value:"ja-JP"}),l(C,{label:"韩语",value:"ko-KR"})]),_:1},8,["modelValue"]),e[70]||(e[70]=o("div",{class:"form-tip"},"TMDB返回数据的语言",-1))]),_:1}),l(u,{label:"请求超时"},{default:t(()=>[l(c,{modelValue:a.value.tmdbTimeout,"onUpdate:modelValue":e[14]||(e[14]=n=>a.value.tmdbTimeout=n),min:3e3,max:3e4,step:1e3},null,8,["modelValue"]),e[71]||(e[71]=o("span",{style:{"margin-left":"10px"}},"毫秒",-1)),e[72]||(e[72]=o("div",{class:"form-tip"},"TMDB API请求的超时时间",-1))]),_:1}),l(u,{label:"自动匹配"},{default:t(()=>[l(I,{modelValue:a.value.tmdbAutoMatch,"onUpdate:modelValue":e[15]||(e[15]=n=>a.value.tmdbAutoMatch=n)},null,8,["modelValue"]),e[73]||(e[73]=o("div",{class:"form-tip"},"在115资源管理中自动搜索并匹配TMDB ID",-1))]),_:1}),l(u,{label:"测试TMDB连接"},{default:t(()=>[l(f,{onClick:X,loading:v.value.tmdb},{default:t(()=>[l(m,null,{default:t(()=>[l(B)]),_:1}),e[74]||(e[74]=d(" 测试TMDB服务 ",-1))]),_:1},8,["loading"])]),_:1})],64)):T("",!0)]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",Oe,[l(m,null,{default:t(()=>[l(z)]),_:1}),e[75]||(e[75]=o("span",null,"115网盘配置",-1))])]),default:t(()=>[l(M,{title:"115网盘说明",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[76]||(e[76]=[o("div",{style:{"font-size":"13px","line-height":"1.6"}},[o("p",null,"配置115网盘Cookie后，系统会优先从115资源库中匹配资源并自动转存。"),o("p",{style:{"margin-top":"4px"}},"如果TMDB ID在115资源表中找到匹配，将直接调用115转存API。")],-1)])]),_:1}),l(u,{label:"启用115转存"},{default:t(()=>[l(I,{modelValue:a.value.enable115Transfer,"onUpdate:modelValue":e[16]||(e[16]=n=>a.value.enable115Transfer=n)},null,8,["modelValue"]),e[77]||(e[77]=o("div",{class:"form-tip"},"启用后优先使用115资源库进行匹配和转存",-1))]),_:1}),a.value.enable115Transfer?(p(),k(U,{key:0},[l(u,{label:"115 Cookie"},{default:t(()=>[l(g,{modelValue:a.value.cookie115,"onUpdate:modelValue":e[17]||(e[17]=n=>a.value.cookie115=n),type:"textarea",rows:3,placeholder:"请输入115网盘的Cookie"},null,8,["modelValue"]),e[78]||(e[78]=o("div",{class:"form-tip"},[d(" 从浏览器开发者工具中获取115.com的Cookie "),o("a",{href:"https://115.com",target:"_blank"},"打开115网盘")],-1))]),_:1}),l(u,{label:"目标文件夹ID"},{default:t(()=>[l(g,{modelValue:a.value.targetFolderId115,"onUpdate:modelValue":e[18]||(e[18]=n=>a.value.targetFolderId115=n),placeholder:"0（根目录）"},null,8,["modelValue"]),e[79]||(e[79]=o("div",{class:"form-tip"},"转存到115网盘的目标文件夹ID，0表示根目录",-1))]),_:1}),l(u,{label:"测试115连接"},{default:t(()=>[l(f,{onClick:Z,loading:v.value.transfer115},{default:t(()=>[l(m,null,{default:t(()=>[l(B)]),_:1}),e[80]||(e[80]=d(" 测试115服务 ",-1))]),_:1},8,["loading"])]),_:1})],64)):T("",!0)]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",Ee,[l(m,null,{default:t(()=>[l(ie)]),_:1}),e[81]||(e[81]=o("span",null,"链接验证配置",-1))])]),default:t(()=>[l(u,{label:"启用链接验证"},{default:t(()=>[l(I,{modelValue:a.value.validateLinks,"onUpdate:modelValue":e[19]||(e[19]=n=>a.value.validateLinks=n)},null,8,["modelValue"]),e[82]||(e[82]=o("div",{class:"form-tip"},"通过实际转存测试验证链接是否有效（转存失败或404表示链接失效）",-1))]),_:1}),a.value.validateLinks?(p(),A(M,{key:0,title:"验证说明",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[...e[83]||(e[83]=[o("div",{style:{"font-size":"13px","line-height":"1.6"}},[o("p",null,"链接验证通过实际转存操作来检测链接有效性："),o("ul",{style:{margin:"8px 0","padding-left":"20px"}},[o("li",null,"✓ 转存成功 = 链接有效"),o("li",null,"✗ 转存失败/404 = 链接失效"),o("li",null,"有效链接额外加分：+10分")]),o("p",{style:{"margin-top":"8px",color:"#ff9500"}},[o("strong",null,"注意："),d("验证过程会实际调用转存API，请确保搜索服务已正确配置。 ")])],-1)])]),_:1})):T("",!0),a.value.validateLinks?(p(),k(U,{key:1},[l(u,{label:"验证超时"},{default:t(()=>[l(c,{modelValue:a.value.validationTimeout,"onUpdate:modelValue":e[20]||(e[20]=n=>a.value.validationTimeout=n),min:3e3,max:3e4,step:1e3},null,8,["modelValue"]),e[84]||(e[84]=o("span",{style:{"margin-left":"10px"}},"毫秒",-1)),e[85]||(e[85]=o("div",{class:"form-tip"},"单个链接验证的超时时间",-1))]),_:1}),l(u,{label:"最大验证数"},{default:t(()=>[l(c,{modelValue:a.value.maxValidationCount,"onUpdate:modelValue":e[21]||(e[21]=n=>a.value.maxValidationCount=n),min:5,max:50,step:5},null,8,["modelValue"]),e[86]||(e[86]=o("div",{class:"form-tip"},"最多验证前N个搜索结果（避免过多API调用）",-1))]),_:1})],64)):T("",!0)]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",Ke,[l(m,null,{default:t(()=>[l(re)]),_:1}),e[87]||(e[87]=o("span",null,"高级设置",-1))])]),default:t(()=>[l(u,{label:"缓存时间"},{default:t(()=>[l(c,{modelValue:a.value.cacheTime,"onUpdate:modelValue":e[22]||(e[22]=n=>a.value.cacheTime=n),min:0,max:3600,step:60},null,8,["modelValue"]),e[88]||(e[88]=o("span",{style:{"margin-left":"10px"}},"秒 (0=禁用缓存)",-1)),e[89]||(e[89]=o("div",{class:"form-tip"},"搜索结果和验证结果的缓存时间",-1))]),_:1}),l(u,{label:"最大结果数"},{default:t(()=>[l(c,{modelValue:a.value.maxResults,"onUpdate:modelValue":e[23]||(e[23]=n=>a.value.maxResults=n),min:10,max:100,step:10},null,8,["modelValue"]),e[90]||(e[90]=o("div",{class:"form-tip"},"每次搜索返回的最大结果数量",-1))]),_:1}),l(u,{label:"调试模式"},{default:t(()=>[l(I,{modelValue:a.value.debugMode,"onUpdate:modelValue":e[24]||(e[24]=n=>a.value.debugMode=n)},null,8,["modelValue"]),e[91]||(e[91]=o("div",{class:"form-tip"},"启用后会在控制台输出详细日志",-1))]),_:1}),l(u,{label:"自动选择最佳"},{default:t(()=>[l(I,{modelValue:a.value.autoSelectBest,"onUpdate:modelValue":e[25]||(e[25]=n=>a.value.autoSelectBest=n)},null,8,["modelValue"]),e[92]||(e[92]=o("div",{class:"form-tip"},"搜索后自动选择评分最高的资源",-1))]),_:1})]),_:1}),l(y,{class:"config-section"},{header:t(()=>[o("div",he,[l(m,null,{default:t(()=>[l(me)]),_:1}),e[93]||(e[93]=o("span",null,"评分权重配置",-1))])]),default:t(()=>[l(u,{label:"标题匹配度"},{default:t(()=>[l(w,{modelValue:a.value.weights.titleMatch,"onUpdate:modelValue":e[26]||(e[26]=n=>a.value.weights.titleMatch=n),min:0,max:50,"show-input":""},null,8,["modelValue"]),e[94]||(e[94]=o("div",{class:"form-tip"},"标题与电影名称的匹配程度 (默认: 40分)",-1))]),_:1}),l(u,{label:"分辨率"},{default:t(()=>[l(w,{modelValue:a.value.weights.resolution,"onUpdate:modelValue":e[27]||(e[27]=n=>a.value.weights.resolution=n),min:0,max:30,"show-input":""},null,8,["modelValue"]),e[95]||(e[95]=o("div",{class:"form-tip"},"视频分辨率质量 (默认: 20分)",-1))]),_:1}),l(u,{label:"文件大小"},{default:t(()=>[l(w,{modelValue:a.value.weights.fileSize,"onUpdate:modelValue":e[28]||(e[28]=n=>a.value.weights.fileSize=n),min:0,max:20,"show-input":""},null,8,["modelValue"]),e[96]||(e[96]=o("div",{class:"form-tip"},"文件大小合理性 (默认: 15分)",-1))]),_:1}),l(u,{label:"标签匹配"},{default:t(()=>[l(w,{modelValue:a.value.weights.tagMatch,"onUpdate:modelValue":e[29]||(e[29]=n=>a.value.weights.tagMatch=n),min:0,max:15,"show-input":""},null,8,["modelValue"]),e[97]||(e[97]=o("div",{class:"form-tip"},"标签与电影类型的匹配 (默认: 10分)",-1))]),_:1}),l(u,{label:"来源可信度"},{default:t(()=>[l(w,{modelValue:a.value.weights.sourceCredibility,"onUpdate:modelValue":e[30]||(e[30]=n=>a.value.weights.sourceCredibility=n),min:0,max:15,"show-input":""},null,8,["modelValue"]),e[98]||(e[98]=o("div",{class:"form-tip"},"资源来源的可信度 (默认: 10分)",-1))]),_:1}),l(u,{label:"时效性"},{default:t(()=>[l(w,{modelValue:a.value.weights.timeliness,"onUpdate:modelValue":e[31]||(e[31]=n=>a.value.weights.timeliness=n),min:0,max:10,"show-input":""},null,8,["modelValue"]),e[99]||(e[99]=o("div",{class:"form-tip"},"资源发布时间 (默认: 5分)",-1))]),_:1}),l(u,null,{default:t(()=>[l(f,{onClick:J,size:"small"},{default:t(()=>[l(m,null,{default:t(()=>[l(pe)]),_:1}),e[100]||(e[100]=d(" 恢复默认权重 ",-1))]),_:1}),o("span",Ne," 总分: "+S(N.value)+"分 ",1)]),_:1})]),_:1})]),_:1},8,["model"]),o("input",{ref_key:"fileInputRef",ref:L,type:"file",accept:".json",style:{display:"none"},onChange:H},null,544)])}}},He=be(je,[["__scopeId","data-v-3299375b"]]);export{He as default};
