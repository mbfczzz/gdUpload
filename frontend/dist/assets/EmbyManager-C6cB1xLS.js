import{_ as bl,a as I,o as kl,c as k,b as o,d as a,i as p,y as A,w as t,f as w,j as u,e as C,t as y,g as Ve,h as wl,R as Z,S as ee,u as wt,T as $t,Q as $l,E as m,k as ue}from"./index-D-xSYIE6.js";import{r as j}from"./request-BSyjQB9W.js";import{a as Tt,t as it,b as Tl}from"./subscribe-zOCTvdSk.js";import{g as Il}from"./smartSearchConfig-C2PzHA7y.js";import"./index-B9ygI19o.js";function Cl(){return j({url:"/emby/test",method:"get"})}function Sl(){return j({url:"/emby/server-info",method:"get"})}function xl(){return j({url:"/emby/libraries",method:"get"})}function zl(F,te=0,ce=50,ge=null,be=null){const ne={startIndex:te,limit:ce};return ge&&(ne.transferStatus=ge),be&&(ne.downloadStatus=be),j({url:`/emby/libraries/${F}/items/paged`,method:"get",params:ne})}function Ml(F){return j({url:`/emby/items/${F}`,method:"get"})}function Rl(F){return j({url:`/emby/series/${F}/episodes`,method:"get"})}function El(){return j({url:"/emby/genres",method:"get"})}function Bl(){return j({url:"/emby/tags",method:"get"})}function Dl(){return j({url:"/emby/studios",method:"get"})}function Al(F){return j({url:"/emby/search",method:"get",params:{keyword:F}})}function Ll(){return j({url:"/emby/sync",method:"post"})}function Fl(){return j({url:"/emby/cache/status",method:"get"})}function Vl(F){return j({url:`/emby/items/${F}/download-to-server`,method:"post"})}function Nl(F){return j({url:"/emby/batch-download-to-server",method:"post",data:F})}function Yl(){return j({url:"/emby/batch-download-progress",method:"get"})}function me(F){return j({url:"/transfer-history/save",method:"post",data:F})}function Ul(F){return j({url:`/transfer-history/item/${F}`,method:"get"})}function Pl(F){return j({url:"/transfer-history/batch-check",method:"post",data:F})}function Ce(F){return j({url:"/emby-download-history/batch-check",method:"post",data:F})}function jl(F,te){return j({url:"/emby-download-history/mark-status",method:"post",params:{embyItemId:F,status:te}})}function It(F,te,ce,ge){return j({url:"/resource115/smart-search",method:"get",params:{tmdbId:F,name:te,originalTitle:ce,year:ge}})}function Ct(F,te){return j({url:"/resource115/transfer",method:"post",params:{url:F,code:te}})}const Ol={class:"emby-container"},Kl={class:"header-content"},Wl={class:"header-left"},Hl={class:"header-actions"},Gl={class:"card-header"},Ql={key:1},Jl={class:"card-header"},ql={class:"library-name"},Xl={key:0},Zl={key:1,class:"text-muted"},ea={class:"card-header"},ta={class:"category-list"},la={key:0,class:"count"},aa={class:"card-header"},sa={class:"category-list"},na={key:0,class:"count"},oa={class:"card-header"},ra={class:"category-list"},ia={key:0,class:"count"},ua={class:"items-dialog-content"},ca={class:"dialog-toolbar"},da={style:{display:"flex","align-items":"center",gap:"12px"}},fa={style:{display:"flex","align-items":"center",gap:"12px"}},pa={class:"total-count"},ma={key:0,class:"episode-list"},ga={key:0,class:"loading-episodes"},ya={key:1,class:"episodes-container"},va={class:"episodes-header"},ha={class:"episodes-title"},_a={class:"episode-name"},ba={key:0},ka={key:1,class:"text-muted"},wa={key:0},$a={key:1,class:"text-muted"},Ta={class:"item-name"},Ia={key:1,class:"text-muted"},Ca={key:1,class:"text-muted"},Sa={key:1,class:"text-muted"},xa={class:"pagination-container"},za={key:0,class:"download-dialog-content"},Ma={style:{"font-size":"13px","line-height":"1.6"}},Ra={style:{"margin-top":"4px"}},Ea={key:0,class:"search-results"},Ba={key:0},Da={key:1},Aa={key:2},La={style:{display:"flex","align-items":"center",gap:"8px"}},Fa={style:{"margin-top":"4px"}},Va={key:1},Na={key:2,class:"selected-result"},Ya={class:"json-preview"},Ua={key:1},Pa={key:1},ja={key:1},Oa={key:1},Ka={key:0},Wa={key:1,class:"text-muted"},Ha={key:0},Ga={key:1,class:"text-muted"},Qa={key:0},Ja={key:1,class:"text-muted"},qa={key:0},Xa={key:1,class:"text-muted"},Za={key:1,class:"text-muted"},es={key:1,class:"text-muted"},ts={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ls={style:{"font-weight":"bold"}},as={__name:"EmbyManager",setup(F){const te=I(!1),ce=I(!1),ge=I(!1),be=I(!1),ne=I(!1),Ne=I(!1),Ye=I(!1),Ue=I(!1),Ze=I(!1),Se=I(!1),Q=I(null),xe=I(!0),ke=I([]),ze=I([]),Me=I([]),Re=I([]),Y=I([]),oe=I(null),E=I(null),Pe=I(""),Ee=I(""),je=I(""),St=I([]),ye=I({}),et=I({}),de=I(1),Te=I(50),tt=I(0),lt=I(!1),at=I(!1),ve=I(!1),st=I(!1),Oe=I([]),R=I(null),xt=I(""),zt=I(null);I(!1);const he=I(""),Ke=I(!1),re=I([]),fe=I(null),we=I(!1),ie=I([]),Mt=I(!1),nt=I(!1),Be=I(!0),We=I(!0),q=I({}),H=I({}),ot=l=>{const e=ie.value.find(i=>i.cloudType===l);return e||(console.warn(`æœªæ‰¾åˆ° cloudType=${l} çš„äº‘ç›˜é…ç½®`),null)},Rt=async()=>{try{const l=await Il();if(l.data&&Object.keys(l.data).length>0){l.data.cloudConfigs&&Array.isArray(l.data.cloudConfigs)&&l.data.cloudConfigs.length>0&&(ie.value=l.data.cloudConfigs),l.data.aiEnabled!==void 0&&(Be.value=l.data.aiEnabled),l.data.validateLinks!==void 0&&(We.value=l.data.validateLinks),console.log("ä»æ•°æ®åº“åŠ è½½æ™ºèƒ½æœç´¢é…ç½®:",l.data),console.log("äº‘ç›˜é…ç½®åˆ—è¡¨:",ie.value);return}}catch(l){console.error("ä»æ•°æ®åº“åŠ è½½é…ç½®å¤±è´¥:",l)}try{const l=localStorage.getItem("smartSearchConfig");if(l){const e=JSON.parse(l);e.cloudConfigs&&Array.isArray(e.cloudConfigs)&&e.cloudConfigs.length>0?ie.value=e.cloudConfigs:ie.value=[{name:"é˜¿é‡Œäº‘ç›˜",cloudType:e.cloudType||"channel_alipan",parentId:e.alipanParentId||"697f2333cd2704159fa446d8bc5077584838e3dc",remark:""}],e.aiEnabled!==void 0&&(Be.value=e.aiEnabled),e.validateLinks!==void 0&&(We.value=e.validateLinks),console.log("ä»æœ¬åœ°åŠ è½½æ™ºèƒ½æœç´¢é…ç½®:",e),console.log("äº‘ç›˜é…ç½®åˆ—è¡¨:",ie.value)}}catch(l){console.error("åŠ è½½æ™ºèƒ½æœç´¢é…ç½®å¤±è´¥:",l)}},Et=async()=>{te.value=!0;try{(await Cl()).data?(m.success("Embyè¿æ¥æˆåŠŸ"),await ut()):m.error("Embyè¿æ¥å¤±è´¥")}catch(l){m.error("è¿æ¥æµ‹è¯•å¤±è´¥: "+l.message)}finally{te.value=!1}},ut=async()=>{try{const l=await Sl();Q.value=l.data,await Bt()}catch(l){console.error("åŠ è½½æœåŠ¡å™¨ä¿¡æ¯å¤±è´¥:",l)}},Bt=async()=>{try{const l=await Fl();xe.value=l.data.hasCache,xe.value||m.warning({message:'æ•°æ®åº“ä¸­æš‚æ— æ•°æ®ï¼Œè¯·å…ˆç‚¹å‡»"åŒæ­¥æ‰€æœ‰æ•°æ®"æŒ‰é’®ï¼',duration:5e3,showClose:!0})}catch(l){console.error("æ£€æŸ¥ç¼“å­˜çŠ¶æ€å¤±è´¥:",l)}},De=async()=>{be.value=!0;try{const l=await xl();ke.value=l.data}catch(l){m.error("åŠ è½½åª’ä½“åº“å¤±è´¥: "+l.message)}finally{be.value=!1}},He=async()=>{Ne.value=!0;try{const l=await El();ze.value=l.data}catch(l){m.error("åŠ è½½ç±»å‹å¤±è´¥: "+l.message)}finally{Ne.value=!1}},Ge=async()=>{Ye.value=!0;try{const l=await Bl();Me.value=l.data}catch(l){m.error("åŠ è½½æ ‡ç­¾å¤±è´¥: "+l.message)}finally{Ye.value=!1}},Qe=async()=>{Ue.value=!0;try{const l=await Dl();Re.value=l.data}catch(l){m.error("åŠ è½½å·¥ä½œå®¤å¤±è´¥: "+l.message)}finally{Ue.value=!1}},Dt=async l=>{oe.value=l,de.value=1,lt.value=!0,await _e()},At=async(l,e)=>{var r;if(l.type!=="Series")return;if(e.some(n=>n.id===l.id)){if(ye.value[l.id]){const n=ye.value[l.id].map(c=>c.id);if(n.length>0)try{const c=await Ce(n);c.data&&(Object.assign(H.value,c.data),console.log(`åˆ·æ–°å‰§é›†ä¸‹è½½çŠ¶æ€å®Œæˆï¼Œå…± ${n.length} é›†`))}catch(c){console.error("åˆ·æ–°å‰§é›†ä¸‹è½½çŠ¶æ€å¤±è´¥:",c)}return}et.value[l.id]=!0;try{const n=await Rl(l.id);if(ye.value[l.id]=n.data||[],console.log(`åŠ è½½ç”µè§†å‰§ [${l.name}] çš„å‰§é›†ï¼Œå…± ${((r=n.data)==null?void 0:r.length)||0} é›†`),n.data&&n.data.length>0){const c=n.data.map(f=>f.id);try{const f=await Ce(c);f.data&&(Object.assign(H.value,f.data),console.log(`åŠ è½½å‰§é›†ä¸‹è½½çŠ¶æ€å®Œæˆï¼Œå…± ${c.length} é›†`))}catch(f){console.error("åŠ è½½å‰§é›†ä¸‹è½½çŠ¶æ€å¤±è´¥:",f)}}}catch(n){console.error("åŠ è½½å‰§é›†å¤±è´¥:",n),m.error("åŠ è½½å‰§é›†å¤±è´¥"),ye.value[l.id]=[]}finally{et.value[l.id]=!1}}},Lt=l=>{if(!l)return"-";const e=Math.round(l/6e8);if(e<60)return`${e}åˆ†é’Ÿ`;const i=Math.floor(e/60),r=e%60;return`${i}å°æ—¶${r}åˆ†é’Ÿ`},_e=async()=>{if(oe.value){ne.value=!0;try{const l=(de.value-1)*Te.value,e=await zl(oe.value.id,l,Te.value,Ee.value||null,je.value||null);if(Y.value=e.data.items,tt.value=e.data.totalCount,oe.value.itemCount===void 0||oe.value.itemCount===null){const i=ke.value.findIndex(r=>r.id===oe.value.id);i!==-1&&(ke.value[i].itemCount=e.data.totalCount,oe.value.itemCount=e.data.totalCount)}await Ft(),await Vt()}catch(l){m.error("åŠ è½½åª’ä½“é¡¹å¤±è´¥: "+l.message)}finally{ne.value=!1}}},Ft=async()=>{if(!(!Y.value||Y.value.length===0))try{const l=Y.value.map(i=>i.id),e=await Pl(l);e.data&&(q.value=e.data,console.log("=== è½¬å­˜çŠ¶æ€åŠ è½½å®Œæˆ ==="),console.log("çŠ¶æ€æ˜ å°„:",q.value),console.log("ç¤ºä¾‹æ•°æ®:",Object.entries(q.value).slice(0,5)))}catch(l){console.error("åŠ è½½è½¬å­˜çŠ¶æ€å¤±è´¥:",l)}},Vt=async()=>{if(!(!Y.value||Y.value.length===0))try{const l=Y.value.map(i=>i.id),e=await Ce(l);e.data&&(H.value=e.data,console.log("=== ä¸‹è½½çŠ¶æ€åŠ è½½å®Œæˆ ==="),console.log("çŠ¶æ€æ˜ å°„:",H.value),console.log("ç¤ºä¾‹æ•°æ®:",Object.entries(H.value).slice(0,5)))}catch(l){console.error("åŠ è½½ä¸‹è½½çŠ¶æ€å¤±è´¥:",l)}},Nt=l=>{de.value=l,_e()},Yt=()=>{console.log("=== åº”ç”¨è½¬å­˜çŠ¶æ€ç­›é€‰ ==="),console.log("ç­›é€‰æ¡ä»¶:",Ee.value),de.value=1,_e()},Ut=()=>{console.log("=== åº”ç”¨ä¸‹è½½çŠ¶æ€ç­›é€‰ ==="),console.log("ç­›é€‰æ¡ä»¶:",je.value),de.value=1,_e()},Pt=l=>{Te.value=l,de.value=1,_e()},jt=async()=>{if(!Pe.value.trim()){await _e();return}ne.value=!0;try{const l=await Al(Pe.value);Y.value=l.data.filter(e=>e.parentId===oe.value.id||e.id===oe.value.id)}catch(l){m.error("æœç´¢å¤±è´¥: "+l.message)}finally{ne.value=!1}},Ot=async l=>{var e;console.log("æŸ¥çœ‹è¯¦æƒ… - itemId:",l.id,"name:",l.name,"type:",l.type);try{const i=await Ml(l.id);E.value=i.data,at.value=!0}catch(i){console.error("åŠ è½½è¯¦æƒ…å¤±è´¥:",i);let r="åŠ è½½è¯¦æƒ…å¤±è´¥";((e=i.response)==null?void 0:e.status)===404?r=`è¯¥åª’ä½“é¡¹ä¸å­˜åœ¨æˆ–æ— æƒè®¿é—®ï¼ˆID: ${l.id}ï¼‰`:i.message&&(r="åŠ è½½è¯¦æƒ…å¤±è´¥: "+i.message),m.error(r)}},Kt=async l=>{try{const e=await Ul(l.id);Oe.value=e.data||[],st.value=!0}catch(e){console.error("åŠ è½½è½¬å­˜å†å²å¤±è´¥:",e),m.error("åŠ è½½è½¬å­˜å†å²å¤±è´¥: "+e.message)}},ct=async()=>{var l;try{await ue.confirm("æ­¤æ“ä½œå°†ä¸€æ¬¡æ€§å…¨é‡åŒæ­¥æ‰€æœ‰åª’ä½“åº“æ•°æ®åˆ°æ•°æ®åº“ï¼Œå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),ce.value=!0;const e=await Ll();e.data.success?(m.success({message:`åŒæ­¥å®Œæˆï¼å…± ${e.data.totalLibraries} ä¸ªåª’ä½“åº“ï¼Œ${e.data.totalItems} ä¸ªåª’ä½“é¡¹ï¼Œè€—æ—¶ ${e.data.duration}`,duration:5e3}),xe.value=!0,await De(),await He(),await Ge(),await Qe()):e.data.failedLibraries>0?(m.warning({message:`åŒæ­¥å®Œæˆï¼Œä½†æœ‰ ${e.data.failedLibraries} ä¸ªåª’ä½“åº“å¤±è´¥ã€‚æˆåŠŸ: ${e.data.successLibraries} ä¸ªï¼Œåª’ä½“é¡¹: ${e.data.totalItems} ä¸ªã€‚å¤±è´¥çš„åª’ä½“åº“: ${(l=e.data.failedLibraryNames)==null?void 0:l.join(", ")}`,duration:1e4,showClose:!0}),xe.value=!0,await De(),await He(),await Ge(),await Qe()):m.error("åŒæ­¥å¤±è´¥: "+(e.data.error||e.data.message))}catch(e){e!=="cancel"&&m.error("åŒæ­¥å¤±è´¥: "+e.message)}finally{ce.value=!1}},Wt=async()=>{try{await ue.confirm("æ­¤æ“ä½œå°†æ¸…ç©ºæ‰€æœ‰Embyæ•°æ®ç¼“å­˜ï¼Œä¸‹æ¬¡è®¿é—®æ—¶å°†ä»EmbyæœåŠ¡å™¨é‡æ–°è·å–æ•°æ®ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ","è­¦å‘Š",{confirmButtonText:"ç¡®å®šæ¸…ç©º",cancelButtonText:"å–æ¶ˆ",type:"warning"}),ge.value=!0;const l=await fetch("/api/emby/cache/clear",{method:"POST",headers:{"Content-Type":"application/json"}}).then(e=>e.json());l.code===200?(m.success("ç¼“å­˜å·²æ¸…ç©ºï¼Œä¸‹æ¬¡è®¿é—®å°†ä»EmbyæœåŠ¡å™¨è·å–æœ€æ–°æ•°æ®"),ke.value=[],Y.value=[],ze.value=[],Me.value=[],Re.value=[]):m.error("æ¸…ç©ºç¼“å­˜å¤±è´¥: "+l.message)}catch(l){l!=="cancel"&&m.error("æ¸…ç©ºç¼“å­˜å¤±è´¥: "+l.message)}finally{ge.value=!1}},rt=l=>{if(!l)return"-";const e=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(l)/Math.log(1024));return(l/Math.pow(1024,i)).toFixed(2)+" "+e[i]},Ht=l=>l?(l/1e6).toFixed(2)+" Mbps":"-",Je=l=>{if(!l)return"";let e=l;return e=e.replace(/[\u0022\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u201C\u201D\u201E\u201F\u2032\u2033\u2034\u2035\u2036\u2037\u2039\u203A\u275B\u275C\u275D\u275E\u276E\u276F\u2E42\u301D\u301E\u301F\uFF02\uFF07\u00AB\u00BB\u3008\u3009\u300A\u300B\u300C\u300D\u300E\u300F\u3010\u3011]/g,""),e=e.replace(/\([^)]*\)/g," "),e=e.replace(/\[[^\]]*\]/g," "),e=e.replace(/\{[^}]*\}/g," "),e=e.replace(/ï¼ˆ[^ï¼‰]*ï¼‰/g," "),e=e.replace(/ã€[^ã€‘]*ã€‘/g," "),e=e.replace(/ã€”[^ã€•]*ã€•/g," "),e=e.replace(/ã€ˆ[^ã€‰]*ã€‰/g," "),e=e.replace(/ã€Š[^ã€‹]*ã€‹/g," "),e=e.replace(/ï¹[^ï¹]*ï¹/g," "),e=e.replace(/ï¹™[^ï¹š]*ï¹š/g," "),e=e.replace(/[,ï¼Œ.ã€‚:ï¼š;ï¼›!ï¼?ï¼Ÿã€]/g," "),e=e.replace(/[-â€“â€”_~Â·â€¢]/g," "),e=e.replace(/[/\\|]/g," "),e=e.replace(/[&ï¼†@ï¼ #ï¼ƒ$ï¼„%ï¼…^ï¼¾*ï¼Š+=ï¼‹ï¼<>ï¼œï¼]/g," "),e=e.replace(/[\u{1F300}-\u{1F9FF}]/gu,""),e=e.replace(/[\u{2600}-\u{26FF}]/gu,""),e=e.replace(/[\u{2700}-\u{27BF}]/gu,""),e=e.replace(/\s+/g," ").trim(),console.log("æ¸…ç†å…³é”®è¯ - åŸå§‹:",l),console.log("æ¸…ç†å…³é”®è¯ - ç»“æœ:",e),e},Gt=async l=>{R.value=l,xt.value="",zt.value=null,re.value=[],fe.value=null;let e=null;l.providerIds&&l.providerIds.Tmdb?(e=l.providerIds.Tmdb,console.log("æå–åˆ° TMDB ID:",e)):console.log("æœªæ‰¾åˆ° TMDB ID");try{m.info("æ­£åœ¨ä»115èµ„æºåº“æœç´¢åŒ¹é…èµ„æº...");const r=await It(e,l.name,l.originalTitle,l.productionYear);if(r.data){const n=r.data;m.success(`æ‰¾åˆ°åŒ¹é…èµ„æº: ${n.name}`),await nl(n);return}else m.info("115èµ„æºåº“ä¸­æœªæ‰¾åˆ°åŒ¹é…èµ„æºï¼Œå°†ä½¿ç”¨æœç´¢å¼•æ“æœç´¢")}catch(r){console.error("æœç´¢115èµ„æºå¤±è´¥:",r),m.warning("115èµ„æºåº“æœç´¢å¤±è´¥ï¼Œå°†ä½¿ç”¨æœç´¢å¼•æ“æœç´¢")}let i=l.originalTitle||l.name;i=Je(i),console.log("åŸå§‹å…³é”®è¯:",l.originalTitle||l.name),console.log("æ¸…ç†åå…³é”®è¯:",i),he.value=i,ve.value=!0,Ae()},dt=async l=>{try{let e="";l.type==="Series"?e=`ç¡®å®šè¦ä¸‹è½½ç”µè§†å‰§ "${l.name}" çš„æ‰€æœ‰å‰§é›†å—ï¼Ÿ

æ–‡ä»¶å°†ä¿å­˜åˆ°æœåŠ¡å™¨çš„ /data/emby/${l.name}/ ç›®å½•ä¸‹ã€‚

ä¸‹è½½å°†åœ¨åå°è¿›è¡Œï¼Œè¯·æŸ¥çœ‹åç«¯æ—¥å¿—äº†è§£è¿›åº¦ã€‚`:l.type==="Episode"?e=`ç¡®å®šè¦ä¸‹è½½å‰§é›† "${l.name}" å—ï¼Ÿ

æ–‡ä»¶å°†ä¿å­˜åˆ°æœåŠ¡å™¨çš„ /data/emby ç›®å½•ä¸‹ã€‚

ä¸‹è½½å°†åœ¨åå°è¿›è¡Œï¼Œè¯·æŸ¥çœ‹åç«¯æ—¥å¿—äº†è§£è¿›åº¦ã€‚`:e=`ç¡®å®šè¦ä¸‹è½½ "${l.name}" åˆ°æœåŠ¡å™¨å—ï¼Ÿ

æ–‡ä»¶å°†ä¿å­˜åˆ°æœåŠ¡å™¨çš„ /data/emby ç›®å½•ä¸‹ã€‚

ä¸‹è½½å°†åœ¨åå°è¿›è¡Œï¼Œè¯·æŸ¥çœ‹åç«¯æ—¥å¿—äº†è§£è¿›åº¦ã€‚`,await ue.confirm(e,"ç¡®è®¤ä¸‹è½½",{confirmButtonText:"ç¡®å®šä¸‹è½½",cancelButtonText:"å–æ¶ˆ",type:"warning"});try{const i=await Vl(l.id);if(i.data&&i.data.status==="started"){m.success({message:"ä¸‹è½½ä»»åŠ¡å·²å¯åŠ¨ï¼ä¸‹è½½å®Œæˆåå°†è‡ªåŠ¨åˆ·æ–°çŠ¶æ€ã€‚",duration:5e3});let r=0;const n=30,c=setInterval(async()=>{if(r++,Y.value&&Y.value.length>0){const f=Y.value.map(v=>v.id);try{const v=await Ce(f);v.data&&Object.assign(H.value,v.data)}catch(v){console.error("åˆ·æ–°ä¸‹è½½çŠ¶æ€å¤±è´¥:",v)}}r>=n&&clearInterval(c)},1e4)}else m.error("å¯åŠ¨ä¸‹è½½å¤±è´¥")}catch(i){console.error("å¯åŠ¨ä¸‹è½½å¤±è´¥:",i),m.error("å¯åŠ¨ä¸‹è½½å¤±è´¥: "+(i.message||"æœªçŸ¥é”™è¯¯"))}}catch{}},Qt=async l=>{try{await ue.confirm(`ç¡®å®šè¦å°† "${l.name}" æ ‡è®°ä¸ºå·²ä¸‹è½½å—ï¼Ÿ`,"ç¡®è®¤æ ‡è®°",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"});try{const e=await jl(l.id,"success");e.code===200?(m.success("æ ‡è®°æˆåŠŸ"),H.value[l.id]="success"):m.error("æ ‡è®°å¤±è´¥: "+(e.message||"æœªçŸ¥é”™è¯¯"))}catch(e){console.error("æ ‡è®°å¤±è´¥:",e),m.error("æ ‡è®°å¤±è´¥: "+(e.message||"æœªçŸ¥é”™è¯¯"))}}catch{}},Ae=async()=>{var l,e,i,r;if(!he.value){m.warning("è¯·è¾“å…¥æœç´¢å…³é”®è¯");return}Ke.value=!0,re.value=[],fe.value=null;try{const n=await Tt(he.value,!0);console.log("=== æœç´¢è¿”å›åŸå§‹ç»“æœ ==="),console.log("å®Œæ•´å“åº”:",n),console.log("res.data:",n.data),console.log("res.data.channels:",(l=n.data)==null?void 0:l.channels),console.log("res.data.channel_info_list:",(e=n.data)==null?void 0:e.channel_info_list);let c=[];const f=((i=n.data)==null?void 0:i.channels)||((r=n.data)==null?void 0:r.channel_info_list);if(f&&Array.isArray(f)?(console.log(`æ‰¾åˆ° ${f.length} ä¸ªé¢‘é“`),f.forEach((v,x)=>{const S=v.channelInfo||{};console.log(`
=== é¢‘é“ ${x+1}: ${S.name||"æœªçŸ¥"} ===`),v.messages&&Array.isArray(v.messages)&&(console.log(`  - messages æ•°ç»„é•¿åº¦: ${v.messages.length}`),v.messages.forEach((g,_)=>{var $,D;console.log(`    æ¶ˆæ¯ ${_+1}:`,{messageId:g.messageId,title:($=g.title)==null?void 0:$.substring(0,50),text:(D=g.text)==null?void 0:D.substring(0,50),cloudLinks:g.cloudLinks}),g.cloudLinks&&g.cloudLinks.length>0&&g.cloudLinks.forEach((z,b)=>{const d=g.title||g.text,V=qe(d);console.log(`      é“¾æ¥ ${b+1}: ${z}`),console.log(`      æå–çš„æ ‡é¢˜: ${V}`),c.push({id:`${g.messageId}-${b}`,messageId:g.messageId,title:V,rawTitle:d,description:g.text||g.content,url:z,link:z,share_url:z,size:pt(g.text||g.content),resolution:mt(g.text||g.content),tags:g.tags||[],image:g.image,cloudType:g.cloudType,channelId:g.channelId||S.id,channelName:S.name||"æœªçŸ¥æ¥æº"})})})),v.list&&Array.isArray(v.list)&&(console.log(`  - list æ•°ç»„é•¿åº¦: ${v.list.length}`),v.list.forEach((g,_)=>{var $,D;console.log(`    é¡¹ç›® ${_+1}:`,{messageId:g.messageId,title:($=g.title)==null?void 0:$.substring(0,50),content:(D=g.content)==null?void 0:D.substring(0,50),cloudLinks:g.cloudLinks}),g.cloudLinks&&g.cloudLinks.length>0&&g.cloudLinks.forEach((z,b)=>{const d=g.title||g.content,V=qe(d);console.log(`      é“¾æ¥ ${b+1}: ${z}`),console.log(`      æå–çš„æ ‡é¢˜: ${V}`),c.push({id:`${g.messageId}-${b}`,messageId:g.messageId,title:V,rawTitle:d,description:g.content||g.title,url:z,link:z,share_url:z,size:pt(g.content||g.title),resolution:mt(g.content||g.title),tags:g.tags||[],image:g.image,cloudType:g.cloudType,channelId:g.channelId||S.id,channelName:S.name||"æœªçŸ¥æ¥æº",pubDate:g.pubDate})})}))})):Array.isArray(n)?(console.log("å“åº”æ˜¯æ•°ç»„æ ¼å¼"),c=n):n.data&&Array.isArray(n.data)?(console.log("res.data æ˜¯æ•°ç»„æ ¼å¼"),c=n.data):n.results&&Array.isArray(n.results)?(console.log("res.results æ˜¯æ•°ç»„æ ¼å¼"),c=n.results):console.error("æ— æ³•è¯†åˆ«çš„æ•°æ®æ ¼å¼:",n),console.log(`
=== æœ€ç»ˆç»“æœ ===`),console.log(`æ€»å…±æå–äº† ${c.length} ä¸ªç»“æœ`),console.log("å‰3ä¸ªç»“æœ:",c.slice(0,3)),c.length>0&&(c=ft(c,he.value,R.value),console.log("æ’åºåå‰3ä¸ªç»“æœ:",c.slice(0,3))),Be.value&&c.length>0&&await Jt(c),re.value=c,c.length>0){const x=c.filter(S=>S.matchScore>=30);if(x.length===0){m.warning("æœªæ‰¾åˆ°ç¬¦åˆè¦æ±‚çš„èµ„æºï¼ˆæ‰€æœ‰ç»“æœè¯„åˆ†è¿‡ä½ï¼‰");return}console.log(`
=== ç­›é€‰ç»“æœ ===`),console.log(`åŸå§‹ç»“æœ: ${c.length} ä¸ª`),console.log(`åˆæ ¼ç»“æœ: ${x.length} ä¸ªï¼ˆè¯„åˆ†â‰¥30ï¼‰`),m.success(`æ‰¾åˆ° ${x.length} ä¸ªåˆæ ¼ç»“æœï¼Œå‡†å¤‡è‡ªåŠ¨è½¬å­˜`),await sl(x)}else m.warning("æœªæ‰¾åˆ°æœç´¢ç»“æœ")}catch(n){console.error("æœç´¢å¤±è´¥:",n),re.value=[]}finally{Ke.value=!1}},Jt=async l=>{console.log(`
=== å¼€å§‹AIæ™ºèƒ½ç­›é€‰ ===`),nt.value=!0;try{const e={name:R.value.name,originalTitle:R.value.originalTitle,productionYear:R.value.productionYear,communityRating:R.value.communityRating,genres:R.value.genres,overview:R.value.overview},i=l.slice(0,10).map(n=>{var c;return{id:n.id,title:n.title,size:n.size,resolution:n.resolution,tags:n.tags,description:(c=n.description)==null?void 0:c.substring(0,200),matchScore:n.matchScore,isValid:n.isValid,hasFiles:n.hasFiles}});console.log("å‘é€ç»™AIçš„æ•°æ®:",{movieInfo:e,resourceCount:i.length});const r=await Tl(e,i);if(console.log("AIç­›é€‰ç»“æœ:",r),r.data&&r.data.title_match===!1){console.log("AIåˆ¤æ–­: æ‰€æœ‰èµ„æºéƒ½ä¸åŒ¹é…"),m.warning(`AIåˆ¤æ–­: ${r.data.reason}`),l.length=0;return}if(r.data&&r.data.best_resource_id){const n=r.data.best_resource_id,c=l.find(f=>f.id===n);if(c){c.aiRecommended=!0,c.aiReason=r.data.reason,c.matchScore+=15,c.matchReasons.push("AIæ¨è: +15åˆ†"),console.log("AIæ¨èèµ„æº:",c.title),console.log("æ¨èç†ç”±:",r.data.reason);const f=l.indexOf(c);f>0&&(l.splice(f,1),l.unshift(c))}}}catch(e){console.error("AIç­›é€‰å¤±è´¥:",e),m.warning("AIç­›é€‰æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œä½¿ç”¨è§„åˆ™ç­›é€‰")}finally{nt.value=!1}},ft=(l,e,i)=>{var c,f;console.log(`
=== å¼€å§‹æ™ºèƒ½æ’åº ===`),console.log("æœç´¢å…³é”®è¯:",e),console.log("ç”µå½±ä¿¡æ¯:",i);let r={titleMatch:40,resolution:20,fileSize:15,tagMatch:10,sourceCredibility:10,timeliness:5};try{const v=localStorage.getItem("smartSearchConfig");if(v){const x=JSON.parse(v);x.weights&&(r=x.weights,console.log("ä½¿ç”¨è‡ªå®šä¹‰æƒé‡:",r))}}catch(v){console.error("åŠ è½½æƒé‡é…ç½®å¤±è´¥:",v)}const n=l.map(v=>{let x=0;const S=[],g=qt(v.title,e,i,r.titleMatch);x+=g,g>0&&S.push(`æ ‡é¢˜åŒ¹é…: ${g.toFixed(1)}åˆ†`);const _=Xt(v.resolution,v.description,r.resolution);x+=_,_>0&&S.push(`åˆ†è¾¨ç‡: ${_.toFixed(1)}åˆ†`);const $=Zt(v.size,r.fileSize);x+=$,$>0&&S.push(`æ–‡ä»¶å¤§å°: ${$.toFixed(1)}åˆ†`);const D=el(v.tags,i,r.tagMatch);x+=D,D>0&&S.push(`æ ‡ç­¾åŒ¹é…: ${D.toFixed(1)}åˆ†`);const z=tl(v.channelName,v.cloudType,r.sourceCredibility);x+=z,z>0&&S.push(`æ¥æº: ${z.toFixed(1)}åˆ†`);const b=ll(v.pubDate,r.timeliness);return x+=b,b>0&&S.push(`æ—¶æ•ˆæ€§: ${b.toFixed(1)}åˆ†`),console.log(`
èµ„æº: ${v.title}`),console.log(`æ€»åˆ†: ${x.toFixed(1)}`),console.log(`è¯„åˆ†è¯¦æƒ…: ${S.join(", ")}`),{...v,matchScore:x,matchReasons:S}});return n.sort((v,x)=>x.matchScore-v.matchScore),console.log(`
=== æ’åºå®Œæˆ ===`),console.log("æœ€ä½³åŒ¹é…:",(c=n[0])==null?void 0:c.title,"å¾—åˆ†:",(f=n[0])==null?void 0:f.matchScore.toFixed(1)),n},qt=(l,e,i,r=40)=>{let n=0;const c=l.toLowerCase(),f=e.toLowerCase();if(c.includes(f))n+=r;else{const v=f.split(""),x=v.filter(S=>c.includes(S));n+=x.length/v.length*(r*.75)}if(i!=null&&i.originalTitle){const v=i.originalTitle.toLowerCase();c.includes(v)&&(n+=r*.25)}return Math.min(n,r)},Xt=(l,e,i=20)=>{const n=((l||"")+" "+(e||"")).toLowerCase();return n.includes("4k")||n.includes("2160p")?i:n.includes("remux")||n.includes("è“å…‰åŸç›˜")?i*.9:n.includes("1080p")||n.includes("bluray")?i*.75:n.includes("720p")?i*.5:n.includes("480p")?i*.25:0},Zt=(l,e=15)=>{if(!l||l==="-"||l==="N")return 0;const i=l.match(/(\d+\.?\d*)\s*(GB|MB|TB)/i);if(!i)return 0;const r=parseFloat(i[1]),n=i[2].toUpperCase();let c=r;return n==="MB"?c=r/1024:n==="TB"&&(c=r*1024),c>=10&&c<=50?e:c>=5&&c<=80?e*.67:c>=2&&c<=100?e*.33:0},el=(l,e,i=10)=>{if(!l||l.length===0)return 0;let r=0;const n=["#ç”µå½±","#movie","#å‰§æƒ…","#åŠ¨ä½œ","#å–œå‰§","#ç§‘å¹»"];l.some(x=>n.some(S=>x.toLowerCase().includes(S.toLowerCase())))&&(r+=i*.5);const f=["#è“å…‰","#é«˜æ¸…","#4k","#remux","#bluray"];return l.some(x=>f.some(S=>x.toLowerCase().includes(S.toLowerCase())))&&(r+=i*.5),Math.min(r,i)},tl=(l,e,i=10)=>{let r=i*.5;return e==="channel_alipan"&&(r+=i*.3),["ali-01","å¤©ç¿¼äº‘ç›˜","shareAliyun"].includes(l)&&(r+=i*.2),Math.min(r,i)},ll=(l,e=5)=>{if(!l)return 0;try{const i=new Date(l),n=(new Date-i)/(1e3*60*60*24);if(n<=30)return e;if(n<=90)return e*.6;if(n<=180)return e*.2}catch(i){console.error("è§£æå‘å¸ƒæ—¶é—´å¤±è´¥:",i)}return 0},qe=l=>{if(!l)return"æœªçŸ¥æ ‡é¢˜";if(!l.includes(`
`)&&l.length<100)return l.trim();l=l.replace(/https?:\/\/[^\s]+/g,"");const e=l.split(`
`).map(r=>r.trim()).filter(r=>r.length>0);for(let r=0;r<Math.min(5,e.length);r++){const n=e[r];if(!(n.includes("æœ¬ç‰‡")||n.includes("æè¿°ï¼š")||n.includes("ç®€ä»‹ï¼š")||n.includes("é“¾æ¥ï¼š")||n.includes("ğŸ“")||n.includes("ğŸ·")||n.includes("ğŸ‰")||n.includes("âš ï¸")||n.includes("ğŸ“¢")||n.includes("ğŸ‘¥")||n.includes("ğŸ¤–")||n.startsWith("å¤§å°")||n.startsWith("æ ‡ç­¾")||n.startsWith("æ¥è‡ª")||n.startsWith("ç‰ˆæƒ")||n.startsWith("é¢‘é“")||n.startsWith("ç¾¤ç»„")||n.startsWith("æŠ•ç¨¿"))&&!(n.length<2)&&n.length>=2){let c=n.replace(/^åç§°[ï¼š:]\s*/g,"").replace(/^æ ‡é¢˜[ï¼š:]\s*/g,"").replace(/\s*\(\d{4}\)\s*/g," ").replace(/\s*ï¼ˆ\d{4}ï¼‰\s*/g," ").trim();if(c.length>60){const f=c.substring(0,60).lastIndexOf(" ");f>30?c=c.substring(0,f)+"...":c=c.substring(0,60)+"..."}return c}}const i=e[0]||"æœªçŸ¥æ ‡é¢˜";return i.substring(0,60)+(i.length>60?"...":"")},pt=l=>{if(!l)return"-";const e=[/ğŸ“\s*å¤§å°[ï¼š:]\s*([^\n]+)/,/å¤§å°[ï¼š:]\s*([^\n]+)/,/(\d+\.?\d*\s*[KMGT]B)/i,/\((\d+\.?\d*\s*[KMGT]B)\)/i];for(const i of e){const r=l.match(i);if(r)return r[1].trim()}return"-"},mt=l=>{if(!l)return null;const e=["4K","2160p","1080p","720p","480p","REMUX","BluRay","Blu-ray","WEB-DL","WEBRip","è“å…‰","è“å…‰åŸç›˜","è¶…æ¸…","é«˜æ¸…","æ ‡æ¸…","HDR","SDR","Dolby","æœæ¯”"];for(const i of e)if(l.includes(i))return i;return null},al=l=>{fe.value=l},sl=async(l,e=null)=>{var x,S,g,_;const i=e||Math.min(l.length,10);console.log(`
=== å¼€å§‹è‡ªåŠ¨è½¬å­˜ ===`),console.log(`å€™é€‰èµ„æºæ•°: ${l.length}`),console.log(`æœ€å¤šå°è¯•: ${i} æ¬¡`);const r={};l.forEach($=>{const D=$.cloudType;r[D]||(r[D]=[]),r[D].push($)}),console.log(`
=== äº‘ç›˜èµ„æºåˆ†å¸ƒ ===`),Object.keys(r).forEach($=>{console.log(`${$}: ${r[$].length} ä¸ª`)});const n=ie.value.filter($=>r[$.cloudType]).sort(($,D)=>($.priority||999)-(D.priority||999));console.log(`
=== äº‘ç›˜ä¼˜å…ˆçº§æ’åº ===`),n.forEach(($,D)=>{console.log(`${D+1}. ${$.cloudType} (ä¼˜å…ˆçº§: ${$.priority||"æœªè®¾ç½®"}) - ${r[$.cloudType].length} ä¸ªèµ„æº`)});const c=[],f={};for(n.forEach($=>{f[$.cloudType]=0});c.length<i;){let $=!1;for(const D of n){const z=D.cloudType,b=r[z];if(f[z]<b.length&&(c.push(b[f[z]++]),$=!0,c.length>=i))break}if(!$)break}console.log(`
=== ä¼˜å…ˆçº§æ’åºå ===`),c.slice(0,10).forEach(($,D)=>{var z;console.log(`${D+1}. [${$.cloudType}] ${$.title.substring(0,50)} - è¯„åˆ†: ${(z=$.matchScore)==null?void 0:z.toFixed(1)}`)}),we.value=!0;const v=[];try{let $=0,D=null;for(let z=0;z<c.length&&$<i;z++){const b=c[z];console.log(`
--- æ£€æŸ¥èµ„æº ${z+1}/${c.length} ---`),console.log(`èµ„æº: ${b.title}`),console.log(`è¯„åˆ†: ${(x=b.matchScore)==null?void 0:x.toFixed(1)}`),console.log(`cloudType: ${b.cloudType}`);const d=b.url||b.link||b.share_url;if(!d){console.log("âœ— è·³è¿‡: æ²¡æœ‰æœ‰æ•ˆé“¾æ¥");continue}const V=ot(b.cloudType);if(!V){console.log(`âœ— è·³è¿‡: æœªé…ç½® ${b.cloudType}`);continue}if(!V.parentId){console.log(`âœ— è·³è¿‡: ${V.name} æœªè®¾ç½®ç›®å½•ID`);continue}$++,console.log(`
>>> å¼€å§‹ç¬¬ ${$} æ¬¡è½¬å­˜å°è¯• <<<`),console.log(`ä½¿ç”¨äº‘ç›˜: ${V.name} (${V.cloudType})`);try{m.info(`æ­£åœ¨è½¬å­˜: ${b.title}`);const K=await it(d,V.parentId,V.cloudType);console.log("è½¬å­˜å“åº”:",K);const U=K.success||K.code===0||K.code===200||K.status==="success",N=K.message||K.msg||K.error||(U?"è½¬å­˜æˆåŠŸ":"è½¬å­˜å¤±è´¥"),P={embyItemId:R.value.id,embyItemName:R.value.name,embyItemYear:R.value.productionYear,resourceId:b.id,resourceTitle:b.title,resourceUrl:d,matchScore:b.matchScore,cloudType:b.cloudType,cloudName:V.name,parentId:V.parentId,transferStatus:U?"success":"failed",transferMessage:N};try{await me(P)}catch(G){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",G)}if(v.push({...P,index:z+1,total:l.length}),U){D=b,console.log("âœ“âœ“âœ“ è½¬å­˜æˆåŠŸï¼âœ“âœ“âœ“"),m.success({message:`è½¬å­˜æˆåŠŸï¼
èµ„æº: ${b.title}
è¯„åˆ†: ${(S=b.matchScore)==null?void 0:S.toFixed(1)}åˆ†
äº‘ç›˜: ${V.name}`,duration:5e3,showClose:!0}),q.value[R.value.id]="success",ve.value=!1;break}else console.log(`âœ— è½¬å­˜å¤±è´¥: ${N}`),m.warning({message:`è½¬å­˜å¤±è´¥: ${N}`,duration:3e3}),$<i&&(console.log("ç»§ç»­å°è¯•ä¸‹ä¸€ä¸ªèµ„æº..."),await new Promise(G=>setTimeout(G,1e3)))}catch(K){console.error("âœ— è½¬å­˜å¼‚å¸¸:",K);const U=((_=(g=K.response)==null?void 0:g.data)==null?void 0:_.message)||K.message||"æœªçŸ¥é”™è¯¯",N={embyItemId:R.value.id,embyItemName:R.value.name,embyItemYear:R.value.productionYear,resourceId:b.id,resourceTitle:b.title,resourceUrl:d,matchScore:b.matchScore,cloudType:b.cloudType,cloudName:V.name,parentId:V.parentId,transferStatus:"failed",transferMessage:U};try{await me(N)}catch(P){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",P)}v.push({...N,index:z+1,total:l.length}),m.warning({message:`è½¬å­˜å¤±è´¥: ${U}`,duration:3e3}),$<e&&(console.log("ç»§ç»­å°è¯•ä¸‹ä¸€ä¸ªèµ„æº..."),await new Promise(P=>setTimeout(P,1e3)))}}if(console.log(`
=== è½¬å­˜è®°å½• ===`),console.log(`å°è¯•æ¬¡æ•°: ${v.length}`),v.forEach((z,b)=>{const d=z.transferStatus==="success"?"âœ“ æˆåŠŸ":"âœ— å¤±è´¥";console.log(`${b+1}. ${d} - ${z.resourceTitle} - ${z.transferMessage}`)}),D)console.log(`
=== è½¬å­˜å®Œæˆ ===`),console.log(`æˆåŠŸè½¬å­˜: ${D.title}`),console.log(`å®é™…å°è¯•æ¬¡æ•°: ${$}`);else{console.log(`
=== è½¬å­˜å¤±è´¥ ===`),console.log(`å·²å°è¯• ${$} æ¬¡ï¼Œå…¨éƒ¨å¤±è´¥`);let z=`è‡ªåŠ¨è½¬å­˜å¤±è´¥ï¼å·²å°è¯• ${$} ä¸ªèµ„æºï¼š

`;v.forEach((b,d)=>{z+=`${d+1}. ${b.resourceTitle}
   çŠ¶æ€: ${b.transferStatus==="success"?"æˆåŠŸ":"å¤±è´¥"}
   åŸå› : ${b.transferMessage}

`}),ue.alert(z,"è½¬å­˜ç»“æœ",{confirmButtonText:"ç¡®å®š",type:"warning",dangerouslyUseHTMLString:!1})}}catch($){console.error("è‡ªåŠ¨è½¬å­˜å¼‚å¸¸:",$),m.error("è‡ªåŠ¨è½¬å­˜å¤±è´¥: "+$.message)}finally{we.value=!1}},nl=async l=>{var e,i,r,n;try{we.value=!0,m.info(`æ­£åœ¨è½¬å­˜: ${l.name}`);const c=await Ct(l.url,l.code);console.log("115èµ„æºè½¬å­˜ç»“æœ:",c);const f=c.code===200||c.success===!0,v=c.message||c.msg||c.error||(f?"è½¬å­˜æˆåŠŸ":"è½¬å­˜å¤±è´¥"),x={embyItemId:R.value.id,embyItemName:R.value.name,embyItemYear:R.value.productionYear,resourceId:(e=l.id)==null?void 0:e.toString(),resourceTitle:l.name,resourceUrl:l.url,matchScore:100,cloudType:"115",cloudName:"115ç½‘ç›˜",parentId:"0",transferStatus:f?"success":"failed",transferMessage:v};try{await me(x)}catch(S){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",S)}if(f)m.success({message:`è½¬å­˜æˆåŠŸï¼
èµ„æº: ${l.name}
æ¥æº: 115èµ„æºåº“`,duration:5e3,showClose:!0}),q.value[R.value.id]="success",ve.value=!1;else{m.error(`è½¬å­˜å¤±è´¥: ${v}`),m.info("å°†ä½¿ç”¨æœç´¢å¼•æ“ç»§ç»­æœç´¢èµ„æº");let S=R.value.originalTitle||R.value.name;S=Je(S),he.value=S,ve.value=!0,Ae()}}catch(c){console.error("115èµ„æºè½¬å­˜å¼‚å¸¸:",c);const f=((r=(i=c.response)==null?void 0:i.data)==null?void 0:r.message)||c.message||"è½¬å­˜å¤±è´¥",v={embyItemId:R.value.id,embyItemName:R.value.name,embyItemYear:R.value.productionYear,resourceId:(n=l.id)==null?void 0:n.toString(),resourceTitle:l.name,resourceUrl:l.url,matchScore:100,cloudType:"115",cloudName:"115",parentId:"",transferStatus:"failed",transferMessage:f};try{await me(v)}catch(S){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",S)}m.error(`è½¬å­˜å¤±è´¥: ${f}`),m.info("å°†ä½¿ç”¨æœç´¢å¼•æ“ç»§ç»­æœç´¢èµ„æº");let x=R.value.originalTitle||R.value.name;x=Je(x),he.value=x,ve.value=!0,Ae()}finally{we.value=!1}},ol=async()=>{var n,c,f,v,x,S,g,_,$,D,z;const l=Y.value.filter(b=>b.type==="Movie"||b.type==="Series");if(l.length===0){m.warning("å½“å‰é¡µæ²¡æœ‰å¯ä¸‹è½½çš„åª’ä½“é¡¹ï¼ˆä»…æ”¯æŒç”µå½±å’Œå‰§é›†ï¼‰");return}try{await ue.confirm(`ç¡®å®šè¦æ‰¹é‡ä¸‹è½½å½“å‰é¡µçš„ ${l.length} ä¸ªåª’ä½“é¡¹å—ï¼Ÿ

æ­¤æ“ä½œå°†ä¾æ¬¡æœç´¢å¹¶ä¸‹è½½æ¯ä¸ªåª’ä½“é¡¹ï¼Œå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ã€‚`,"æ‰¹é‡ä¸‹è½½ç¡®è®¤",{confirmButtonText:"å¼€å§‹ä¸‹è½½",cancelButtonText:"å–æ¶ˆ",type:"warning"})}catch{return}Ze.value=!0;let e=0,i=0,r=0;m.info(`å¼€å§‹æ‰¹é‡ä¸‹è½½ï¼Œå…± ${l.length} ä¸ªåª’ä½“é¡¹`);for(let b=0;b<l.length;b++){const d=l[b];try{if(m.info(`[${b+1}/${l.length}] æ­£åœ¨å¤„ç†: ${d.name}`),q.value[d.id]==="success"){m.info(`è·³è¿‡å·²è½¬å­˜: ${d.name}`),r++;continue}let V=null;d.providerIds&&d.providerIds.Tmdb&&(V=d.providerIds.Tmdb);let K=!1;try{const U=await It(V,d.name,d.originalTitle,d.productionYear);if(U.data){const N=U.data;m.success(`æ‰¾åˆ°115èµ„æº: ${N.name}`),R.value=d;try{m.info(`æ­£åœ¨è½¬å­˜115èµ„æº: ${N.name}`);const P=await Ct(N.url,N.code),G=P.code===200||P.success===!0,O=P.message||P.msg||P.error||(G?"è½¬å­˜æˆåŠŸ":"è½¬å­˜å¤±è´¥"),pe={embyItemId:d.id,embyItemName:d.name,embyItemYear:d.productionYear,resourceId:(n=N.id)==null?void 0:n.toString(),resourceTitle:N.name,resourceUrl:N.url,matchScore:100,cloudType:"115",cloudName:"115ç½‘ç›˜",parentId:"0",transferStatus:G?"success":"failed",transferMessage:O};try{await me(pe)}catch(W){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",W)}if(G){m.success(`è½¬å­˜æˆåŠŸ: ${d.name}`),e++,K=!0,q.value[d.id]="success",await new Promise(W=>setTimeout(W,1e3));continue}else console.log(`115è½¬å­˜å¤±è´¥: ${O}ï¼Œå°†ä½¿ç”¨æœç´¢å¼•æ“æœç´¢`),m.warning(`115è½¬å­˜å¤±è´¥: ${O.substring(0,30)}ï¼Œå°è¯•æœç´¢å¼•æ“...`)}catch(P){console.error(`115è½¬å­˜å¼‚å¸¸ [${d.name}]:`,P);const G=((f=(c=P.response)==null?void 0:c.data)==null?void 0:f.message)||P.message||"è½¬å­˜å¼‚å¸¸";try{await me({embyItemId:d.id,embyItemName:d.name,embyItemYear:d.productionYear,resourceId:(v=N.id)==null?void 0:v.toString(),resourceTitle:N.name,resourceUrl:N.url,matchScore:100,cloudType:"115",cloudName:"115ç½‘ç›˜",parentId:"0",transferStatus:"failed",transferMessage:`è½¬å­˜å¼‚å¸¸: ${G}`})}catch(O){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",O)}m.warning("115è½¬å­˜å¼‚å¸¸ï¼Œå°è¯•æœç´¢å¼•æ“...")}}}catch(U){console.error(`æœç´¢115èµ„æºå¤±è´¥ [${d.name}]:`,U)}if(!K){m.info(`115èµ„æºåº“æœªæ‰¾åˆ°ï¼Œä½¿ç”¨æœç´¢å¼•æ“æœç´¢: ${d.name}`);try{R.value=d;let U=d.originalTitle||d.name;U=Je(U),d.productionYear&&(U+=` ${d.productionYear}`),console.log(`æœç´¢å…³é”®è¯: ${U}`);const N=await Tt(U);if(!N||!N.data){m.warning(`æœç´¢å¤±è´¥: ${d.name}`),i++,await new Promise(h=>setTimeout(h,1e3));continue}let P=[];const G=((x=N.data)==null?void 0:x.channels)||((S=N.data)==null?void 0:S.channel_info_list);if(G&&Array.isArray(G)&&G.forEach(h=>{const M=h.channelInfo||{};h.messages&&Array.isArray(h.messages)&&h.messages.forEach(B=>{B.cloudLinks&&B.cloudLinks.length>0&&B.cloudLinks.forEach((L,se)=>{const J=B.title||B.text,$e=qe(J);P.push({id:`${B.messageId}-${se}`,messageId:B.messageId,title:$e,rawTitle:J,url:L,link:L,cloudType:B.cloudType,channelName:M.name||"æœªçŸ¥æ¥æº"})})}),h.list&&Array.isArray(h.list)&&h.list.forEach(B=>{B.cloudLinks&&B.cloudLinks.length>0&&B.cloudLinks.forEach((L,se)=>{const J=B.title||B.content,$e=qe(J);P.push({id:`${B.messageId}-${se}`,messageId:B.messageId,title:$e,rawTitle:J,url:L,link:L,cloudType:B.cloudType,channelName:M.name||"æœªçŸ¥æ¥æº"})})})}),P.length===0){m.warning(`æœªæ‰¾åˆ°æœç´¢ç»“æœ: ${d.name}`),i++,await new Promise(h=>setTimeout(h,1e3));continue}P=ft(P,U,d);const O={};P.forEach(h=>{const M=h.cloudType;O[M]||(O[M]=[]),O[M].push(h)}),console.log(`
=== äº‘ç›˜èµ„æºåˆ†å¸ƒ ===`),Object.keys(O).forEach(h=>{console.log(`${h}: ${O[h].length} ä¸ª`)});const pe=ie.value.filter(h=>O[h.cloudType]).sort((h,M)=>(h.priority||999)-(M.priority||999));console.log(`
=== äº‘ç›˜ä¼˜å…ˆçº§æ’åº ===`),pe.forEach((h,M)=>{console.log(`${M+1}. ${h.cloudType} (ä¼˜å…ˆçº§: ${h.priority||"æœªè®¾ç½®"}) - ${O[h.cloudType].length} ä¸ªèµ„æº`)});const W=[],Ie={},Le=10;for(pe.forEach(h=>{Ie[h.cloudType]=0});W.length<Le;){let h=!1;for(const M of pe){const B=M.cloudType,L=O[B];if(Ie[B]<L.length&&(W.push(L[Ie[B]++]),h=!0,W.length>=Le))break}if(!h)break}console.log(`
=== ä¼˜å…ˆçº§æ’åºåï¼Œå°†å°è¯• ${W.length} ä¸ªèµ„æº ===`),W.forEach((h,M)=>{console.log(`${M+1}. [${h.cloudType}] ${h.title.substring(0,40)}`)});let ae=!1,le="";for(let h=0;h<W.length;h++){const M=W[h];h===0?m.info(`æ‰¾åˆ°æœ€ä½³åŒ¹é… [${M.cloudType}]: ${M.title.substring(0,30)}`):m.info(`å°è¯•å¤‡é€‰æ–¹æ¡ˆ ${h+1} [${M.cloudType}]: ${M.title.substring(0,30)}`);const B=ot(M.cloudType);if(!B||!B.parentId){le=`æœªé…ç½® ${M.cloudType} äº‘ç›˜`,console.log(`è·³è¿‡: ${le}`);continue}try{const L=await it(M.url,B.parentId,B.cloudType);if(L&&(L.success===!0||L.code===200||L.code===0||L.status==="success")){m.success(`è½¬å­˜æˆåŠŸ: ${d.name}${h>0?` (ç¬¬${h+1}æ¬¡å°è¯•)`:""}`),e++,ae=!0,q.value[d.id]=!0;try{await me({embyItemId:d.id,embyItemName:d.name,embyItemYear:d.productionYear,resourceId:(g=M.id)==null?void 0:g.toString(),resourceTitle:M.title,resourceUrl:M.url,matchScore:M.matchScore||0,cloudType:M.cloudType,cloudName:B.name,parentId:B.parentId,transferStatus:"success",transferMessage:`è½¬å­˜æˆåŠŸ${h>0?` (ç¬¬${h+1}æ¬¡å°è¯•)`:""}`})}catch(J){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",J)}break}else{le=(L==null?void 0:L.message)||(L==null?void 0:L.msg)||"è½¬å­˜å¤±è´¥",console.log(`è½¬å­˜å¤±è´¥ (å°è¯• ${h+1}/${W.length}): ${le}`);try{await me({embyItemId:d.id,embyItemName:d.name,embyItemYear:d.productionYear,resourceId:(_=M.id)==null?void 0:_.toString(),resourceTitle:M.title,resourceUrl:M.url,matchScore:M.matchScore||0,cloudType:M.cloudType,cloudName:B.name,parentId:B.parentId,transferStatus:"failed",transferMessage:`${le} (ç¬¬${h+1}æ¬¡å°è¯•)`})}catch(J){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",J)}h<W.length-1&&(m.warning(`è½¬å­˜å¤±è´¥: ${le.substring(0,50)}ï¼Œå°è¯•ä¸‹ä¸€ä¸ª...`),await new Promise(J=>setTimeout(J,500)))}}catch(L){le=((D=($=L.response)==null?void 0:$.data)==null?void 0:D.message)||L.message||"è½¬å­˜å¼‚å¸¸",console.error(`è½¬å­˜å¼‚å¸¸ (å°è¯• ${h+1}/${W.length}):`,L);try{await me({embyItemId:d.id,embyItemName:d.name,embyItemYear:d.productionYear,resourceId:(z=M.id)==null?void 0:z.toString(),resourceTitle:M.title,resourceUrl:M.url,matchScore:M.matchScore||0,cloudType:M.cloudType,cloudName:B.name,parentId:B.parentId,transferStatus:"failed",transferMessage:`è½¬å­˜å¼‚å¸¸: ${le} (ç¬¬${h+1}æ¬¡å°è¯•)`})}catch(se){console.error("ä¿å­˜è½¬å­˜å†å²å¤±è´¥:",se)}h<W.length-1&&(m.warning("è½¬å­˜å¼‚å¸¸ï¼Œå°è¯•ä¸‹ä¸€ä¸ª..."),await new Promise(se=>setTimeout(se,500)))}}ae||(m.error(`è½¬å­˜å¤±è´¥ (å·²å°è¯•${W.length}æ¬¡): ${d.name} - ${le}`),i++),await new Promise(h=>setTimeout(h,1e3))}catch(U){console.error(`æœç´¢å¼•æ“æœç´¢å¤±è´¥ [${d.name}]:`,U),m.error(`æœç´¢å¤±è´¥: ${d.name}`),i++,await new Promise(N=>setTimeout(N,1e3))}}await new Promise(U=>setTimeout(U,1e3))}catch(V){console.error(`å¤„ç†å¤±è´¥ [${d.name}]:`,V),m.error(`å¤„ç†å¤±è´¥: ${d.name}`),i++}}Ze.value=!1,ue.alert(`æ‰¹é‡ä¸‹è½½å®Œæˆï¼

æˆåŠŸ: ${e} ä¸ª
å¤±è´¥: ${i} ä¸ª
è·³è¿‡: ${r} ä¸ª`,"æ‰¹é‡ä¸‹è½½ç»“æœ",{confirmButtonText:"ç¡®å®š",type:e>0?"success":"info"})},rl=async()=>{const l=Y.value.filter(i=>i.type==="Movie"||i.type==="Series");if(l.length===0){m.warning("å½“å‰é¡µæ²¡æœ‰å¯ä¸‹è½½çš„åª’ä½“é¡¹ï¼ˆä»…æ”¯æŒç”µå½±å’Œå‰§é›†ï¼‰");return}const e=l.filter(i=>H.value[i.id]!=="success");if(e.length===0){m.info("å½“å‰é¡µæ‰€æœ‰åª’ä½“é¡¹éƒ½å·²ä¸‹è½½");return}try{await ue.confirm(`ç¡®å®šè¦æ‰¹é‡ç›´æ¥ä¸‹è½½ ${e.length} ä¸ªåª’ä½“é¡¹å—ï¼Ÿ

ï¼ˆå·²è·³è¿‡ ${l.length-e.length} ä¸ªå·²ä¸‹è½½é¡¹ï¼‰

ä¸‹è½½ä»»åŠ¡å°†åœ¨åç«¯ä¾æ¬¡æ‰§è¡Œï¼Œå…³é—­æµè§ˆå™¨ä¸å½±å“ä¸‹è½½è¿›åº¦ã€‚`,"æ‰¹é‡ç›´æ¥ä¸‹è½½ç¡®è®¤",{confirmButtonText:"å¼€å§‹ä¸‹è½½",cancelButtonText:"å–æ¶ˆ",type:"warning"})}catch{return}Se.value=!0;try{const i=e.map(n=>n.id),r=await Nl(i);if(r.data&&r.data.status==="started"){m.success(`æ‰¹é‡ä¸‹è½½ä»»åŠ¡å·²æäº¤åˆ°åç«¯ï¼Œå…± ${i.length} ä¸ªåª’ä½“é¡¹ï¼Œå…³é—­æµè§ˆå™¨ä¸å½±å“ä¸‹è½½`);const n=setInterval(async()=>{try{const f=(await Yl()).data;if(!f||!f.running){if(clearInterval(n),Se.value=!1,f&&f.totalCount&&ue.alert(`æ‰¹é‡ç›´æ¥ä¸‹è½½å®Œæˆï¼

æˆåŠŸ: ${f.successCount||0} ä¸ª
å¤±è´¥: ${f.failedCount||0} ä¸ª
è·³è¿‡: ${f.skippedCount||0} ä¸ª`,"æ‰¹é‡ç›´æ¥ä¸‹è½½ç»“æœ",{confirmButtonText:"ç¡®å®š",type:(f.successCount||0)>0?"success":"info"}),Y.value&&Y.value.length>0){const g=Y.value.map(_=>_.id);try{const _=await Ce(g);_.data&&Object.assign(H.value,_.data)}catch(_){console.error("åˆ·æ–°ä¸‹è½½çŠ¶æ€å¤±è´¥:",_)}}return}const v=f.completedCount||0,x=f.totalCount||0,S=f.currentItemName||"";if(console.log(`æ‰¹é‡ä¸‹è½½è¿›åº¦: ${v}/${x} - å½“å‰: ${S}`),v>0&&v%3===0&&Y.value&&Y.value.length>0){const g=Y.value.map(_=>_.id);try{const _=await Ce(g);_.data&&Object.assign(H.value,_.data)}catch{}}}catch(c){console.error("è·å–æ‰¹é‡ä¸‹è½½è¿›åº¦å¤±è´¥:",c)}},1e4)}else m.error("å¯åŠ¨æ‰¹é‡ä¸‹è½½å¤±è´¥"),Se.value=!1}catch(i){console.error("æ‰¹é‡ä¸‹è½½å¤±è´¥:",i),m.error("æ‰¹é‡ä¸‹è½½å¤±è´¥: "+(i.message||"æœªçŸ¥é”™è¯¯")),Se.value=!1}},il=async l=>{var n,c;const e=l.url||l.link||l.share_url;if(!e){m.error("è¯¥èµ„æºæ²¡æœ‰æœ‰æ•ˆçš„åˆ†äº«é“¾æ¥");return}const i=e.includes("alipan.com")||e.includes("aliyundrive.com"),r=e.includes("cloud.189.cn");if(!i&&!r){m.warning("è¯¥é“¾æ¥ä¸æ˜¯é˜¿é‡Œäº‘ç›˜æˆ–å¤©ç¿¼äº‘ç›˜åˆ†äº«é“¾æ¥ï¼Œæ— æ³•è½¬å­˜");return}r&&m.info("æ£€æµ‹åˆ°å¤©ç¿¼äº‘ç›˜é“¾æ¥ï¼Œå°†å°è¯•è½¬å­˜"),fe.value=l,we.value=!0;try{await ue.confirm(`ç¡®å®šè¦è½¬å­˜è¿™ä¸ªèµ„æºå—ï¼Ÿ

æ ‡é¢˜: ${l.title}
å¤§å°: ${l.size||"æœªçŸ¥"}
æ¥æº: ${l.channelName}
é“¾æ¥: ${e}`,"ç¡®è®¤è½¬å­˜",{confirmButtonText:"ç¡®å®šè½¬å­˜",cancelButtonText:"å–æ¶ˆ",type:"warning"});const f=ot(fe.value.cloudType);if(!f){m.error(`æœªæ‰¾åˆ° cloudType="${fe.value.cloudType}" çš„äº‘ç›˜é…ç½®ï¼Œè¯·åœ¨æ™ºèƒ½æœç´¢é…ç½®ä¸­æ·»åŠ `);return}if(!f.parentId){m.warning(`äº‘ç›˜é…ç½®"${f.name}"æœªè®¾ç½®ç›®å½•IDï¼Œè¯·åœ¨æ™ºèƒ½æœç´¢é…ç½®ä¸­å®Œå–„`);return}console.log("ä½¿ç”¨äº‘ç›˜é…ç½®:",f);const v=await it(e,f.parentId,f.cloudType);if(console.log("è½¬å­˜ç»“æœ:",v),v.success||v.code===0||v.status==="success")m.success("è½¬å­˜æˆåŠŸï¼èµ„æºå·²ä¿å­˜åˆ°é˜¿é‡Œäº‘ç›˜"),ve.value=!1;else{const x=v.message||v.msg||v.error||"è½¬å­˜å¤±è´¥";m.error("è½¬å­˜å¤±è´¥: "+x)}}catch(f){if(f!=="cancel"){console.error("è½¬å­˜å¤±è´¥:",f);const v=((c=(n=f.response)==null?void 0:n.data)==null?void 0:c.message)||f.message||"æœªçŸ¥é”™è¯¯";m.error("è½¬å­˜å¤±è´¥: "+v)}}finally{we.value=!1}},ul=l=>JSON.stringify(l,null,2);return kl(async()=>{Rt(),await ut(),await De(),await He(),await Ge(),await Qe()}),(l,e)=>{var _t,bt,kt;const i=C("CircleCheck"),r=C("el-icon"),n=C("el-tag"),c=C("Connection"),f=C("el-button"),v=C("Refresh"),x=C("Delete"),S=C("el-card"),g=C("el-text"),_=C("el-descriptions-item"),$=C("el-link"),D=C("el-descriptions"),z=C("el-alert"),b=C("el-empty"),d=C("el-table-column"),V=C("Film"),K=C("Monitor"),U=C("Headset"),N=C("Folder"),P=C("FolderOpened"),G=C("View"),O=C("el-table"),pe=C("el-col"),W=C("el-row"),Ie=C("Search"),Le=C("el-input"),ae=C("el-option"),le=C("el-select"),h=C("Download"),M=C("Loading"),B=C("VideoPlay"),L=C("Close"),se=C("Document"),J=C("el-rate"),$e=C("el-tooltip"),cl=C("el-pagination"),Xe=C("el-dialog"),gt=C("el-divider"),yt=C("el-form-item"),vt=C("el-checkbox"),dl=C("el-form"),fl=C("CircleClose"),pl=C("QuestionFilled"),ht=C("el-progress"),ml=C("el-image"),gl=C("Star"),yl=C("el-timeline-item"),vl=C("el-timeline"),Fe=wl("loading");return o(),k("div",Ol,[a(S,{class:"header-card"},{default:t(()=>[w("div",Kl,[w("div",Wl,[e[13]||(e[13]=w("h2",null,"Emby åª’ä½“åº“ç®¡ç†",-1)),Q.value?(o(),p(n,{key:0,type:"success",size:"large"},{default:t(()=>[a(r,null,{default:t(()=>[a(i)]),_:1}),e[12]||(e[12]=u(" å·²è¿æ¥ ",-1))]),_:1})):A("",!0)]),w("div",Hl,[a(f,{type:"primary",onClick:Et,loading:te.value},{default:t(()=>[a(r,null,{default:t(()=>[a(c)]),_:1}),e[14]||(e[14]=u(" æµ‹è¯•è¿æ¥ ",-1))]),_:1},8,["loading"]),a(f,{type:"success",onClick:ct,loading:ce.value},{default:t(()=>[a(r,null,{default:t(()=>[a(v)]),_:1}),e[15]||(e[15]=u(" åŒæ­¥æ‰€æœ‰æ•°æ® ",-1))]),_:1},8,["loading"]),a(f,{type:"warning",onClick:Wt,loading:ge.value},{default:t(()=>[a(r,null,{default:t(()=>[a(x)]),_:1}),e[16]||(e[16]=u(" æ¸…ç©ºç¼“å­˜ ",-1))]),_:1},8,["loading"])])])]),_:1}),Q.value?(o(),p(S,{key:0,class:"info-card"},{header:t(()=>[w("div",Gl,[e[17]||(e[17]=w("span",null,"æœåŠ¡å™¨ä¿¡æ¯",-1)),a(n,{type:"info"},{default:t(()=>[u(y(Q.value.version),1)]),_:1})])]),default:t(()=>[a(D,{column:3,border:""},{default:t(()=>[a(_,{label:"æœåŠ¡å™¨åç§°"},{default:t(()=>[a(g,{tag:"b"},{default:t(()=>[u(y(Q.value.serverName),1)]),_:1})]),_:1}),a(_,{label:"ç‰ˆæœ¬"},{default:t(()=>[u(y(Q.value.version),1)]),_:1}),a(_,{label:"æ“ä½œç³»ç»Ÿ"},{default:t(()=>[u(y(Q.value.operatingSystem),1)]),_:1}),a(_,{label:"æœ¬åœ°åœ°å€"},{default:t(()=>[a($,{href:`http://${Q.value.localAddress}`,target:"_blank",type:"primary"},{default:t(()=>[u(y(Q.value.localAddress),1)]),_:1},8,["href"])]),_:1}),a(_,{label:"å¤–ç½‘åœ°å€"},{default:t(()=>[Q.value.wanAddress?(o(),p($,{key:0,href:`http://${Q.value.wanAddress}`,target:"_blank",type:"primary"},{default:t(()=>[u(y(Q.value.wanAddress),1)]),_:1},8,["href"])):(o(),k("span",Ql,"-"))]),_:1}),a(_,{label:"æœåŠ¡å™¨ID"},{default:t(()=>[a(g,{type:"info",size:"small"},{default:t(()=>[u(y(Q.value.id),1)]),_:1})]),_:1})]),_:1})]),_:1})):A("",!0),!Q.value&&!te.value?(o(),p(z,{key:1,title:"è¯·å…ˆé…ç½® Emby æœåŠ¡å™¨",type:"warning",closable:!1,"show-icon":"",class:"config-alert"},{default:t(()=>[...e[18]||(e[18]=[w("div",null,[w("p",null,[u("è¯·åœ¨åç«¯é…ç½®æ–‡ä»¶ "),w("code",null,"application.yml"),u(" ä¸­é…ç½® Emby æœåŠ¡å™¨ä¿¡æ¯ï¼š")]),w("pre",{class:"config-example"},`app:
  emby:
    server-url: http://your-emby-server:8096
    api-key: your-api-key-here
    enabled: true`),w("p",null,'é…ç½®å®Œæˆåï¼Œç‚¹å‡»"æµ‹è¯•è¿æ¥"æŒ‰é’®éªŒè¯é…ç½®ã€‚')],-1)])]),_:1})):A("",!0),Q.value&&!xe.value&&!ce.value?(o(),p(z,{key:2,title:"âš ï¸ é¦–æ¬¡ä½¿ç”¨éœ€è¦åŒæ­¥æ•°æ®",type:"error",closable:!1,"show-icon":"",class:"sync-alert"},{default:t(()=>[w("div",null,[e[20]||(e[20]=w("p",null,[w("strong",null,'æ•°æ®åº“ä¸­æš‚æ— æ•°æ®ï¼Œè¯·å…ˆç‚¹å‡»"åŒæ­¥æ‰€æœ‰æ•°æ®"æŒ‰é’®ï¼')],-1)),e[21]||(e[21]=w("p",null,"åŒæ­¥è¿‡ç¨‹ä¼šä» Emby æœåŠ¡å™¨è·å–æ‰€æœ‰åª’ä½“åº“ã€åª’ä½“é¡¹ã€ç±»å‹ã€æ ‡ç­¾ã€å·¥ä½œå®¤ç­‰æ•°æ®å¹¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚",-1)),e[22]||(e[22]=w("p",null,"æ ¹æ®åª’ä½“åº“å¤§å°ï¼ŒåŒæ­¥å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ ååˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚",-1)),a(f,{type:"danger",size:"large",onClick:ct,loading:ce.value,style:{"margin-top":"10px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(v)]),_:1}),e[19]||(e[19]=u(" ç«‹å³åŒæ­¥æ‰€æœ‰æ•°æ® ",-1))]),_:1},8,["loading"])])]),_:1})):A("",!0),a(S,{class:"library-card"},{header:t(()=>[w("div",Jl,[w("span",null,"åª’ä½“åº“åˆ—è¡¨ ("+y(ke.value.length)+")",1),a(f,{type:"primary",size:"small",onClick:De},{default:t(()=>[a(r,null,{default:t(()=>[a(v)]),_:1}),e[23]||(e[23]=u(" åˆ·æ–° ",-1))]),_:1})])]),default:t(()=>[!be.value&&ke.value.length===0?(o(),p(b,{key:0,description:"æš‚æ— åª’ä½“åº“æ•°æ®"},{default:t(()=>[a(f,{type:"primary",onClick:De},{default:t(()=>[...e[24]||(e[24]=[u("åˆ·æ–°æ•°æ®",-1)])]),_:1})]),_:1})):Ve((o(),p(O,{key:1,data:ke.value,border:"",stripe:""},{default:t(()=>[a(d,{type:"index",label:"#",width:"60",align:"center"}),a(d,{prop:"name",label:"åç§°","min-width":"150"},{default:t(({row:s})=>[w("div",ql,[s.collectionType==="movies"?(o(),p(r,{key:0,color:"#34c759"},{default:t(()=>[a(V)]),_:1})):s.collectionType==="tvshows"?(o(),p(r,{key:1,color:"#007aff"},{default:t(()=>[a(K)]),_:1})):s.collectionType==="music"?(o(),p(r,{key:2,color:"#ff9500"},{default:t(()=>[a(U)]),_:1})):(o(),p(r,{key:3,color:"#86868b"},{default:t(()=>[a(N)]),_:1})),w("span",null,y(s.name),1)])]),_:1}),a(d,{prop:"collectionType",label:"ç±»å‹",width:"120"},{default:t(({row:s})=>[s.collectionType==="movies"?(o(),p(n,{key:0,type:"success"},{default:t(()=>[...e[25]||(e[25]=[u("ç”µå½±",-1)])]),_:1})):s.collectionType==="tvshows"?(o(),p(n,{key:1,type:"primary"},{default:t(()=>[...e[26]||(e[26]=[u("ç”µè§†å‰§",-1)])]),_:1})):s.collectionType==="music"?(o(),p(n,{key:2,type:"warning"},{default:t(()=>[...e[27]||(e[27]=[u("éŸ³ä¹",-1)])]),_:1})):(o(),p(n,{key:3},{default:t(()=>[u(y(s.collectionType||"å…¶ä»–"),1)]),_:2},1024))]),_:1}),a(d,{prop:"itemCount",label:"åª’ä½“é¡¹æ•°é‡",width:"120",align:"center"},{default:t(({row:s})=>[s.itemCount!==void 0&&s.itemCount!==null?(o(),p(g,{key:0,type:"primary",tag:"b"},{default:t(()=>[u(y(s.itemCount),1)]),_:2},1024)):(o(),p(g,{key:1,type:"info",size:"small"},{default:t(()=>[...e[28]||(e[28]=[u("ç‚¹å‡»æŸ¥çœ‹",-1)])]),_:1}))]),_:1}),a(d,{prop:"locations",label:"è·¯å¾„","min-width":"300"},{default:t(({row:s})=>[s.locations&&s.locations.length>0?(o(),k("div",Xl,[(o(!0),k(Z,null,ee(s.locations,(T,X)=>(o(),k("div",{key:X,class:"path-item"},[a(r,null,{default:t(()=>[a(P)]),_:1}),u(" "+y(T),1)]))),128))])):(o(),k("span",Zl,"-"))]),_:1}),a(d,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:t(({row:s})=>[a(f,{type:"primary",size:"small",onClick:T=>Dt(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(G)]),_:1}),e[29]||(e[29]=u(" æŸ¥çœ‹åª’ä½“é¡¹ ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Fe,be.value]])]),_:1}),a(W,{gutter:20,class:"category-row"},{default:t(()=>[a(pe,{span:8},{default:t(()=>[a(S,null,{header:t(()=>[w("div",ea,[w("span",null,"ç±»å‹ ("+y(ze.value.length)+")",1),a(f,{type:"text",size:"small",onClick:He},{default:t(()=>[...e[30]||(e[30]=[u("åˆ·æ–°",-1)])]),_:1})])]),default:t(()=>[Ve((o(),k("div",ta,[!Ne.value&&ze.value.length===0?(o(),p(b,{key:0,description:"æš‚æ— æ•°æ®","image-size":60})):(o(!0),k(Z,{key:1},ee(ze.value,s=>(o(),p(n,{key:s.id,class:"category-tag"},{default:t(()=>[u(y(s.name)+" ",1),s.itemCount?(o(),k("span",la,"("+y(s.itemCount)+")",1)):A("",!0)]),_:2},1024))),128))])),[[Fe,Ne.value]])]),_:1})]),_:1}),a(pe,{span:8},{default:t(()=>[a(S,null,{header:t(()=>[w("div",aa,[w("span",null,"æ ‡ç­¾ ("+y(Me.value.length)+")",1),a(f,{type:"text",size:"small",onClick:Ge},{default:t(()=>[...e[31]||(e[31]=[u("åˆ·æ–°",-1)])]),_:1})])]),default:t(()=>[Ve((o(),k("div",sa,[!Ye.value&&Me.value.length===0?(o(),p(b,{key:0,description:"æš‚æ— æ•°æ®","image-size":60})):(o(!0),k(Z,{key:1},ee(Me.value,s=>(o(),p(n,{key:s.id,type:"success",class:"category-tag"},{default:t(()=>[u(y(s.name)+" ",1),s.itemCount?(o(),k("span",na,"("+y(s.itemCount)+")",1)):A("",!0)]),_:2},1024))),128))])),[[Fe,Ye.value]])]),_:1})]),_:1}),a(pe,{span:8},{default:t(()=>[a(S,null,{header:t(()=>[w("div",oa,[w("span",null,"å·¥ä½œå®¤ ("+y(Re.value.length)+")",1),a(f,{type:"text",size:"small",onClick:Qe},{default:t(()=>[...e[32]||(e[32]=[u("åˆ·æ–°",-1)])]),_:1})])]),default:t(()=>[Ve((o(),k("div",ra,[!Ue.value&&Re.value.length===0?(o(),p(b,{key:0,description:"æš‚æ— æ•°æ®","image-size":60})):(o(!0),k(Z,{key:1},ee(Re.value,s=>(o(),p(n,{key:s.id,type:"warning",class:"category-tag"},{default:t(()=>[u(y(s.name)+" ",1),s.itemCount?(o(),k("span",ia,"("+y(s.itemCount)+")",1)):A("",!0)]),_:2},1024))),128))])),[[Fe,Ue.value]])]),_:1})]),_:1})]),_:1}),a(Xe,{modelValue:lt.value,"onUpdate:modelValue":e[5]||(e[5]=s=>lt.value=s),title:`${(_t=oe.value)==null?void 0:_t.name} - åª’ä½“é¡¹åˆ—è¡¨`,width:"90%",top:"5vh"},{default:t(()=>[w("div",ua,[w("div",ca,[w("div",da,[a(Le,{modelValue:Pe.value,"onUpdate:modelValue":e[0]||(e[0]=s=>Pe.value=s),placeholder:"æœç´¢åª’ä½“é¡¹...",style:{width:"300px"},clearable:"",onClear:_e},{append:t(()=>[a(f,{onClick:jt},{default:t(()=>[a(r,null,{default:t(()=>[a(Ie)]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(le,{modelValue:Ee.value,"onUpdate:modelValue":e[1]||(e[1]=s=>Ee.value=s),placeholder:"è½¬å­˜çŠ¶æ€",style:{width:"140px"},clearable:"",onChange:Yt},{default:t(()=>[a(ae,{label:"å…¨éƒ¨",value:""}),a(ae,{label:"è½¬å­˜æˆåŠŸ",value:"success"}),a(ae,{label:"è½¬å­˜å¤±è´¥",value:"failed"}),a(ae,{label:"æœªè½¬å­˜",value:"none"})]),_:1},8,["modelValue"]),a(le,{modelValue:je.value,"onUpdate:modelValue":e[2]||(e[2]=s=>je.value=s),placeholder:"ä¸‹è½½çŠ¶æ€",style:{width:"140px"},clearable:"",onChange:Ut},{default:t(()=>[a(ae,{label:"å…¨éƒ¨",value:""}),a(ae,{label:"ä¸‹è½½æˆåŠŸ",value:"success"}),a(ae,{label:"ä¸‹è½½å¤±è´¥",value:"failed"}),a(ae,{label:"æœªä¸‹è½½",value:"none"})]),_:1},8,["modelValue"])]),w("div",fa,[a(f,{type:"primary",onClick:ol,loading:Ze.value,disabled:Y.value.length===0||Ee.value==="success"},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[33]||(e[33]=u(" æ‰¹é‡æœç´¢ä¸‹è½½ ",-1))]),_:1},8,["loading","disabled"]),a(f,{type:"warning",onClick:rl,loading:Se.value,disabled:Y.value.length===0},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[34]||(e[34]=u(" æ‰¹é‡ç›´æ¥ä¸‹è½½ ",-1))]),_:1},8,["loading","disabled"]),w("span",pa,"å…± "+y(tt.value)+" é¡¹ (å½“å‰é¡µ "+y(Y.value.length)+" é¡¹)",1)])]),!ne.value&&Y.value.length===0?(o(),p(b,{key:0,description:"æš‚æ— åª’ä½“é¡¹æ•°æ®"},{default:t(()=>[a(f,{type:"primary",onClick:_e},{default:t(()=>[...e[35]||(e[35]=[u("åˆ·æ–°æ•°æ®",-1)])]),_:1})]),_:1})):Ve((o(),p(O,{key:1,data:Y.value,border:"",stripe:"","max-height":"600","expand-row-keys":St.value,"row-key":"id",onExpandChange:At},{default:t(()=>[a(d,{type:"expand",width:"50"},{default:t(({row:s})=>[s.type==="Series"?(o(),k("div",ma,[et.value[s.id]?(o(),k("div",ga,[a(r,{class:"is-loading"},{default:t(()=>[a(M)]),_:1}),e[36]||(e[36]=w("span",null,"åŠ è½½å‰§é›†ä¸­...",-1))])):ye.value[s.id]&&ye.value[s.id].length>0?(o(),k("div",ya,[w("div",va,[w("span",ha,"å‰§é›†åˆ—è¡¨ (å…± "+y(ye.value[s.id].length)+" é›†)",1)]),a(O,{data:ye.value[s.id],border:"",size:"small"},{default:t(()=>[a(d,{type:"index",label:"#",width:"50",align:"center"}),a(d,{prop:"name",label:"é›†æ•°","min-width":"200"},{default:t(({row:T})=>[w("div",_a,[a(r,{color:"#007aff"},{default:t(()=>[a(B)]),_:1}),w("span",null,y(T.name),1),H.value[T.id]==="success"?(o(),p(n,{key:0,type:"success",size:"small",effect:"plain",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[37]||(e[37]=u(" å·²ä¸‹è½½ ",-1))]),_:1})):H.value[T.id]==="failed"?(o(),p(n,{key:1,type:"danger",size:"small",effect:"plain",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(L)]),_:1}),e[38]||(e[38]=u(" ä¸‹è½½å¤±è´¥ ",-1))]),_:1})):A("",!0)])]),_:1}),a(d,{prop:"indexNumber",label:"ç¬¬å‡ é›†",width:"80",align:"center"},{default:t(({row:T})=>[a(n,{size:"small",type:"info"},{default:t(()=>[u("E"+y(T.indexNumber),1)]),_:2},1024)]),_:1}),a(d,{prop:"parentIndexNumber",label:"ç¬¬å‡ å­£",width:"80",align:"center"},{default:t(({row:T})=>[a(n,{size:"small",type:"primary"},{default:t(()=>[u("S"+y(T.parentIndexNumber),1)]),_:2},1024)]),_:1}),a(d,{prop:"runTimeTicks",label:"æ—¶é•¿",width:"100",align:"center"},{default:t(({row:T})=>[T.runTimeTicks?(o(),k("span",ba,y(Lt(T.runTimeTicks)),1)):(o(),k("span",ka,"-"))]),_:1}),a(d,{prop:"overview",label:"ç®€ä»‹","min-width":"300","show-overflow-tooltip":""},{default:t(({row:T})=>[T.overview?(o(),k("span",wa,y(T.overview),1)):(o(),k("span",$a,"æš‚æ— ç®€ä»‹"))]),_:1}),a(d,{label:"æ“ä½œ",width:"120",align:"center"},{default:t(({row:T})=>[a(f,{type:"warning",link:"",size:"small",onClick:X=>dt(T)},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[39]||(e[39]=u(" ä¸‹è½½ ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(o(),p(b,{key:2,description:"æš‚æ— å‰§é›†æ•°æ®","image-size":60}))])):A("",!0)]),_:1}),a(d,{type:"index",label:"#",width:"60",align:"center",index:s=>(de.value-1)*Te.value+s+1},null,8,["index"]),a(d,{prop:"name",label:"åç§°","min-width":"200","show-overflow-tooltip":""},{default:t(({row:s})=>[w("div",Ta,[s.type==="Movie"?(o(),p(r,{key:0,color:"#34c759"},{default:t(()=>[a(V)]),_:1})):s.type==="Series"?(o(),p(r,{key:1,color:"#007aff"},{default:t(()=>[a(K)]),_:1})):s.type==="Episode"?(o(),p(r,{key:2,color:"#007aff"},{default:t(()=>[a(B)]),_:1})):s.type==="Audio"?(o(),p(r,{key:3,color:"#ff9500"},{default:t(()=>[a(U)]),_:1})):(o(),p(r,{key:4,color:"#86868b"},{default:t(()=>[a(se)]),_:1})),w("span",null,y(s.name),1),q.value[s.id]==="success"?(o(),p(n,{key:5,type:"success",size:"small",effect:"dark",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(wt($t))]),_:1}),e[40]||(e[40]=u(" å·²è½¬å­˜ ",-1))]),_:1})):q.value[s.id]==="failed"?(o(),p(n,{key:6,type:"danger",size:"small",effect:"dark",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(L)]),_:1}),e[41]||(e[41]=u(" å¤±è´¥ ",-1))]),_:1})):A("",!0),H.value[s.id]==="success"?(o(),p(n,{key:7,type:"success",size:"small",effect:"plain",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[42]||(e[42]=u(" å·²ä¸‹è½½ ",-1))]),_:1})):H.value[s.id]==="failed"?(o(),p(n,{key:8,type:"danger",size:"small",effect:"plain",style:{"margin-left":"8px"}},{default:t(()=>[a(r,null,{default:t(()=>[a(L)]),_:1}),e[43]||(e[43]=u(" ä¸‹è½½å¤±è´¥ ",-1))]),_:1})):A("",!0)])]),_:1}),a(d,{prop:"type",label:"ç±»å‹",width:"100"},{default:t(({row:s})=>[a(n,{size:"small"},{default:t(()=>[u(y(s.type),1)]),_:2},1024)]),_:1}),a(d,{prop:"productionYear",label:"å¹´ä»½",width:"80",align:"center"},{default:t(({row:s})=>[u(y(s.productionYear||"-"),1)]),_:1}),a(d,{prop:"communityRating",label:"è¯„åˆ†",width:"100",align:"center"},{default:t(({row:s})=>[s.communityRating?(o(),p(J,{key:0,"model-value":s.communityRating/2,disabled:"","show-score":"","score-template":s.communityRating.toFixed(1),size:"small"},null,8,["model-value","score-template"])):(o(),k("span",Ia,"-"))]),_:1}),a(d,{prop:"genres",label:"ç±»å‹",width:"180"},{default:t(({row:s})=>{var T,X;return[(o(!0),k(Z,null,ee((T=s.genres)==null?void 0:T.slice(0,2),(hl,_l)=>(o(),p(n,{key:_l,size:"small",class:"genre-tag"},{default:t(()=>[u(y(hl),1)]),_:2},1024))),128)),((X=s.genres)==null?void 0:X.length)>2?(o(),p(n,{key:0,size:"small",type:"info"},{default:t(()=>[u(" +"+y(s.genres.length-2),1)]),_:2},1024)):A("",!0)]}),_:1}),a(d,{prop:"size",label:"å¤§å°",width:"120",align:"right"},{default:t(({row:s})=>[s.size?(o(),p(g,{key:0,type:"primary"},{default:t(()=>[u(y(rt(s.size)),1)]),_:2},1024)):(o(),k("span",Ca,"-"))]),_:1}),a(d,{prop:"path",label:"è·¯å¾„","min-width":"300","show-overflow-tooltip":""},{default:t(({row:s})=>[s.path?(o(),p($e,{key:0,content:s.path,placement:"top"},{default:t(()=>[a(g,{type:"info",size:"small"},{default:t(()=>[u(y(s.path),1)]),_:2},1024)]),_:2},1032,["content"])):(o(),k("span",Sa,"-"))]),_:1}),a(d,{label:"è½¬å­˜çŠ¶æ€",width:"100",align:"center"},{default:t(({row:s})=>[q.value[s.id]==="success"?(o(),p(n,{key:0,type:"success",size:"small"},{default:t(()=>[...e[44]||(e[44]=[u(" å·²è½¬å­˜ ",-1)])]),_:1})):q.value[s.id]==="failed"?(o(),p(n,{key:1,type:"danger",size:"small"},{default:t(()=>[...e[45]||(e[45]=[u(" è½¬å­˜å¤±è´¥ ",-1)])]),_:1})):(o(),p(n,{key:2,type:"info",size:"small"},{default:t(()=>[...e[46]||(e[46]=[u(" æœªè½¬å­˜ ",-1)])]),_:1}))]),_:1}),a(d,{label:"ä¸‹è½½çŠ¶æ€",width:"100",align:"center"},{default:t(({row:s})=>[H.value[s.id]==="success"?(o(),p(n,{key:0,type:"success",size:"small"},{default:t(()=>[...e[47]||(e[47]=[u(" å·²ä¸‹è½½ ",-1)])]),_:1})):H.value[s.id]==="failed"?(o(),p(n,{key:1,type:"danger",size:"small"},{default:t(()=>[...e[48]||(e[48]=[u(" ä¸‹è½½å¤±è´¥ ",-1)])]),_:1})):(o(),p(n,{key:2,type:"info",size:"small"},{default:t(()=>[...e[49]||(e[49]=[u(" æœªä¸‹è½½ ",-1)])]),_:1}))]),_:1}),a(d,{label:"æ“ä½œ",width:"350",fixed:"right"},{default:t(({row:s})=>[a(f,{type:"primary",link:"",size:"small",onClick:T=>Ot(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(G)]),_:1}),e[50]||(e[50]=u(" è¯¦æƒ… ",-1))]),_:1},8,["onClick"]),s.type==="Movie"||s.type==="Series"?(o(),p(f,{key:0,type:"success",link:"",size:"small",onClick:T=>Gt(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[51]||(e[51]=u(" æœç´¢ä¸‹è½½ ",-1))]),_:1},8,["onClick"])):A("",!0),s.type==="Movie"||s.type==="Series"?(o(),p(f,{key:1,type:"warning",link:"",size:"small",onClick:T=>dt(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[52]||(e[52]=u(" ç›´æ¥ä¸‹è½½ ",-1))]),_:1},8,["onClick"])):A("",!0),H.value[s.id]!=="success"?(o(),p(f,{key:2,type:"success",link:"",size:"small",onClick:T=>Qt(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(wt($t))]),_:1}),e[53]||(e[53]=u(" æ ‡è®°å·²ä¸‹è½½ ",-1))]),_:1},8,["onClick"])):A("",!0),(s.type==="Movie"||s.type==="Series")&&q.value[s.id]&&q.value[s.id]!=="none"?(o(),p(f,{key:3,type:"info",link:"",size:"small",onClick:T=>Kt(s)},{default:t(()=>[a(r,null,{default:t(()=>[a(se)]),_:1}),e[54]||(e[54]=u(" è½¬å­˜è®°å½• ",-1))]),_:1},8,["onClick"])):A("",!0)]),_:1})]),_:1},8,["data","expand-row-keys"])),[[Fe,ne.value]]),w("div",xa,[a(cl,{"current-page":de.value,"onUpdate:currentPage":e[3]||(e[3]=s=>de.value=s),"page-size":Te.value,"onUpdate:pageSize":e[4]||(e[4]=s=>Te.value=s),"page-sizes":[20,50,100,200],total:tt.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Pt,onCurrentChange:Nt},null,8,["current-page","page-size","total"])])])]),_:1},8,["modelValue","title"]),a(Xe,{modelValue:ve.value,"onUpdate:modelValue":e[9]||(e[9]=s=>ve.value=s),title:((bt=R.value)==null?void 0:bt.type)==="Series"?"æœç´¢å¹¶ä¸‹è½½ç”µè§†å‰§":"æœç´¢å¹¶ä¸‹è½½ç”µå½±",width:"800px","close-on-click-modal":!1},{default:t(()=>[R.value?(o(),k("div",za,[a(D,{column:1,border:""},{default:t(()=>[a(_,{label:"ç”µå½±åç§°"},{default:t(()=>[a(g,{tag:"b"},{default:t(()=>[u(y(R.value.name),1)]),_:1})]),_:1}),R.value.originalTitle?(o(),p(_,{key:0,label:"åŸå§‹åç§°"},{default:t(()=>[u(y(R.value.originalTitle),1)]),_:1})):A("",!0),R.value.productionYear?(o(),p(_,{key:1,label:"å¹´ä»½"},{default:t(()=>[u(y(R.value.productionYear),1)]),_:1})):A("",!0),R.value.communityRating?(o(),p(_,{key:2,label:"è¯„åˆ†"},{default:t(()=>[a(J,{"model-value":R.value.communityRating/2,disabled:"","show-score":"","score-template":R.value.communityRating.toFixed(1),size:"small"},null,8,["model-value","score-template"])]),_:1})):A("",!0)]),_:1}),a(gt),a(dl,{"label-width":"100px"},{default:t(()=>[a(yt,{label:"æœç´¢å…³é”®è¯"},{default:t(()=>[a(Le,{modelValue:he.value,"onUpdate:modelValue":e[6]||(e[6]=s=>he.value=s),placeholder:"è‡ªåŠ¨å¡«å……ç”µå½±åç§°ï¼Œå¯ä¿®æ”¹",clearable:"",onKeyup:$l(Ae,["enter"])},{append:t(()=>[a(f,{onClick:Ae,loading:Ke.value},{default:t(()=>[a(r,null,{default:t(()=>[a(Ie)]),_:1}),e[55]||(e[55]=u(" æœç´¢ ",-1))]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1}),a(yt,{label:"æ™ºèƒ½ç­›é€‰"},{default:t(()=>[a(vt,{modelValue:We.value,"onUpdate:modelValue":e[7]||(e[7]=s=>We.value=s),label:"éªŒè¯é“¾æ¥æœ‰æ•ˆæ€§"},null,8,["modelValue"]),a(vt,{modelValue:Be.value,"onUpdate:modelValue":e[8]||(e[8]=s=>Be.value=s),label:"ä½¿ç”¨AIæ™ºèƒ½æ¨è",style:{"margin-left":"16px"}},null,8,["modelValue"])]),_:1}),a(z,{title:"äº‘ç›˜é…ç½®è¯´æ˜",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[w("div",Ma,[e[58]||(e[58]=w("p",null,[u("ç³»ç»Ÿä¼šæ ¹æ®æœç´¢ç»“æœçš„ "),w("code",null,"cloudType"),u(" è‡ªåŠ¨åŒ¹é…å¯¹åº”çš„äº‘ç›˜é…ç½®ã€‚")],-1)),w("p",Ra,[e[56]||(e[56]=u(" å·²é…ç½® ",-1)),w("strong",null,y(ie.value.length),1),e[57]||(e[57]=u(" ä¸ªäº‘ç›˜ï¼š ",-1)),(o(!0),k(Z,null,ee(ie.value,(s,T)=>(o(),p(n,{key:T,size:"small",style:{"margin-left":"4px"}},{default:t(()=>[u(y(s.cloudType),1)]),_:2},1024))),128))]),e[59]||(e[59]=w("p",{style:{"margin-top":"4px",color:"#909399"}},' å¦‚éœ€æ·»åŠ æˆ–ä¿®æ”¹äº‘ç›˜é…ç½®ï¼Œè¯·å‰å¾€"æ™ºèƒ½æœç´¢é…ç½®"é¡µé¢ ',-1))])]),_:1})]),_:1}),re.value&&re.value.length>0?(o(),k("div",Ea,[a(z,{title:`æ‰¾åˆ° ${re.value.length} ä¸ªç»“æœ`,type:"success",closable:!1,"show-icon":"",style:{"margin-bottom":"16px"}},{default:t(()=>[Mt.value?(o(),k("div",Ba,[a(r,{class:"is-loading"},{default:t(()=>[a(M)]),_:1}),e[60]||(e[60]=u(" æ­£åœ¨éªŒè¯é“¾æ¥æœ‰æ•ˆæ€§... ",-1))])):nt.value?(o(),k("div",Da,[a(r,{class:"is-loading"},{default:t(()=>[a(M)]),_:1}),e[61]||(e[61]=u(" AIæ­£åœ¨æ™ºèƒ½ç­›é€‰æœ€ä½³èµ„æº... ",-1))])):(o(),k("div",Aa," å·²å®Œæˆæ™ºèƒ½ç­›é€‰å’Œæ’åº "))]),_:1},8,["title"]),a(O,{data:re.value,style:{width:"100%"},"max-height":"400","highlight-current-row":"",onCurrentChange:al},{default:t(()=>[a(d,{type:"index",label:"#",width:"50"}),a(d,{label:"çŠ¶æ€",width:"80"},{default:t(({row:s})=>[a($e,{content:s.validationMessage||"æœªéªŒè¯",placement:"top"},{default:t(()=>[w("div",null,[s.isValid===!0?(o(),p(r,{key:0,color:"#67c23a",size:20},{default:t(()=>[a(i)]),_:1})):s.isValid===!1?(o(),p(r,{key:1,color:"#f56c6c",size:20},{default:t(()=>[a(fl)]),_:1})):(o(),p(r,{key:2,color:"#909399",size:20},{default:t(()=>[a(pl)]),_:1}))])]),_:2},1032,["content"])]),_:1}),a(d,{label:"åŒ¹é…åº¦",width:"100",sortable:"","sort-method":(s,T)=>T.matchScore-s.matchScore},{default:t(({row:s})=>{var T;return[a(ht,{percentage:Math.min(Math.round(s.matchScore),100),color:s.matchScore>=80?"#67c23a":s.matchScore>=60?"#e6a23c":"#909399","stroke-width":8},null,8,["percentage","color"]),a($e,{content:(T=s.matchReasons)==null?void 0:T.join(`
`),placement:"top"},{default:t(()=>[a(g,{size:"small",type:"info",style:{cursor:"help"}},{default:t(()=>[u(y(Math.round(s.matchScore))+"åˆ† ",1)]),_:2},1024)]),_:2},1032,["content"])]}),_:1},8,["sort-method"]),a(d,{prop:"title",label:"æ ‡é¢˜","min-width":"250","show-overflow-tooltip":""},{default:t(({row:s})=>[w("div",La,[s.image?(o(),p(ml,{key:0,src:s.image,style:{width:"40px",height:"40px","border-radius":"4px"},fit:"cover"},null,8,["src"])):A("",!0),w("div",null,[w("div",null,y(s.title),1),w("div",Fa,[s.aiRecommended?(o(),p(n,{key:0,size:"small",type:"danger",effect:"dark"},{default:t(()=>[a(r,null,{default:t(()=>[a(gl)]),_:1}),e[62]||(e[62]=u(" AIæ¨è ",-1))]),_:1})):s.matchScore>=80?(o(),p(n,{key:1,size:"small",type:"success",effect:"dark"},{default:t(()=>[...e[63]||(e[63]=[u(" æ¨è ",-1)])]),_:1})):A("",!0),s.hasFiles?(o(),p(n,{key:2,size:"small",type:"info",style:{"margin-left":"4px"}},{default:t(()=>[u(y(s.fileCount)+"ä¸ªæ–‡ä»¶ ",1)]),_:2},1024)):A("",!0)])])])]),_:1}),a(d,{prop:"size",label:"å¤§å°",width:"120"},{default:t(({row:s})=>[a(g,{type:"primary"},{default:t(()=>[u(y(s.size||"-"),1)]),_:2},1024)]),_:1}),a(d,{prop:"resolution",label:"åˆ†è¾¨ç‡",width:"100"},{default:t(({row:s})=>[s.resolution?(o(),p(n,{key:0,size:"small",type:"success"},{default:t(()=>[u(y(s.resolution),1)]),_:2},1024)):(o(),k("span",Va,"-"))]),_:1}),a(d,{prop:"tags",label:"æ ‡ç­¾",width:"150"},{default:t(({row:s})=>[(o(!0),k(Z,null,ee(s.tags.slice(0,2),(T,X)=>(o(),p(n,{key:X,size:"small",style:{"margin-right":"4px"}},{default:t(()=>[u(y(T),1)]),_:2},1024))),128)),s.tags.length>2?(o(),p(n,{key:0,size:"small",type:"info"},{default:t(()=>[u(" +"+y(s.tags.length-2),1)]),_:2},1024)):A("",!0)]),_:1}),a(d,{prop:"channelName",label:"æ¥æº",width:"100"},{default:t(({row:s})=>[a(g,{size:"small",type:"info"},{default:t(()=>[u(y(s.channelName||"-"),1)]),_:2},1024)]),_:1}),a(d,{label:"æ“ä½œ",width:"120",fixed:"right"},{default:t(({row:s})=>{var T;return[a(f,{type:"primary",size:"small",onClick:X=>il(s),loading:we.value&&((T=fe.value)==null?void 0:T.id)===s.id},{default:t(()=>[a(r,null,{default:t(()=>[a(h)]),_:1}),e[64]||(e[64]=u(" è½¬å­˜ ",-1))]),_:1},8,["onClick","loading"])]}),_:1})]),_:1},8,["data"])])):A("",!0),re.value&&re.value.length===0&&!Ke.value?(o(),p(b,{key:1,description:"æœªæ‰¾åˆ°æœç´¢ç»“æœ","image-size":100})):A("",!0),fe.value?(o(),k("div",Na,[a(gt,{"content-position":"left"},{default:t(()=>[...e[65]||(e[65]=[u("é€‰ä¸­çš„èµ„æº",-1)])]),_:1}),a(S,{class:"result-preview",shadow:"never"},{default:t(()=>[w("pre",Ya,y(ul(fe.value)),1)]),_:1})])):A("",!0)])):A("",!0)]),_:1},8,["modelValue","title"]),a(Xe,{modelValue:at.value,"onUpdate:modelValue":e[10]||(e[10]=s=>at.value=s),title:(kt=E.value)==null?void 0:kt.name,width:"70%"},{default:t(()=>[E.value?(o(),p(D,{key:0,column:2,border:""},{default:t(()=>[a(_,{label:"ID"},{default:t(()=>[a(g,{type:"info",size:"small"},{default:t(()=>[u(y(E.value.id),1)]),_:1})]),_:1}),a(_,{label:"ç±»å‹"},{default:t(()=>[a(n,null,{default:t(()=>[u(y(E.value.type),1)]),_:1})]),_:1}),a(_,{label:"åŸå§‹åç§°"},{default:t(()=>[u(y(E.value.originalTitle||"-"),1)]),_:1}),a(_,{label:"å¹´ä»½"},{default:t(()=>[E.value.productionYear?(o(),p(n,{key:0,type:"info"},{default:t(()=>[u(y(E.value.productionYear),1)]),_:1})):(o(),k("span",Ua,"-"))]),_:1}),a(_,{label:"è¯„åˆ†"},{default:t(()=>[E.value.communityRating?(o(),p(J,{key:0,"model-value":E.value.communityRating/2,disabled:"","show-score":"","score-template":E.value.communityRating.toFixed(1)},null,8,["model-value","score-template"])):(o(),k("span",Pa,"-"))]),_:1}),a(_,{label:"åˆ†çº§"},{default:t(()=>[E.value.officialRating?(o(),p(n,{key:0,type:"warning"},{default:t(()=>[u(y(E.value.officialRating),1)]),_:1})):(o(),k("span",ja,"-"))]),_:1}),a(_,{label:"æ–‡ä»¶å¤§å°"},{default:t(()=>[E.value.size?(o(),p(g,{key:0,type:"primary",tag:"b"},{default:t(()=>[u(y(rt(E.value.size)),1)]),_:1})):(o(),k("span",Oa,"-"))]),_:1}),a(_,{label:"æ’­æ”¾æ¬¡æ•°"},{default:t(()=>[a(n,{type:"success"},{default:t(()=>[u(y(E.value.playCount||0)+" æ¬¡",1)]),_:1})]),_:1}),a(_,{label:"ç±»å‹",span:2},{default:t(()=>[E.value.genres&&E.value.genres.length>0?(o(),k("div",Ka,[(o(!0),k(Z,null,ee(E.value.genres,(s,T)=>(o(),p(n,{key:T,class:"detail-tag"},{default:t(()=>[u(y(s),1)]),_:2},1024))),128))])):(o(),k("span",Wa,"-"))]),_:1}),a(_,{label:"æ ‡ç­¾",span:2},{default:t(()=>[E.value.tags&&E.value.tags.length>0?(o(),k("div",Ha,[(o(!0),k(Z,null,ee(E.value.tags,(s,T)=>(o(),p(n,{key:T,type:"success",class:"detail-tag"},{default:t(()=>[u(y(s),1)]),_:2},1024))),128))])):(o(),k("span",Ga,"-"))]),_:1}),a(_,{label:"å·¥ä½œå®¤",span:2},{default:t(()=>[E.value.studios&&E.value.studios.length>0?(o(),k("div",Qa,[(o(!0),k(Z,null,ee(E.value.studios,(s,T)=>(o(),p(n,{key:T,type:"warning",class:"detail-tag"},{default:t(()=>[u(y(s),1)]),_:2},1024))),128))])):(o(),k("span",Ja,"-"))]),_:1}),a(_,{label:"æ¼”å‘˜",span:2},{default:t(()=>{var s;return[E.value.people&&E.value.people.length>0?(o(),k("div",qa,[(o(!0),k(Z,null,ee((s=E.value.people)==null?void 0:s.slice(0,10),(T,X)=>(o(),p(n,{key:X,type:"info",class:"detail-tag"},{default:t(()=>[u(y(T),1)]),_:2},1024))),128)),E.value.people.length>10?(o(),p(n,{key:0,type:"info"},{default:t(()=>[u(" +"+y(E.value.people.length-10),1)]),_:1})):A("",!0)])):(o(),k("span",Xa,"-"))]}),_:1}),a(_,{label:"ç®€ä»‹",span:2},{default:t(()=>[E.value.overview?(o(),p(g,{key:0,class:"overview-text"},{default:t(()=>[u(y(E.value.overview),1)]),_:1})):(o(),k("span",Za,"-"))]),_:1}),a(_,{label:"æ–‡ä»¶è·¯å¾„",span:2},{default:t(()=>[E.value.path?(o(),p(g,{key:0,type:"info",size:"small"},{default:t(()=>[u(y(E.value.path),1)]),_:1})):(o(),k("span",es,"-"))]),_:1}),E.value.mediaSources&&E.value.mediaSources.length>0?(o(),p(_,{key:0,label:"åª’ä½“æº",span:2},{default:t(()=>[(o(!0),k(Z,null,ee(E.value.mediaSources,(s,T)=>(o(),k("div",{key:T,class:"media-source"},[a(n,{type:"primary"},{default:t(()=>{var X;return[u(y((X=s.container)==null?void 0:X.toUpperCase()),1)]}),_:2},1024),a(g,{type:"info",size:"small"},{default:t(()=>[u(y(rt(s.size)),1)]),_:2},1024),a(g,{type:"info",size:"small"},{default:t(()=>[u(y(Ht(s.bitrate)),1)]),_:2},1024)]))),128))]),_:1})):A("",!0)]),_:1})):A("",!0)]),_:1},8,["modelValue","title"]),a(Xe,{modelValue:st.value,"onUpdate:modelValue":e[11]||(e[11]=s=>st.value=s),title:"è½¬å­˜å†å²è®°å½•",width:"800px"},{default:t(()=>[!Oe.value||Oe.value.length===0?(o(),p(b,{key:0,description:"æš‚æ— è½¬å­˜è®°å½•"})):(o(),p(vl,{key:1},{default:t(()=>[(o(!0),k(Z,null,ee(Oe.value,(s,T)=>(o(),p(yl,{key:T,timestamp:s.createTime,placement:"top",type:s.transferStatus==="success"?"success":"danger",icon:s.transferStatus==="success"?"CircleCheck":"CircleClose"},{default:t(()=>[a(S,{shadow:"hover"},{header:t(()=>[w("div",ts,[w("span",ls,y(s.resourceTitle),1),a(n,{type:s.transferStatus==="success"?"success":"danger",size:"small"},{default:t(()=>[u(y(s.transferStatus==="success"?"è½¬å­˜æˆåŠŸ":"è½¬å­˜å¤±è´¥"),1)]),_:2},1032,["type"])])]),default:t(()=>[a(D,{column:2,size:"small",border:""},{default:t(()=>[a(_,{label:"åŒ¹é…åˆ†æ•°"},{default:t(()=>[s.matchScore?(o(),p(ht,{key:0,percentage:Math.min(Math.round(s.matchScore),100),color:s.matchScore>=80?"#67c23a":s.matchScore>=60?"#e6a23c":"#909399","stroke-width":6,"show-text":!1,style:{width:"100px",display:"inline-block","margin-right":"8px"}},null,8,["percentage","color"])):A("",!0),w("span",null,y(s.matchScore?Math.round(s.matchScore)+"åˆ†":"-"),1)]),_:2},1024),a(_,{label:"äº‘ç›˜"},{default:t(()=>[u(y(s.cloudName||"-"),1)]),_:2},1024),a(_,{label:"äº‘ç›˜ç±»å‹"},{default:t(()=>[a(n,{size:"small"},{default:t(()=>[u(y(s.cloudType||"-"),1)]),_:2},1024)]),_:2},1024),a(_,{label:"è½¬å­˜æ—¶é—´"},{default:t(()=>[u(y(s.createTime),1)]),_:2},1024),a(_,{label:"ç»“æœæ¶ˆæ¯",span:2},{default:t(()=>[a(g,{type:s.transferStatus==="success"?"success":"danger"},{default:t(()=>[u(y(s.transferMessage||"-"),1)]),_:2},1032,["type"])]),_:2},1024),a(_,{label:"èµ„æºé“¾æ¥",span:2},{default:t(()=>[a($,{href:s.resourceUrl,target:"_blank",type:"primary",underline:!1,style:{"font-size":"12px"}},{default:t(()=>[u(y(s.resourceUrl),1)]),_:2},1032,["href"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["timestamp","type","icon"]))),128))]),_:1}))]),_:1},8,["modelValue"])])}}},us=bl(as,[["__scopeId","data-v-7a9bf5d8"]]);export{us as default};
